import{r as Wg,g as Hv,a as Jg}from"./vendor-gH-7aFTg.js";import{i as Iv,g as Gv,a as Yv,r as xs,u as Pm,b as vr,c as eg,d as Vt,e as Ft,f as eu,h as mu,j as tg,q as _n,o as ga,k as ba,l as Fv,s as Vv,w as Qv,m as ng,n as sg,L as Xv,p as X,_ as $v,C as Kv,t as ag,v as it,x as Ru,y as Cn,z as Ta,A as br,B as Zv,S as Wv,D as Jv,E as Fi,F as Pv,G as eb,H as tb,I as Pg,J as nb,K as sb,M as ab,N as ig,O as e0,P as ib,Q as lb,R as rb,T as Or,U as ob,V as cb,W as ub,X as db,Y as fb,Z as hb,$ as mb,a0 as gb,a1 as pb,a2 as yb}from"./firebase-vVUnojRl.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const h of d.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&l(h)}).observe(document,{childList:!0,subtree:!0});function a(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(c){if(c.ep)return;c.ep=!0;const d=a(c);fetch(c.href,d)}})();var tu={exports:{}},Di={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg;function vb(){if(lg)return Di;lg=1;var r=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(l,c,d){var h=null;if(d!==void 0&&(h=""+d),c.key!==void 0&&(h=""+c.key),"key"in c){d={};for(var g in c)g!=="key"&&(d[g]=c[g])}else d=c;return c=d.ref,{$$typeof:r,type:l,key:h,ref:c!==void 0?c:null,props:d}}return Di.Fragment=n,Di.jsx=a,Di.jsxs=a,Di}var rg;function bb(){return rg||(rg=1,tu.exports=vb()),tu.exports}var f=bb(),w=Wg();const t0=Hv(w);var nu={exports:{}},ji={},su={exports:{}},au={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function xb(){return og||(og=1,(function(r){function n(T,Y){var ne=T.length;T.push(Y);e:for(;0<ne;){var ve=ne-1>>>1,Ae=T[ve];if(0<c(Ae,Y))T[ve]=Y,T[ne]=Ae,ne=ve;else break e}}function a(T){return T.length===0?null:T[0]}function l(T){if(T.length===0)return null;var Y=T[0],ne=T.pop();if(ne!==Y){T[0]=ne;e:for(var ve=0,Ae=T.length,dt=Ae>>>1;ve<dt;){var ke=2*(ve+1)-1,we=T[ke],Xe=ke+1,Zt=T[Xe];if(0>c(we,ne))Xe<Ae&&0>c(Zt,we)?(T[ve]=Zt,T[Xe]=ne,ve=Xe):(T[ve]=we,T[ke]=ne,ve=ke);else if(Xe<Ae&&0>c(Zt,ne))T[ve]=Zt,T[Xe]=ne,ve=Xe;else break e}}return Y}function c(T,Y){var ne=T.sortIndex-Y.sortIndex;return ne!==0?ne:T.id-Y.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var d=performance;r.unstable_now=function(){return d.now()}}else{var h=Date,g=h.now();r.unstable_now=function(){return h.now()-g}}var p=[],y=[],b=1,x=null,_=3,C=!1,O=!1,L=!1,V=!1,K=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function I(T){for(var Y=a(y);Y!==null;){if(Y.callback===null)l(y);else if(Y.startTime<=T)l(y),Y.sortIndex=Y.expirationTime,n(p,Y);else break;Y=a(y)}}function Q(T){if(L=!1,I(T),!O)if(a(p)!==null)O=!0,ee||(ee=!0,G());else{var Y=a(y);Y!==null&&J(Q,Y.startTime-T)}}var ee=!1,$=-1,M=5,F=-1;function H(){return V?!0:!(r.unstable_now()-F<M)}function q(){if(V=!1,ee){var T=r.unstable_now();F=T;var Y=!0;try{e:{O=!1,L&&(L=!1,P($),$=-1),C=!0;var ne=_;try{t:{for(I(T),x=a(p);x!==null&&!(x.expirationTime>T&&H());){var ve=x.callback;if(typeof ve=="function"){x.callback=null,_=x.priorityLevel;var Ae=ve(x.expirationTime<=T);if(T=r.unstable_now(),typeof Ae=="function"){x.callback=Ae,I(T),Y=!0;break t}x===a(p)&&l(p),I(T)}else l(p);x=a(p)}if(x!==null)Y=!0;else{var dt=a(y);dt!==null&&J(Q,dt.startTime-T),Y=!1}}break e}finally{x=null,_=ne,C=!1}Y=void 0}}finally{Y?G():ee=!1}}}var G;if(typeof U=="function")G=function(){U(q)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,Z=se.port2;se.port1.onmessage=q,G=function(){Z.postMessage(null)}}else G=function(){K(q,0)};function J(T,Y){$=K(function(){T(r.unstable_now())},Y)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(T){T.callback=null},r.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<T?Math.floor(1e3/T):5},r.unstable_getCurrentPriorityLevel=function(){return _},r.unstable_next=function(T){switch(_){case 1:case 2:case 3:var Y=3;break;default:Y=_}var ne=_;_=Y;try{return T()}finally{_=ne}},r.unstable_requestPaint=function(){V=!0},r.unstable_runWithPriority=function(T,Y){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var ne=_;_=T;try{return Y()}finally{_=ne}},r.unstable_scheduleCallback=function(T,Y,ne){var ve=r.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ve+ne:ve):ne=ve,T){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ne+Ae,T={id:b++,callback:Y,priorityLevel:T,startTime:ne,expirationTime:Ae,sortIndex:-1},ne>ve?(T.sortIndex=ne,n(y,T),a(p)===null&&T===a(y)&&(L?(P($),$=-1):L=!0,J(Q,ne-ve))):(T.sortIndex=Ae,n(p,T),O||C||(O=!0,ee||(ee=!0,G()))),T},r.unstable_shouldYield=H,r.unstable_wrapCallback=function(T){var Y=_;return function(){var ne=_;_=Y;try{return T.apply(this,arguments)}finally{_=ne}}}})(au)),au}var cg;function _b(){return cg||(cg=1,su.exports=xb()),su.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ug;function wb(){if(ug)return ji;ug=1;var r=_b(),n=Wg(),a=Jg();function l(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function c(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function h(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function g(e){if(d(e)!==e)throw Error(l(188))}function p(e){var t=e.alternate;if(!t){if(t=d(e),t===null)throw Error(l(188));return t!==e?null:e}for(var s=e,i=t;;){var o=s.return;if(o===null)break;var u=o.alternate;if(u===null){if(i=o.return,i!==null){s=i;continue}break}if(o.child===u.child){for(u=o.child;u;){if(u===s)return g(o),e;if(u===i)return g(o),t;u=u.sibling}throw Error(l(188))}if(s.return!==i.return)s=o,i=u;else{for(var m=!1,v=o.child;v;){if(v===s){m=!0,s=o,i=u;break}if(v===i){m=!0,i=o,s=u;break}v=v.sibling}if(!m){for(v=u.child;v;){if(v===s){m=!0,s=u,i=o;break}if(v===i){m=!0,i=u,s=o;break}v=v.sibling}if(!m)throw Error(l(189))}}if(s.alternate!==i)throw Error(l(190))}if(s.tag!==3)throw Error(l(188));return s.stateNode.current===s?e:t}function y(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=y(e),t!==null)return t;e=e.sibling}return null}var b=Object.assign,x=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),L=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),P=Symbol.for("react.consumer"),U=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function G(e){return e===null||typeof e!="object"?null:(e=q&&e[q]||e["@@iterator"],typeof e=="function"?e:null)}var se=Symbol.for("react.client.reference");function Z(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===se?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case O:return"Fragment";case V:return"Profiler";case L:return"StrictMode";case Q:return"Suspense";case ee:return"SuspenseList";case F:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case C:return"Portal";case U:return(e.displayName||"Context")+".Provider";case P:return(e._context.displayName||"Context")+".Consumer";case I:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $:return t=e.displayName||null,t!==null?t:Z(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return Z(e(t))}catch{}}return null}var J=Array.isArray,T=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},ve=[],Ae=-1;function dt(e){return{current:e}}function ke(e){0>Ae||(e.current=ve[Ae],ve[Ae]=null,Ae--)}function we(e,t){Ae++,ve[Ae]=e.current,e.current=t}var Xe=dt(null),Zt=dt(null),Nn=dt(null),Wi=dt(null);function Ji(e,t){switch(we(Nn,t),we(Zt,e),we(Xe,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Tm(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Tm(t),e=Rm(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}ke(Xe),we(Xe,e)}function As(){ke(Xe),ke(Zt),ke(Nn)}function Br(e){e.memoizedState!==null&&we(Wi,e);var t=Xe.current,s=Rm(t,e.type);t!==s&&(we(Zt,e),we(Xe,s))}function Pi(e){Zt.current===e&&(ke(Xe),ke(Zt)),Wi.current===e&&(ke(Wi),Ci._currentValue=ne)}var qr=Object.prototype.hasOwnProperty,Hr=r.unstable_scheduleCallback,Ir=r.unstable_cancelCallback,vp=r.unstable_shouldYield,bp=r.unstable_requestPaint,Wt=r.unstable_now,xp=r.unstable_getCurrentPriorityLevel,ld=r.unstable_ImmediatePriority,rd=r.unstable_UserBlockingPriority,el=r.unstable_NormalPriority,_p=r.unstable_LowPriority,od=r.unstable_IdlePriority,wp=r.log,Sp=r.unstable_setDisableYieldValue,Oa=null,bt=null;function Tn(e){if(typeof wp=="function"&&Sp(e),bt&&typeof bt.setStrictMode=="function")try{bt.setStrictMode(Oa,e)}catch{}}var xt=Math.clz32?Math.clz32:Np,Ep=Math.log,Cp=Math.LN2;function Np(e){return e>>>=0,e===0?32:31-(Ep(e)/Cp|0)|0}var tl=256,nl=4194304;function ts(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function sl(e,t,s){var i=e.pendingLanes;if(i===0)return 0;var o=0,u=e.suspendedLanes,m=e.pingedLanes;e=e.warmLanes;var v=i&134217727;return v!==0?(i=v&~u,i!==0?o=ts(i):(m&=v,m!==0?o=ts(m):s||(s=v&~e,s!==0&&(o=ts(s))))):(v=i&~u,v!==0?o=ts(v):m!==0?o=ts(m):s||(s=i&~e,s!==0&&(o=ts(s)))),o===0?0:t!==0&&t!==o&&(t&u)===0&&(u=o&-o,s=t&-t,u>=s||u===32&&(s&4194048)!==0)?t:o}function ka(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Tp(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cd(){var e=tl;return tl<<=1,(tl&4194048)===0&&(tl=256),e}function ud(){var e=nl;return nl<<=1,(nl&62914560)===0&&(nl=4194304),e}function Gr(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function Ua(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Rp(e,t,s,i,o,u){var m=e.pendingLanes;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=s,e.entangledLanes&=s,e.errorRecoveryDisabledLanes&=s,e.shellSuspendCounter=0;var v=e.entanglements,S=e.expirationTimes,A=e.hiddenUpdates;for(s=m&~s;0<s;){var k=31-xt(s),B=1<<k;v[k]=0,S[k]=-1;var D=A[k];if(D!==null)for(A[k]=null,k=0;k<D.length;k++){var j=D[k];j!==null&&(j.lane&=-536870913)}s&=~B}i!==0&&dd(e,i,0),u!==0&&o===0&&e.tag!==0&&(e.suspendedLanes|=u&~(m&~t))}function dd(e,t,s){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-xt(t);e.entangledLanes|=t,e.entanglements[i]=e.entanglements[i]|1073741824|s&4194090}function fd(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var i=31-xt(s),o=1<<i;o&t|e[i]&t&&(e[i]|=t),s&=~o}}function Yr(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Fr(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function hd(){var e=Y.p;return e!==0?e:(e=window.event,e===void 0?32:Xm(e.type))}function Ap(e,t){var s=Y.p;try{return Y.p=e,t()}finally{Y.p=s}}var Rn=Math.random().toString(36).slice(2),lt="__reactFiber$"+Rn,ht="__reactProps$"+Rn,Ds="__reactContainer$"+Rn,Vr="__reactEvents$"+Rn,Dp="__reactListeners$"+Rn,jp="__reactHandles$"+Rn,md="__reactResources$"+Rn,La="__reactMarker$"+Rn;function Qr(e){delete e[lt],delete e[ht],delete e[Vr],delete e[Dp],delete e[jp]}function js(e){var t=e[lt];if(t)return t;for(var s=e.parentNode;s;){if(t=s[Ds]||s[lt]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Mm(e);e!==null;){if(s=e[lt])return s;e=Mm(e)}return t}e=s,s=e.parentNode}return null}function Ms(e){if(e=e[lt]||e[Ds]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function za(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(l(33))}function Os(e){var t=e[md];return t||(t=e[md]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function $e(e){e[La]=!0}var gd=new Set,pd={};function ns(e,t){ks(e,t),ks(e+"Capture",t)}function ks(e,t){for(pd[e]=t,e=0;e<t.length;e++)gd.add(t[e])}var Mp=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yd={},vd={};function Op(e){return qr.call(vd,e)?!0:qr.call(yd,e)?!1:Mp.test(e)?vd[e]=!0:(yd[e]=!0,!1)}function al(e,t,s){if(Op(t))if(s===null)e.removeAttribute(t);else{switch(typeof s){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var i=t.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+s)}}function il(e,t,s){if(s===null)e.removeAttribute(t);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+s)}}function an(e,t,s,i){if(i===null)e.removeAttribute(s);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(s);return}e.setAttributeNS(t,s,""+i)}}var Xr,bd;function Us(e){if(Xr===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);Xr=t&&t[1]||"",bd=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xr+e+bd}var $r=!1;function Kr(e,t){if(!e||$r)return"";$r=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var B=function(){throw Error()};if(Object.defineProperty(B.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(B,[])}catch(j){var D=j}Reflect.construct(e,[],B)}else{try{B.call()}catch(j){D=j}e.call(B.prototype)}}else{try{throw Error()}catch(j){D=j}(B=e())&&typeof B.catch=="function"&&B.catch(function(){})}}catch(j){if(j&&D&&typeof j.stack=="string")return[j.stack,D.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var o=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");o&&o.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var u=i.DetermineComponentFrameRoot(),m=u[0],v=u[1];if(m&&v){var S=m.split(`
`),A=v.split(`
`);for(o=i=0;i<S.length&&!S[i].includes("DetermineComponentFrameRoot");)i++;for(;o<A.length&&!A[o].includes("DetermineComponentFrameRoot");)o++;if(i===S.length||o===A.length)for(i=S.length-1,o=A.length-1;1<=i&&0<=o&&S[i]!==A[o];)o--;for(;1<=i&&0<=o;i--,o--)if(S[i]!==A[o]){if(i!==1||o!==1)do if(i--,o--,0>o||S[i]!==A[o]){var k=`
`+S[i].replace(" at new "," at ");return e.displayName&&k.includes("<anonymous>")&&(k=k.replace("<anonymous>",e.displayName)),k}while(1<=i&&0<=o);break}}}finally{$r=!1,Error.prepareStackTrace=s}return(s=e?e.displayName||e.name:"")?Us(s):""}function kp(e){switch(e.tag){case 26:case 27:case 5:return Us(e.type);case 16:return Us("Lazy");case 13:return Us("Suspense");case 19:return Us("SuspenseList");case 0:case 15:return Kr(e.type,!1);case 11:return Kr(e.type.render,!1);case 1:return Kr(e.type,!0);case 31:return Us("Activity");default:return""}}function xd(e){try{var t="";do t+=kp(e),e=e.return;while(e);return t}catch(s){return`
Error generating stack: `+s.message+`
`+s.stack}}function Mt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _d(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Up(e){var t=_d(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var o=s.get,u=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(m){i=""+m,u.call(this,m)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return i},setValue:function(m){i=""+m},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ll(e){e._valueTracker||(e._valueTracker=Up(e))}function wd(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),i="";return e&&(i=_d(e)?e.checked?"true":"false":e.value),e=i,e!==s?(t.setValue(e),!0):!1}function rl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var Lp=/[\n"\\]/g;function Ot(e){return e.replace(Lp,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Zr(e,t,s,i,o,u,m,v){e.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?e.type=m:e.removeAttribute("type"),t!=null?m==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Mt(t)):e.value!==""+Mt(t)&&(e.value=""+Mt(t)):m!=="submit"&&m!=="reset"||e.removeAttribute("value"),t!=null?Wr(e,m,Mt(t)):s!=null?Wr(e,m,Mt(s)):i!=null&&e.removeAttribute("value"),o==null&&u!=null&&(e.defaultChecked=!!u),o!=null&&(e.checked=o&&typeof o!="function"&&typeof o!="symbol"),v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?e.name=""+Mt(v):e.removeAttribute("name")}function Sd(e,t,s,i,o,u,m,v){if(u!=null&&typeof u!="function"&&typeof u!="symbol"&&typeof u!="boolean"&&(e.type=u),t!=null||s!=null){if(!(u!=="submit"&&u!=="reset"||t!=null))return;s=s!=null?""+Mt(s):"",t=t!=null?""+Mt(t):s,v||t===e.value||(e.value=t),e.defaultValue=t}i=i??o,i=typeof i!="function"&&typeof i!="symbol"&&!!i,e.checked=v?e.checked:!!i,e.defaultChecked=!!i,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(e.name=m)}function Wr(e,t,s){t==="number"&&rl(e.ownerDocument)===e||e.defaultValue===""+s||(e.defaultValue=""+s)}function Ls(e,t,s,i){if(e=e.options,t){t={};for(var o=0;o<s.length;o++)t["$"+s[o]]=!0;for(s=0;s<e.length;s++)o=t.hasOwnProperty("$"+e[s].value),e[s].selected!==o&&(e[s].selected=o),o&&i&&(e[s].defaultSelected=!0)}else{for(s=""+Mt(s),t=null,o=0;o<e.length;o++){if(e[o].value===s){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Ed(e,t,s){if(t!=null&&(t=""+Mt(t),t!==e.value&&(e.value=t),s==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=s!=null?""+Mt(s):""}function Cd(e,t,s,i){if(t==null){if(i!=null){if(s!=null)throw Error(l(92));if(J(i)){if(1<i.length)throw Error(l(93));i=i[0]}s=i}s==null&&(s=""),t=s}s=Mt(t),e.defaultValue=s,i=e.textContent,i===s&&i!==""&&i!==null&&(e.value=i)}function zs(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var zp=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nd(e,t,s){var i=t.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?i?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":i?e.setProperty(t,s):typeof s!="number"||s===0||zp.has(t)?t==="float"?e.cssFloat=s:e[t]=(""+s).trim():e[t]=s+"px"}function Td(e,t,s){if(t!=null&&typeof t!="object")throw Error(l(62));if(e=e.style,s!=null){for(var i in s)!s.hasOwnProperty(i)||t!=null&&t.hasOwnProperty(i)||(i.indexOf("--")===0?e.setProperty(i,""):i==="float"?e.cssFloat="":e[i]="");for(var o in t)i=t[o],t.hasOwnProperty(o)&&s[o]!==i&&Nd(e,o,i)}else for(var u in t)t.hasOwnProperty(u)&&Nd(e,u,t[u])}function Jr(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ol(e){return qp.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Pr=null;function eo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bs=null,qs=null;function Rd(e){var t=Ms(e);if(t&&(e=t.stateNode)){var s=e[ht]||null;e:switch(e=t.stateNode,t.type){case"input":if(Zr(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+Ot(""+t)+'"][type="radio"]'),t=0;t<s.length;t++){var i=s[t];if(i!==e&&i.form===e.form){var o=i[ht]||null;if(!o)throw Error(l(90));Zr(i,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name)}}for(t=0;t<s.length;t++)i=s[t],i.form===e.form&&wd(i)}break e;case"textarea":Ed(e,s.value,s.defaultValue);break e;case"select":t=s.value,t!=null&&Ls(e,!!s.multiple,t,!1)}}}var to=!1;function Ad(e,t,s){if(to)return e(t,s);to=!0;try{var i=e(t);return i}finally{if(to=!1,(Bs!==null||qs!==null)&&(Xl(),Bs&&(t=Bs,e=qs,qs=Bs=null,Rd(t),e)))for(t=0;t<e.length;t++)Rd(e[t])}}function Ba(e,t){var s=e.stateNode;if(s===null)return null;var i=s[ht]||null;if(i===null)return null;s=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(l(231,t,typeof s));return s}var ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),no=!1;if(ln)try{var qa={};Object.defineProperty(qa,"passive",{get:function(){no=!0}}),window.addEventListener("test",qa,qa),window.removeEventListener("test",qa,qa)}catch{no=!1}var An=null,so=null,cl=null;function Dd(){if(cl)return cl;var e,t=so,s=t.length,i,o="value"in An?An.value:An.textContent,u=o.length;for(e=0;e<s&&t[e]===o[e];e++);var m=s-e;for(i=1;i<=m&&t[s-i]===o[u-i];i++);return cl=o.slice(e,1<i?1-i:void 0)}function ul(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dl(){return!0}function jd(){return!1}function mt(e){function t(s,i,o,u,m){this._reactName=s,this._targetInst=o,this.type=i,this.nativeEvent=u,this.target=m,this.currentTarget=null;for(var v in e)e.hasOwnProperty(v)&&(s=e[v],this[v]=s?s(u):u[v]);return this.isDefaultPrevented=(u.defaultPrevented!=null?u.defaultPrevented:u.returnValue===!1)?dl:jd,this.isPropagationStopped=jd,this}return b(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=dl)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=dl)},persist:function(){},isPersistent:dl}),t}var ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fl=mt(ss),Ha=b({},ss,{view:0,detail:0}),Hp=mt(Ha),ao,io,Ia,hl=b({},Ha,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ro,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ia&&(Ia&&e.type==="mousemove"?(ao=e.screenX-Ia.screenX,io=e.screenY-Ia.screenY):io=ao=0,Ia=e),ao)},movementY:function(e){return"movementY"in e?e.movementY:io}}),Md=mt(hl),Ip=b({},hl,{dataTransfer:0}),Gp=mt(Ip),Yp=b({},Ha,{relatedTarget:0}),lo=mt(Yp),Fp=b({},ss,{animationName:0,elapsedTime:0,pseudoElement:0}),Vp=mt(Fp),Qp=b({},ss,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Xp=mt(Qp),$p=b({},ss,{data:0}),Od=mt($p),Kp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jp(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wp[e])?!!t[e]:!1}function ro(){return Jp}var Pp=b({},Ha,{key:function(e){if(e.key){var t=Kp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ul(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Zp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ro,charCode:function(e){return e.type==="keypress"?ul(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ul(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ey=mt(Pp),ty=b({},hl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kd=mt(ty),ny=b({},Ha,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ro}),sy=mt(ny),ay=b({},ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),iy=mt(ay),ly=b({},hl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),ry=mt(ly),oy=b({},ss,{newState:0,oldState:0}),cy=mt(oy),uy=[9,13,27,32],oo=ln&&"CompositionEvent"in window,Ga=null;ln&&"documentMode"in document&&(Ga=document.documentMode);var dy=ln&&"TextEvent"in window&&!Ga,Ud=ln&&(!oo||Ga&&8<Ga&&11>=Ga),Ld=" ",zd=!1;function Bd(e,t){switch(e){case"keyup":return uy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Hs=!1;function fy(e,t){switch(e){case"compositionend":return qd(t);case"keypress":return t.which!==32?null:(zd=!0,Ld);case"textInput":return e=t.data,e===Ld&&zd?null:e;default:return null}}function hy(e,t){if(Hs)return e==="compositionend"||!oo&&Bd(e,t)?(e=Dd(),cl=so=An=null,Hs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ud&&t.locale!=="ko"?null:t.data;default:return null}}var my={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!my[e.type]:t==="textarea"}function Id(e,t,s,i){Bs?qs?qs.push(i):qs=[i]:Bs=i,t=Pl(t,"onChange"),0<t.length&&(s=new fl("onChange","change",null,s,i),e.push({event:s,listeners:t}))}var Ya=null,Fa=null;function gy(e){wm(e,0)}function ml(e){var t=za(e);if(wd(t))return e}function Gd(e,t){if(e==="change")return t}var Yd=!1;if(ln){var co;if(ln){var uo="oninput"in document;if(!uo){var Fd=document.createElement("div");Fd.setAttribute("oninput","return;"),uo=typeof Fd.oninput=="function"}co=uo}else co=!1;Yd=co&&(!document.documentMode||9<document.documentMode)}function Vd(){Ya&&(Ya.detachEvent("onpropertychange",Qd),Fa=Ya=null)}function Qd(e){if(e.propertyName==="value"&&ml(Fa)){var t=[];Id(t,Fa,e,eo(e)),Ad(gy,t)}}function py(e,t,s){e==="focusin"?(Vd(),Ya=t,Fa=s,Ya.attachEvent("onpropertychange",Qd)):e==="focusout"&&Vd()}function yy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ml(Fa)}function vy(e,t){if(e==="click")return ml(t)}function by(e,t){if(e==="input"||e==="change")return ml(t)}function xy(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _t=typeof Object.is=="function"?Object.is:xy;function Va(e,t){if(_t(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),i=Object.keys(t);if(s.length!==i.length)return!1;for(i=0;i<s.length;i++){var o=s[i];if(!qr.call(t,o)||!_t(e[o],t[o]))return!1}return!0}function Xd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $d(e,t){var s=Xd(e);e=0;for(var i;s;){if(s.nodeType===3){if(i=e+s.textContent.length,e<=t&&i>=t)return{node:s,offset:t-e};e=i}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Xd(s)}}function Kd(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Kd(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Zd(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=rl(e.document);t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=rl(e.document)}return t}function fo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var _y=ln&&"documentMode"in document&&11>=document.documentMode,Is=null,ho=null,Qa=null,mo=!1;function Wd(e,t,s){var i=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;mo||Is==null||Is!==rl(i)||(i=Is,"selectionStart"in i&&fo(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Qa&&Va(Qa,i)||(Qa=i,i=Pl(ho,"onSelect"),0<i.length&&(t=new fl("onSelect","select",null,t,s),e.push({event:t,listeners:i}),t.target=Is)))}function as(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var Gs={animationend:as("Animation","AnimationEnd"),animationiteration:as("Animation","AnimationIteration"),animationstart:as("Animation","AnimationStart"),transitionrun:as("Transition","TransitionRun"),transitionstart:as("Transition","TransitionStart"),transitioncancel:as("Transition","TransitionCancel"),transitionend:as("Transition","TransitionEnd")},go={},Jd={};ln&&(Jd=document.createElement("div").style,"AnimationEvent"in window||(delete Gs.animationend.animation,delete Gs.animationiteration.animation,delete Gs.animationstart.animation),"TransitionEvent"in window||delete Gs.transitionend.transition);function is(e){if(go[e])return go[e];if(!Gs[e])return e;var t=Gs[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in Jd)return go[e]=t[s];return e}var Pd=is("animationend"),ef=is("animationiteration"),tf=is("animationstart"),wy=is("transitionrun"),Sy=is("transitionstart"),Ey=is("transitioncancel"),nf=is("transitionend"),sf=new Map,po="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");po.push("scrollEnd");function It(e,t){sf.set(e,t),ns(t,[e])}var af=new WeakMap;function kt(e,t){if(typeof e=="object"&&e!==null){var s=af.get(e);return s!==void 0?s:(t={value:e,source:t,stack:xd(t)},af.set(e,t),t)}return{value:e,source:t,stack:xd(t)}}var Ut=[],Ys=0,yo=0;function gl(){for(var e=Ys,t=yo=Ys=0;t<e;){var s=Ut[t];Ut[t++]=null;var i=Ut[t];Ut[t++]=null;var o=Ut[t];Ut[t++]=null;var u=Ut[t];if(Ut[t++]=null,i!==null&&o!==null){var m=i.pending;m===null?o.next=o:(o.next=m.next,m.next=o),i.pending=o}u!==0&&lf(s,o,u)}}function pl(e,t,s,i){Ut[Ys++]=e,Ut[Ys++]=t,Ut[Ys++]=s,Ut[Ys++]=i,yo|=i,e.lanes|=i,e=e.alternate,e!==null&&(e.lanes|=i)}function vo(e,t,s,i){return pl(e,t,s,i),yl(e)}function Fs(e,t){return pl(e,null,null,t),yl(e)}function lf(e,t,s){e.lanes|=s;var i=e.alternate;i!==null&&(i.lanes|=s);for(var o=!1,u=e.return;u!==null;)u.childLanes|=s,i=u.alternate,i!==null&&(i.childLanes|=s),u.tag===22&&(e=u.stateNode,e===null||e._visibility&1||(o=!0)),e=u,u=u.return;return e.tag===3?(u=e.stateNode,o&&t!==null&&(o=31-xt(s),e=u.hiddenUpdates,i=e[o],i===null?e[o]=[t]:i.push(t),t.lane=s|536870912),u):null}function yl(e){if(50<yi)throw yi=0,Ec=null,Error(l(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Vs={};function Cy(e,t,s,i){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wt(e,t,s,i){return new Cy(e,t,s,i)}function bo(e){return e=e.prototype,!(!e||!e.isReactComponent)}function rn(e,t){var s=e.alternate;return s===null?(s=wt(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&65011712,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s.refCleanup=e.refCleanup,s}function rf(e,t){e.flags&=65011714;var s=e.alternate;return s===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=s.childLanes,e.lanes=s.lanes,e.child=s.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=s.memoizedProps,e.memoizedState=s.memoizedState,e.updateQueue=s.updateQueue,e.type=s.type,t=s.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function vl(e,t,s,i,o,u){var m=0;if(i=e,typeof e=="function")bo(e)&&(m=1);else if(typeof e=="string")m=Tv(e,s,Xe.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case F:return e=wt(31,s,t,o),e.elementType=F,e.lanes=u,e;case O:return ls(s.children,o,u,t);case L:m=8,o|=24;break;case V:return e=wt(12,s,t,o|2),e.elementType=V,e.lanes=u,e;case Q:return e=wt(13,s,t,o),e.elementType=Q,e.lanes=u,e;case ee:return e=wt(19,s,t,o),e.elementType=ee,e.lanes=u,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case K:case U:m=10;break e;case P:m=9;break e;case I:m=11;break e;case $:m=14;break e;case M:m=16,i=null;break e}m=29,s=Error(l(130,e===null?"null":typeof e,"")),i=null}return t=wt(m,s,t,o),t.elementType=e,t.type=i,t.lanes=u,t}function ls(e,t,s,i){return e=wt(7,e,i,t),e.lanes=s,e}function xo(e,t,s){return e=wt(6,e,null,t),e.lanes=s,e}function _o(e,t,s){return t=wt(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Qs=[],Xs=0,bl=null,xl=0,Lt=[],zt=0,rs=null,on=1,cn="";function os(e,t){Qs[Xs++]=xl,Qs[Xs++]=bl,bl=e,xl=t}function of(e,t,s){Lt[zt++]=on,Lt[zt++]=cn,Lt[zt++]=rs,rs=e;var i=on;e=cn;var o=32-xt(i)-1;i&=~(1<<o),s+=1;var u=32-xt(t)+o;if(30<u){var m=o-o%5;u=(i&(1<<m)-1).toString(32),i>>=m,o-=m,on=1<<32-xt(t)+o|s<<o|i,cn=u+e}else on=1<<u|s<<o|i,cn=e}function wo(e){e.return!==null&&(os(e,1),of(e,1,0))}function So(e){for(;e===bl;)bl=Qs[--Xs],Qs[Xs]=null,xl=Qs[--Xs],Qs[Xs]=null;for(;e===rs;)rs=Lt[--zt],Lt[zt]=null,cn=Lt[--zt],Lt[zt]=null,on=Lt[--zt],Lt[zt]=null}var ft=null,Le=null,pe=!1,cs=null,Jt=!1,Eo=Error(l(519));function us(e){var t=Error(l(418,""));throw Ka(kt(t,e)),Eo}function cf(e){var t=e.stateNode,s=e.type,i=e.memoizedProps;switch(t[lt]=e,t[ht]=i,s){case"dialog":ue("cancel",t),ue("close",t);break;case"iframe":case"object":case"embed":ue("load",t);break;case"video":case"audio":for(s=0;s<bi.length;s++)ue(bi[s],t);break;case"source":ue("error",t);break;case"img":case"image":case"link":ue("error",t),ue("load",t);break;case"details":ue("toggle",t);break;case"input":ue("invalid",t),Sd(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),ll(t);break;case"select":ue("invalid",t);break;case"textarea":ue("invalid",t),Cd(t,i.value,i.defaultValue,i.children),ll(t)}s=i.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||t.textContent===""+s||i.suppressHydrationWarning===!0||Nm(t.textContent,s)?(i.popover!=null&&(ue("beforetoggle",t),ue("toggle",t)),i.onScroll!=null&&ue("scroll",t),i.onScrollEnd!=null&&ue("scrollend",t),i.onClick!=null&&(t.onclick=er),t=!0):t=!1,t||us(e)}function uf(e){for(ft=e.return;ft;)switch(ft.tag){case 5:case 13:Jt=!1;return;case 27:case 3:Jt=!0;return;default:ft=ft.return}}function Xa(e){if(e!==ft)return!1;if(!pe)return uf(e),pe=!0,!1;var t=e.tag,s;if((s=t!==3&&t!==27)&&((s=t===5)&&(s=e.type,s=!(s!=="form"&&s!=="button")||Hc(e.type,e.memoizedProps)),s=!s),s&&Le&&us(e),uf(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(s=e.data,s==="/$"){if(t===0){Le=Yt(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++;e=e.nextSibling}Le=null}}else t===27?(t=Le,Vn(e.type)?(e=Fc,Fc=null,Le=e):Le=t):Le=ft?Yt(e.stateNode.nextSibling):null;return!0}function $a(){Le=ft=null,pe=!1}function df(){var e=cs;return e!==null&&(yt===null?yt=e:yt.push.apply(yt,e),cs=null),e}function Ka(e){cs===null?cs=[e]:cs.push(e)}var Co=dt(null),ds=null,un=null;function Dn(e,t,s){we(Co,t._currentValue),t._currentValue=s}function dn(e){e._currentValue=Co.current,ke(Co)}function No(e,t,s){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===s)break;e=e.return}}function To(e,t,s,i){var o=e.child;for(o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){var m=o.child;u=u.firstContext;e:for(;u!==null;){var v=u;u=o;for(var S=0;S<t.length;S++)if(v.context===t[S]){u.lanes|=s,v=u.alternate,v!==null&&(v.lanes|=s),No(u.return,s,e),i||(m=null);break e}u=v.next}}else if(o.tag===18){if(m=o.return,m===null)throw Error(l(341));m.lanes|=s,u=m.alternate,u!==null&&(u.lanes|=s),No(m,s,e),m=null}else m=o.child;if(m!==null)m.return=o;else for(m=o;m!==null;){if(m===e){m=null;break}if(o=m.sibling,o!==null){o.return=m.return,m=o;break}m=m.return}o=m}}function Za(e,t,s,i){e=null;for(var o=t,u=!1;o!==null;){if(!u){if((o.flags&524288)!==0)u=!0;else if((o.flags&262144)!==0)break}if(o.tag===10){var m=o.alternate;if(m===null)throw Error(l(387));if(m=m.memoizedProps,m!==null){var v=o.type;_t(o.pendingProps.value,m.value)||(e!==null?e.push(v):e=[v])}}else if(o===Wi.current){if(m=o.alternate,m===null)throw Error(l(387));m.memoizedState.memoizedState!==o.memoizedState.memoizedState&&(e!==null?e.push(Ci):e=[Ci])}o=o.return}e!==null&&To(t,e,s,i),t.flags|=262144}function _l(e){for(e=e.firstContext;e!==null;){if(!_t(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function fs(e){ds=e,un=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function rt(e){return ff(ds,e)}function wl(e,t){return ds===null&&fs(e),ff(e,t)}function ff(e,t){var s=t._currentValue;if(t={context:t,memoizedValue:s,next:null},un===null){if(e===null)throw Error(l(308));un=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else un=un.next=t;return s}var Ny=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(s,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach(function(s){return s()})}},Ty=r.unstable_scheduleCallback,Ry=r.unstable_NormalPriority,Fe={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ro(){return{controller:new Ny,data:new Map,refCount:0}}function Wa(e){e.refCount--,e.refCount===0&&Ty(Ry,function(){e.controller.abort()})}var Ja=null,Ao=0,$s=0,Ks=null;function Ay(e,t){if(Ja===null){var s=Ja=[];Ao=0,$s=jc(),Ks={status:"pending",value:void 0,then:function(i){s.push(i)}}}return Ao++,t.then(hf,hf),t}function hf(){if(--Ao===0&&Ja!==null){Ks!==null&&(Ks.status="fulfilled");var e=Ja;Ja=null,$s=0,Ks=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Dy(e,t){var s=[],i={status:"pending",value:null,reason:null,then:function(o){s.push(o)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var o=0;o<s.length;o++)(0,s[o])(t)},function(o){for(i.status="rejected",i.reason=o,o=0;o<s.length;o++)(0,s[o])(void 0)}),i}var mf=T.S;T.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Ay(e,t),mf!==null&&mf(e,t)};var hs=dt(null);function Do(){var e=hs.current;return e!==null?e:Te.pooledCache}function Sl(e,t){t===null?we(hs,hs.current):we(hs,t.pool)}function gf(){var e=Do();return e===null?null:{parent:Fe._currentValue,pool:e}}var Pa=Error(l(460)),pf=Error(l(474)),El=Error(l(542)),jo={then:function(){}};function yf(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Cl(){}function vf(e,t,s){switch(s=e[s],s===void 0?e.push(t):s!==t&&(t.then(Cl,Cl),t=s),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,xf(e),e;default:if(typeof t.status=="string")t.then(Cl,Cl);else{if(e=Te,e!==null&&100<e.shellSuspendCounter)throw Error(l(482));e=t,e.status="pending",e.then(function(i){if(t.status==="pending"){var o=t;o.status="fulfilled",o.value=i}},function(i){if(t.status==="pending"){var o=t;o.status="rejected",o.reason=i}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,xf(e),e}throw ei=t,Pa}}var ei=null;function bf(){if(ei===null)throw Error(l(459));var e=ei;return ei=null,e}function xf(e){if(e===Pa||e===El)throw Error(l(483))}var jn=!1;function Mo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Mn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function On(e,t,s){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,(be&2)!==0){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,t=yl(e),lf(e,null,s),t}return pl(e,i,t,s),yl(e)}function ti(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194048)!==0)){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,fd(e,s)}}function ko(e,t){var s=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,s===i)){var o=null,u=null;if(s=s.firstBaseUpdate,s!==null){do{var m={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};u===null?o=u=m:u=u.next=m,s=s.next}while(s!==null);u===null?o=u=t:u=u.next=t}else o=u=t;s={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:u,shared:i.shared,callbacks:i.callbacks},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}var Uo=!1;function ni(){if(Uo){var e=Ks;if(e!==null)throw e}}function si(e,t,s,i){Uo=!1;var o=e.updateQueue;jn=!1;var u=o.firstBaseUpdate,m=o.lastBaseUpdate,v=o.shared.pending;if(v!==null){o.shared.pending=null;var S=v,A=S.next;S.next=null,m===null?u=A:m.next=A,m=S;var k=e.alternate;k!==null&&(k=k.updateQueue,v=k.lastBaseUpdate,v!==m&&(v===null?k.firstBaseUpdate=A:v.next=A,k.lastBaseUpdate=S))}if(u!==null){var B=o.baseState;m=0,k=A=S=null,v=u;do{var D=v.lane&-536870913,j=D!==v.lane;if(j?(he&D)===D:(i&D)===D){D!==0&&D===$s&&(Uo=!0),k!==null&&(k=k.next={lane:0,tag:v.tag,payload:v.payload,callback:null,next:null});e:{var le=e,ae=v;D=t;var Ce=s;switch(ae.tag){case 1:if(le=ae.payload,typeof le=="function"){B=le.call(Ce,B,D);break e}B=le;break e;case 3:le.flags=le.flags&-65537|128;case 0:if(le=ae.payload,D=typeof le=="function"?le.call(Ce,B,D):le,D==null)break e;B=b({},B,D);break e;case 2:jn=!0}}D=v.callback,D!==null&&(e.flags|=64,j&&(e.flags|=8192),j=o.callbacks,j===null?o.callbacks=[D]:j.push(D))}else j={lane:D,tag:v.tag,payload:v.payload,callback:v.callback,next:null},k===null?(A=k=j,S=B):k=k.next=j,m|=D;if(v=v.next,v===null){if(v=o.shared.pending,v===null)break;j=v,v=j.next,j.next=null,o.lastBaseUpdate=j,o.shared.pending=null}}while(!0);k===null&&(S=B),o.baseState=S,o.firstBaseUpdate=A,o.lastBaseUpdate=k,u===null&&(o.shared.lanes=0),In|=m,e.lanes=m,e.memoizedState=B}}function _f(e,t){if(typeof e!="function")throw Error(l(191,e));e.call(t)}function wf(e,t){var s=e.callbacks;if(s!==null)for(e.callbacks=null,e=0;e<s.length;e++)_f(s[e],t)}var Zs=dt(null),Nl=dt(0);function Sf(e,t){e=vn,we(Nl,e),we(Zs,t),vn=e|t.baseLanes}function Lo(){we(Nl,vn),we(Zs,Zs.current)}function zo(){vn=Nl.current,ke(Zs),ke(Nl)}var kn=0,re=null,Se=null,Ge=null,Tl=!1,Ws=!1,ms=!1,Rl=0,ai=0,Js=null,jy=0;function qe(){throw Error(l(321))}function Bo(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!_t(e[s],t[s]))return!1;return!0}function qo(e,t,s,i,o,u){return kn=u,re=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,T.H=e===null||e.memoizedState===null?lh:rh,ms=!1,u=s(i,o),ms=!1,Ws&&(u=Cf(t,s,i,o)),Ef(e),u}function Ef(e){T.H=kl;var t=Se!==null&&Se.next!==null;if(kn=0,Ge=Se=re=null,Tl=!1,ai=0,Js=null,t)throw Error(l(300));e===null||Ke||(e=e.dependencies,e!==null&&_l(e)&&(Ke=!0))}function Cf(e,t,s,i){re=e;var o=0;do{if(Ws&&(Js=null),ai=0,Ws=!1,25<=o)throw Error(l(301));if(o+=1,Ge=Se=null,e.updateQueue!=null){var u=e.updateQueue;u.lastEffect=null,u.events=null,u.stores=null,u.memoCache!=null&&(u.memoCache.index=0)}T.H=By,u=t(s,i)}while(Ws);return u}function My(){var e=T.H,t=e.useState()[0];return t=typeof t.then=="function"?ii(t):t,e=e.useState()[0],(Se!==null?Se.memoizedState:null)!==e&&(re.flags|=1024),t}function Ho(){var e=Rl!==0;return Rl=0,e}function Io(e,t,s){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s}function Go(e){if(Tl){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Tl=!1}kn=0,Ge=Se=re=null,Ws=!1,ai=Rl=0,Js=null}function gt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ge===null?re.memoizedState=Ge=e:Ge=Ge.next=e,Ge}function Ye(){if(Se===null){var e=re.alternate;e=e!==null?e.memoizedState:null}else e=Se.next;var t=Ge===null?re.memoizedState:Ge.next;if(t!==null)Ge=t,Se=e;else{if(e===null)throw re.alternate===null?Error(l(467)):Error(l(310));Se=e,e={memoizedState:Se.memoizedState,baseState:Se.baseState,baseQueue:Se.baseQueue,queue:Se.queue,next:null},Ge===null?re.memoizedState=Ge=e:Ge=Ge.next=e}return Ge}function Yo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ii(e){var t=ai;return ai+=1,Js===null&&(Js=[]),e=vf(Js,e,t),t=re,(Ge===null?t.memoizedState:Ge.next)===null&&(t=t.alternate,T.H=t===null||t.memoizedState===null?lh:rh),e}function Al(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return ii(e);if(e.$$typeof===U)return rt(e)}throw Error(l(438,String(e)))}function Fo(e){var t=null,s=re.updateQueue;if(s!==null&&(t=s.memoCache),t==null){var i=re.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(t={data:i.data.map(function(o){return o.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),s===null&&(s=Yo(),re.updateQueue=s),s.memoCache=t,s=t.data[t.index],s===void 0)for(s=t.data[t.index]=Array(e),i=0;i<e;i++)s[i]=H;return t.index++,s}function fn(e,t){return typeof t=="function"?t(e):t}function Dl(e){var t=Ye();return Vo(t,Se,e)}function Vo(e,t,s){var i=e.queue;if(i===null)throw Error(l(311));i.lastRenderedReducer=s;var o=e.baseQueue,u=i.pending;if(u!==null){if(o!==null){var m=o.next;o.next=u.next,u.next=m}t.baseQueue=o=u,i.pending=null}if(u=e.baseState,o===null)e.memoizedState=u;else{t=o.next;var v=m=null,S=null,A=t,k=!1;do{var B=A.lane&-536870913;if(B!==A.lane?(he&B)===B:(kn&B)===B){var D=A.revertLane;if(D===0)S!==null&&(S=S.next={lane:0,revertLane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),B===$s&&(k=!0);else if((kn&D)===D){A=A.next,D===$s&&(k=!0);continue}else B={lane:0,revertLane:A.revertLane,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null},S===null?(v=S=B,m=u):S=S.next=B,re.lanes|=D,In|=D;B=A.action,ms&&s(u,B),u=A.hasEagerState?A.eagerState:s(u,B)}else D={lane:B,revertLane:A.revertLane,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null},S===null?(v=S=D,m=u):S=S.next=D,re.lanes|=B,In|=B;A=A.next}while(A!==null&&A!==t);if(S===null?m=u:S.next=v,!_t(u,e.memoizedState)&&(Ke=!0,k&&(s=Ks,s!==null)))throw s;e.memoizedState=u,e.baseState=m,e.baseQueue=S,i.lastRenderedState=u}return o===null&&(i.lanes=0),[e.memoizedState,i.dispatch]}function Qo(e){var t=Ye(),s=t.queue;if(s===null)throw Error(l(311));s.lastRenderedReducer=e;var i=s.dispatch,o=s.pending,u=t.memoizedState;if(o!==null){s.pending=null;var m=o=o.next;do u=e(u,m.action),m=m.next;while(m!==o);_t(u,t.memoizedState)||(Ke=!0),t.memoizedState=u,t.baseQueue===null&&(t.baseState=u),s.lastRenderedState=u}return[u,i]}function Nf(e,t,s){var i=re,o=Ye(),u=pe;if(u){if(s===void 0)throw Error(l(407));s=s()}else s=t();var m=!_t((Se||o).memoizedState,s);m&&(o.memoizedState=s,Ke=!0),o=o.queue;var v=Af.bind(null,i,o,e);if(li(2048,8,v,[e]),o.getSnapshot!==t||m||Ge!==null&&Ge.memoizedState.tag&1){if(i.flags|=2048,Ps(9,jl(),Rf.bind(null,i,o,s,t),null),Te===null)throw Error(l(349));u||(kn&124)!==0||Tf(i,t,s)}return s}function Tf(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=re.updateQueue,t===null?(t=Yo(),re.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function Rf(e,t,s,i){t.value=s,t.getSnapshot=i,Df(t)&&jf(e)}function Af(e,t,s){return s(function(){Df(t)&&jf(e)})}function Df(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!_t(e,s)}catch{return!0}}function jf(e){var t=Fs(e,2);t!==null&&Tt(t,e,2)}function Xo(e){var t=gt();if(typeof e=="function"){var s=e;if(e=s(),ms){Tn(!0);try{s()}finally{Tn(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:e},t}function Mf(e,t,s,i){return e.baseState=s,Vo(e,Se,typeof i=="function"?i:fn)}function Oy(e,t,s,i,o){if(Ol(e))throw Error(l(485));if(e=t.action,e!==null){var u={payload:o,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){u.listeners.push(m)}};T.T!==null?s(!0):u.isTransition=!1,i(u),s=t.pending,s===null?(u.next=t.pending=u,Of(t,u)):(u.next=s.next,t.pending=s.next=u)}}function Of(e,t){var s=t.action,i=t.payload,o=e.state;if(t.isTransition){var u=T.T,m={};T.T=m;try{var v=s(o,i),S=T.S;S!==null&&S(m,v),kf(e,t,v)}catch(A){$o(e,t,A)}finally{T.T=u}}else try{u=s(o,i),kf(e,t,u)}catch(A){$o(e,t,A)}}function kf(e,t,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(i){Uf(e,t,i)},function(i){return $o(e,t,i)}):Uf(e,t,s)}function Uf(e,t,s){t.status="fulfilled",t.value=s,Lf(t),e.state=s,t=e.pending,t!==null&&(s=t.next,s===t?e.pending=null:(s=s.next,t.next=s,Of(e,s)))}function $o(e,t,s){var i=e.pending;if(e.pending=null,i!==null){i=i.next;do t.status="rejected",t.reason=s,Lf(t),t=t.next;while(t!==i)}e.action=null}function Lf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function zf(e,t){return t}function Bf(e,t){if(pe){var s=Te.formState;if(s!==null){e:{var i=re;if(pe){if(Le){t:{for(var o=Le,u=Jt;o.nodeType!==8;){if(!u){o=null;break t}if(o=Yt(o.nextSibling),o===null){o=null;break t}}u=o.data,o=u==="F!"||u==="F"?o:null}if(o){Le=Yt(o.nextSibling),i=o.data==="F!";break e}}us(i)}i=!1}i&&(t=s[0])}}return s=gt(),s.memoizedState=s.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zf,lastRenderedState:t},s.queue=i,s=sh.bind(null,re,i),i.dispatch=s,i=Xo(!1),u=Po.bind(null,re,!1,i.queue),i=gt(),o={state:t,dispatch:null,action:e,pending:null},i.queue=o,s=Oy.bind(null,re,o,u,s),o.dispatch=s,i.memoizedState=e,[t,s,!1]}function qf(e){var t=Ye();return Hf(t,Se,e)}function Hf(e,t,s){if(t=Vo(e,t,zf)[0],e=Dl(fn)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var i=ii(t)}catch(m){throw m===Pa?El:m}else i=t;t=Ye();var o=t.queue,u=o.dispatch;return s!==t.memoizedState&&(re.flags|=2048,Ps(9,jl(),ky.bind(null,o,s),null)),[i,u,e]}function ky(e,t){e.action=t}function If(e){var t=Ye(),s=Se;if(s!==null)return Hf(t,s,e);Ye(),t=t.memoizedState,s=Ye();var i=s.queue.dispatch;return s.memoizedState=e,[t,i,!1]}function Ps(e,t,s,i){return e={tag:e,create:s,deps:i,inst:t,next:null},t=re.updateQueue,t===null&&(t=Yo(),re.updateQueue=t),s=t.lastEffect,s===null?t.lastEffect=e.next=e:(i=s.next,s.next=e,e.next=i,t.lastEffect=e),e}function jl(){return{destroy:void 0,resource:void 0}}function Gf(){return Ye().memoizedState}function Ml(e,t,s,i){var o=gt();i=i===void 0?null:i,re.flags|=e,o.memoizedState=Ps(1|t,jl(),s,i)}function li(e,t,s,i){var o=Ye();i=i===void 0?null:i;var u=o.memoizedState.inst;Se!==null&&i!==null&&Bo(i,Se.memoizedState.deps)?o.memoizedState=Ps(t,u,s,i):(re.flags|=e,o.memoizedState=Ps(1|t,u,s,i))}function Yf(e,t){Ml(8390656,8,e,t)}function Ff(e,t){li(2048,8,e,t)}function Vf(e,t){return li(4,2,e,t)}function Qf(e,t){return li(4,4,e,t)}function Xf(e,t){if(typeof t=="function"){e=e();var s=t(e);return function(){typeof s=="function"?s():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $f(e,t,s){s=s!=null?s.concat([e]):null,li(4,4,Xf.bind(null,t,e),s)}function Ko(){}function Kf(e,t){var s=Ye();t=t===void 0?null:t;var i=s.memoizedState;return t!==null&&Bo(t,i[1])?i[0]:(s.memoizedState=[e,t],e)}function Zf(e,t){var s=Ye();t=t===void 0?null:t;var i=s.memoizedState;if(t!==null&&Bo(t,i[1]))return i[0];if(i=e(),ms){Tn(!0);try{e()}finally{Tn(!1)}}return s.memoizedState=[i,t],i}function Zo(e,t,s){return s===void 0||(kn&1073741824)!==0?e.memoizedState=t:(e.memoizedState=s,e=Ph(),re.lanes|=e,In|=e,s)}function Wf(e,t,s,i){return _t(s,t)?s:Zs.current!==null?(e=Zo(e,s,i),_t(e,t)||(Ke=!0),e):(kn&42)===0?(Ke=!0,e.memoizedState=s):(e=Ph(),re.lanes|=e,In|=e,t)}function Jf(e,t,s,i,o){var u=Y.p;Y.p=u!==0&&8>u?u:8;var m=T.T,v={};T.T=v,Po(e,!1,t,s);try{var S=o(),A=T.S;if(A!==null&&A(v,S),S!==null&&typeof S=="object"&&typeof S.then=="function"){var k=Dy(S,i);ri(e,t,k,Nt(e))}else ri(e,t,i,Nt(e))}catch(B){ri(e,t,{then:function(){},status:"rejected",reason:B},Nt())}finally{Y.p=u,T.T=m}}function Uy(){}function Wo(e,t,s,i){if(e.tag!==5)throw Error(l(476));var o=Pf(e).queue;Jf(e,o,t,ne,s===null?Uy:function(){return eh(e),s(i)})}function Pf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:ne},next:null};var s={};return t.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fn,lastRenderedState:s},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function eh(e){var t=Pf(e).next.queue;ri(e,t,{},Nt())}function Jo(){return rt(Ci)}function th(){return Ye().memoizedState}function nh(){return Ye().memoizedState}function Ly(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var s=Nt();e=Mn(s);var i=On(t,e,s);i!==null&&(Tt(i,t,s),ti(i,t,s)),t={cache:Ro()},e.payload=t;return}t=t.return}}function zy(e,t,s){var i=Nt();s={lane:i,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null},Ol(e)?ah(t,s):(s=vo(e,t,s,i),s!==null&&(Tt(s,e,i),ih(s,t,i)))}function sh(e,t,s){var i=Nt();ri(e,t,s,i)}function ri(e,t,s,i){var o={lane:i,revertLane:0,action:s,hasEagerState:!1,eagerState:null,next:null};if(Ol(e))ah(t,o);else{var u=e.alternate;if(e.lanes===0&&(u===null||u.lanes===0)&&(u=t.lastRenderedReducer,u!==null))try{var m=t.lastRenderedState,v=u(m,s);if(o.hasEagerState=!0,o.eagerState=v,_t(v,m))return pl(e,t,o,0),Te===null&&gl(),!1}catch{}finally{}if(s=vo(e,t,o,i),s!==null)return Tt(s,e,i),ih(s,t,i),!0}return!1}function Po(e,t,s,i){if(i={lane:2,revertLane:jc(),action:i,hasEagerState:!1,eagerState:null,next:null},Ol(e)){if(t)throw Error(l(479))}else t=vo(e,s,i,2),t!==null&&Tt(t,e,2)}function Ol(e){var t=e.alternate;return e===re||t!==null&&t===re}function ah(e,t){Ws=Tl=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function ih(e,t,s){if((s&4194048)!==0){var i=t.lanes;i&=e.pendingLanes,s|=i,t.lanes=s,fd(e,s)}}var kl={readContext:rt,use:Al,useCallback:qe,useContext:qe,useEffect:qe,useImperativeHandle:qe,useLayoutEffect:qe,useInsertionEffect:qe,useMemo:qe,useReducer:qe,useRef:qe,useState:qe,useDebugValue:qe,useDeferredValue:qe,useTransition:qe,useSyncExternalStore:qe,useId:qe,useHostTransitionStatus:qe,useFormState:qe,useActionState:qe,useOptimistic:qe,useMemoCache:qe,useCacheRefresh:qe},lh={readContext:rt,use:Al,useCallback:function(e,t){return gt().memoizedState=[e,t===void 0?null:t],e},useContext:rt,useEffect:Yf,useImperativeHandle:function(e,t,s){s=s!=null?s.concat([e]):null,Ml(4194308,4,Xf.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ml(4194308,4,e,t)},useInsertionEffect:function(e,t){Ml(4,2,e,t)},useMemo:function(e,t){var s=gt();t=t===void 0?null:t;var i=e();if(ms){Tn(!0);try{e()}finally{Tn(!1)}}return s.memoizedState=[i,t],i},useReducer:function(e,t,s){var i=gt();if(s!==void 0){var o=s(t);if(ms){Tn(!0);try{s(t)}finally{Tn(!1)}}}else o=t;return i.memoizedState=i.baseState=o,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},i.queue=e,e=e.dispatch=zy.bind(null,re,e),[i.memoizedState,e]},useRef:function(e){var t=gt();return e={current:e},t.memoizedState=e},useState:function(e){e=Xo(e);var t=e.queue,s=sh.bind(null,re,t);return t.dispatch=s,[e.memoizedState,s]},useDebugValue:Ko,useDeferredValue:function(e,t){var s=gt();return Zo(s,e,t)},useTransition:function(){var e=Xo(!1);return e=Jf.bind(null,re,e.queue,!0,!1),gt().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,s){var i=re,o=gt();if(pe){if(s===void 0)throw Error(l(407));s=s()}else{if(s=t(),Te===null)throw Error(l(349));(he&124)!==0||Tf(i,t,s)}o.memoizedState=s;var u={value:s,getSnapshot:t};return o.queue=u,Yf(Af.bind(null,i,u,e),[e]),i.flags|=2048,Ps(9,jl(),Rf.bind(null,i,u,s,t),null),s},useId:function(){var e=gt(),t=Te.identifierPrefix;if(pe){var s=cn,i=on;s=(i&~(1<<32-xt(i)-1)).toString(32)+s,t="«"+t+"R"+s,s=Rl++,0<s&&(t+="H"+s.toString(32)),t+="»"}else s=jy++,t="«"+t+"r"+s.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Jo,useFormState:Bf,useActionState:Bf,useOptimistic:function(e){var t=gt();t.memoizedState=t.baseState=e;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=s,t=Po.bind(null,re,!0,s),s.dispatch=t,[e,t]},useMemoCache:Fo,useCacheRefresh:function(){return gt().memoizedState=Ly.bind(null,re)}},rh={readContext:rt,use:Al,useCallback:Kf,useContext:rt,useEffect:Ff,useImperativeHandle:$f,useInsertionEffect:Vf,useLayoutEffect:Qf,useMemo:Zf,useReducer:Dl,useRef:Gf,useState:function(){return Dl(fn)},useDebugValue:Ko,useDeferredValue:function(e,t){var s=Ye();return Wf(s,Se.memoizedState,e,t)},useTransition:function(){var e=Dl(fn)[0],t=Ye().memoizedState;return[typeof e=="boolean"?e:ii(e),t]},useSyncExternalStore:Nf,useId:th,useHostTransitionStatus:Jo,useFormState:qf,useActionState:qf,useOptimistic:function(e,t){var s=Ye();return Mf(s,Se,e,t)},useMemoCache:Fo,useCacheRefresh:nh},By={readContext:rt,use:Al,useCallback:Kf,useContext:rt,useEffect:Ff,useImperativeHandle:$f,useInsertionEffect:Vf,useLayoutEffect:Qf,useMemo:Zf,useReducer:Qo,useRef:Gf,useState:function(){return Qo(fn)},useDebugValue:Ko,useDeferredValue:function(e,t){var s=Ye();return Se===null?Zo(s,e,t):Wf(s,Se.memoizedState,e,t)},useTransition:function(){var e=Qo(fn)[0],t=Ye().memoizedState;return[typeof e=="boolean"?e:ii(e),t]},useSyncExternalStore:Nf,useId:th,useHostTransitionStatus:Jo,useFormState:If,useActionState:If,useOptimistic:function(e,t){var s=Ye();return Se!==null?Mf(s,Se,e,t):(s.baseState=e,[e,s.queue.dispatch])},useMemoCache:Fo,useCacheRefresh:nh},ea=null,oi=0;function Ul(e){var t=oi;return oi+=1,ea===null&&(ea=[]),vf(ea,e,t)}function ci(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function Ll(e,t){throw t.$$typeof===x?Error(l(525)):(e=Object.prototype.toString.call(t),Error(l(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function oh(e){var t=e._init;return t(e._payload)}function ch(e){function t(N,E){if(e){var R=N.deletions;R===null?(N.deletions=[E],N.flags|=16):R.push(E)}}function s(N,E){if(!e)return null;for(;E!==null;)t(N,E),E=E.sibling;return null}function i(N){for(var E=new Map;N!==null;)N.key!==null?E.set(N.key,N):E.set(N.index,N),N=N.sibling;return E}function o(N,E){return N=rn(N,E),N.index=0,N.sibling=null,N}function u(N,E,R){return N.index=R,e?(R=N.alternate,R!==null?(R=R.index,R<E?(N.flags|=67108866,E):R):(N.flags|=67108866,E)):(N.flags|=1048576,E)}function m(N){return e&&N.alternate===null&&(N.flags|=67108866),N}function v(N,E,R,z){return E===null||E.tag!==6?(E=xo(R,N.mode,z),E.return=N,E):(E=o(E,R),E.return=N,E)}function S(N,E,R,z){var W=R.type;return W===O?k(N,E,R.props.children,z,R.key):E!==null&&(E.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===M&&oh(W)===E.type)?(E=o(E,R.props),ci(E,R),E.return=N,E):(E=vl(R.type,R.key,R.props,null,N.mode,z),ci(E,R),E.return=N,E)}function A(N,E,R,z){return E===null||E.tag!==4||E.stateNode.containerInfo!==R.containerInfo||E.stateNode.implementation!==R.implementation?(E=_o(R,N.mode,z),E.return=N,E):(E=o(E,R.children||[]),E.return=N,E)}function k(N,E,R,z,W){return E===null||E.tag!==7?(E=ls(R,N.mode,z,W),E.return=N,E):(E=o(E,R),E.return=N,E)}function B(N,E,R){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=xo(""+E,N.mode,R),E.return=N,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case _:return R=vl(E.type,E.key,E.props,null,N.mode,R),ci(R,E),R.return=N,R;case C:return E=_o(E,N.mode,R),E.return=N,E;case M:var z=E._init;return E=z(E._payload),B(N,E,R)}if(J(E)||G(E))return E=ls(E,N.mode,R,null),E.return=N,E;if(typeof E.then=="function")return B(N,Ul(E),R);if(E.$$typeof===U)return B(N,wl(N,E),R);Ll(N,E)}return null}function D(N,E,R,z){var W=E!==null?E.key:null;if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return W!==null?null:v(N,E,""+R,z);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case _:return R.key===W?S(N,E,R,z):null;case C:return R.key===W?A(N,E,R,z):null;case M:return W=R._init,R=W(R._payload),D(N,E,R,z)}if(J(R)||G(R))return W!==null?null:k(N,E,R,z,null);if(typeof R.then=="function")return D(N,E,Ul(R),z);if(R.$$typeof===U)return D(N,E,wl(N,R),z);Ll(N,R)}return null}function j(N,E,R,z,W){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return N=N.get(R)||null,v(E,N,""+z,W);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case _:return N=N.get(z.key===null?R:z.key)||null,S(E,N,z,W);case C:return N=N.get(z.key===null?R:z.key)||null,A(E,N,z,W);case M:var oe=z._init;return z=oe(z._payload),j(N,E,R,z,W)}if(J(z)||G(z))return N=N.get(R)||null,k(E,N,z,W,null);if(typeof z.then=="function")return j(N,E,R,Ul(z),W);if(z.$$typeof===U)return j(N,E,R,wl(E,z),W);Ll(E,z)}return null}function le(N,E,R,z){for(var W=null,oe=null,te=E,ie=E=0,We=null;te!==null&&ie<R.length;ie++){te.index>ie?(We=te,te=null):We=te.sibling;var ge=D(N,te,R[ie],z);if(ge===null){te===null&&(te=We);break}e&&te&&ge.alternate===null&&t(N,te),E=u(ge,E,ie),oe===null?W=ge:oe.sibling=ge,oe=ge,te=We}if(ie===R.length)return s(N,te),pe&&os(N,ie),W;if(te===null){for(;ie<R.length;ie++)te=B(N,R[ie],z),te!==null&&(E=u(te,E,ie),oe===null?W=te:oe.sibling=te,oe=te);return pe&&os(N,ie),W}for(te=i(te);ie<R.length;ie++)We=j(te,N,ie,R[ie],z),We!==null&&(e&&We.alternate!==null&&te.delete(We.key===null?ie:We.key),E=u(We,E,ie),oe===null?W=We:oe.sibling=We,oe=We);return e&&te.forEach(function(Zn){return t(N,Zn)}),pe&&os(N,ie),W}function ae(N,E,R,z){if(R==null)throw Error(l(151));for(var W=null,oe=null,te=E,ie=E=0,We=null,ge=R.next();te!==null&&!ge.done;ie++,ge=R.next()){te.index>ie?(We=te,te=null):We=te.sibling;var Zn=D(N,te,ge.value,z);if(Zn===null){te===null&&(te=We);break}e&&te&&Zn.alternate===null&&t(N,te),E=u(Zn,E,ie),oe===null?W=Zn:oe.sibling=Zn,oe=Zn,te=We}if(ge.done)return s(N,te),pe&&os(N,ie),W;if(te===null){for(;!ge.done;ie++,ge=R.next())ge=B(N,ge.value,z),ge!==null&&(E=u(ge,E,ie),oe===null?W=ge:oe.sibling=ge,oe=ge);return pe&&os(N,ie),W}for(te=i(te);!ge.done;ie++,ge=R.next())ge=j(te,N,ie,ge.value,z),ge!==null&&(e&&ge.alternate!==null&&te.delete(ge.key===null?ie:ge.key),E=u(ge,E,ie),oe===null?W=ge:oe.sibling=ge,oe=ge);return e&&te.forEach(function(qv){return t(N,qv)}),pe&&os(N,ie),W}function Ce(N,E,R,z){if(typeof R=="object"&&R!==null&&R.type===O&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case _:e:{for(var W=R.key;E!==null;){if(E.key===W){if(W=R.type,W===O){if(E.tag===7){s(N,E.sibling),z=o(E,R.props.children),z.return=N,N=z;break e}}else if(E.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===M&&oh(W)===E.type){s(N,E.sibling),z=o(E,R.props),ci(z,R),z.return=N,N=z;break e}s(N,E);break}else t(N,E);E=E.sibling}R.type===O?(z=ls(R.props.children,N.mode,z,R.key),z.return=N,N=z):(z=vl(R.type,R.key,R.props,null,N.mode,z),ci(z,R),z.return=N,N=z)}return m(N);case C:e:{for(W=R.key;E!==null;){if(E.key===W)if(E.tag===4&&E.stateNode.containerInfo===R.containerInfo&&E.stateNode.implementation===R.implementation){s(N,E.sibling),z=o(E,R.children||[]),z.return=N,N=z;break e}else{s(N,E);break}else t(N,E);E=E.sibling}z=_o(R,N.mode,z),z.return=N,N=z}return m(N);case M:return W=R._init,R=W(R._payload),Ce(N,E,R,z)}if(J(R))return le(N,E,R,z);if(G(R)){if(W=G(R),typeof W!="function")throw Error(l(150));return R=W.call(R),ae(N,E,R,z)}if(typeof R.then=="function")return Ce(N,E,Ul(R),z);if(R.$$typeof===U)return Ce(N,E,wl(N,R),z);Ll(N,R)}return typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint"?(R=""+R,E!==null&&E.tag===6?(s(N,E.sibling),z=o(E,R),z.return=N,N=z):(s(N,E),z=xo(R,N.mode,z),z.return=N,N=z),m(N)):s(N,E)}return function(N,E,R,z){try{oi=0;var W=Ce(N,E,R,z);return ea=null,W}catch(te){if(te===Pa||te===El)throw te;var oe=wt(29,te,null,N.mode);return oe.lanes=z,oe.return=N,oe}finally{}}}var ta=ch(!0),uh=ch(!1),Bt=dt(null),Pt=null;function Un(e){var t=e.alternate;we(Ve,Ve.current&1),we(Bt,e),Pt===null&&(t===null||Zs.current!==null||t.memoizedState!==null)&&(Pt=e)}function dh(e){if(e.tag===22){if(we(Ve,Ve.current),we(Bt,e),Pt===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(Pt=e)}}else Ln()}function Ln(){we(Ve,Ve.current),we(Bt,Bt.current)}function hn(e){ke(Bt),Pt===e&&(Pt=null),ke(Ve)}var Ve=dt(0);function zl(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||Yc(s)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ec(e,t,s,i){t=e.memoizedState,s=s(i,t),s=s==null?t:b({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var tc={enqueueSetState:function(e,t,s){e=e._reactInternals;var i=Nt(),o=Mn(i);o.payload=t,s!=null&&(o.callback=s),t=On(e,o,i),t!==null&&(Tt(t,e,i),ti(t,e,i))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var i=Nt(),o=Mn(i);o.tag=1,o.payload=t,s!=null&&(o.callback=s),t=On(e,o,i),t!==null&&(Tt(t,e,i),ti(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=Nt(),i=Mn(s);i.tag=2,t!=null&&(i.callback=t),t=On(e,i,s),t!==null&&(Tt(t,e,s),ti(t,e,s))}};function fh(e,t,s,i,o,u,m){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,u,m):t.prototype&&t.prototype.isPureReactComponent?!Va(s,i)||!Va(o,u):!0}function hh(e,t,s,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,i),t.state!==e&&tc.enqueueReplaceState(t,t.state,null)}function gs(e,t){var s=t;if("ref"in t){s={};for(var i in t)i!=="ref"&&(s[i]=t[i])}if(e=e.defaultProps){s===t&&(s=b({},s));for(var o in e)s[o]===void 0&&(s[o]=e[o])}return s}var Bl=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function mh(e){Bl(e)}function gh(e){console.error(e)}function ph(e){Bl(e)}function ql(e,t){try{var s=e.onUncaughtError;s(t.value,{componentStack:t.stack})}catch(i){setTimeout(function(){throw i})}}function yh(e,t,s){try{var i=e.onCaughtError;i(s.value,{componentStack:s.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(o){setTimeout(function(){throw o})}}function nc(e,t,s){return s=Mn(s),s.tag=3,s.payload={element:null},s.callback=function(){ql(e,t)},s}function vh(e){return e=Mn(e),e.tag=3,e}function bh(e,t,s,i){var o=s.type.getDerivedStateFromError;if(typeof o=="function"){var u=i.value;e.payload=function(){return o(u)},e.callback=function(){yh(t,s,i)}}var m=s.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(e.callback=function(){yh(t,s,i),typeof o!="function"&&(Gn===null?Gn=new Set([this]):Gn.add(this));var v=i.stack;this.componentDidCatch(i.value,{componentStack:v!==null?v:""})})}function qy(e,t,s,i,o){if(s.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(t=s.alternate,t!==null&&Za(t,s,o,!0),s=Bt.current,s!==null){switch(s.tag){case 13:return Pt===null?Nc():s.alternate===null&&ze===0&&(ze=3),s.flags&=-257,s.flags|=65536,s.lanes=o,i===jo?s.flags|=16384:(t=s.updateQueue,t===null?s.updateQueue=new Set([i]):t.add(i),Rc(e,i,o)),!1;case 22:return s.flags|=65536,i===jo?s.flags|=16384:(t=s.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},s.updateQueue=t):(s=t.retryQueue,s===null?t.retryQueue=new Set([i]):s.add(i)),Rc(e,i,o)),!1}throw Error(l(435,s.tag))}return Rc(e,i,o),Nc(),!1}if(pe)return t=Bt.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=o,i!==Eo&&(e=Error(l(422),{cause:i}),Ka(kt(e,s)))):(i!==Eo&&(t=Error(l(423),{cause:i}),Ka(kt(t,s))),e=e.current.alternate,e.flags|=65536,o&=-o,e.lanes|=o,i=kt(i,s),o=nc(e.stateNode,i,o),ko(e,o),ze!==4&&(ze=2)),!1;var u=Error(l(520),{cause:i});if(u=kt(u,s),pi===null?pi=[u]:pi.push(u),ze!==4&&(ze=2),t===null)return!0;i=kt(i,s),s=t;do{switch(s.tag){case 3:return s.flags|=65536,e=o&-o,s.lanes|=e,e=nc(s.stateNode,i,e),ko(s,e),!1;case 1:if(t=s.type,u=s.stateNode,(s.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||u!==null&&typeof u.componentDidCatch=="function"&&(Gn===null||!Gn.has(u))))return s.flags|=65536,o&=-o,s.lanes|=o,o=vh(o),bh(o,e,s,i),ko(s,o),!1}s=s.return}while(s!==null);return!1}var xh=Error(l(461)),Ke=!1;function nt(e,t,s,i){t.child=e===null?uh(t,null,s,i):ta(t,e.child,s,i)}function _h(e,t,s,i,o){s=s.render;var u=t.ref;if("ref"in i){var m={};for(var v in i)v!=="ref"&&(m[v]=i[v])}else m=i;return fs(t),i=qo(e,t,s,m,u,o),v=Ho(),e!==null&&!Ke?(Io(e,t,o),mn(e,t,o)):(pe&&v&&wo(t),t.flags|=1,nt(e,t,i,o),t.child)}function wh(e,t,s,i,o){if(e===null){var u=s.type;return typeof u=="function"&&!bo(u)&&u.defaultProps===void 0&&s.compare===null?(t.tag=15,t.type=u,Sh(e,t,u,i,o)):(e=vl(s.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(u=e.child,!uc(e,o)){var m=u.memoizedProps;if(s=s.compare,s=s!==null?s:Va,s(m,i)&&e.ref===t.ref)return mn(e,t,o)}return t.flags|=1,e=rn(u,i),e.ref=t.ref,e.return=t,t.child=e}function Sh(e,t,s,i,o){if(e!==null){var u=e.memoizedProps;if(Va(u,i)&&e.ref===t.ref)if(Ke=!1,t.pendingProps=i=u,uc(e,o))(e.flags&131072)!==0&&(Ke=!0);else return t.lanes=e.lanes,mn(e,t,o)}return sc(e,t,s,i,o)}function Eh(e,t,s){var i=t.pendingProps,o=i.children,u=e!==null?e.memoizedState:null;if(i.mode==="hidden"){if((t.flags&128)!==0){if(i=u!==null?u.baseLanes|s:s,e!==null){for(o=t.child=e.child,u=0;o!==null;)u=u|o.lanes|o.childLanes,o=o.sibling;t.childLanes=u&~i}else t.childLanes=0,t.child=null;return Ch(e,t,i,s)}if((s&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Sl(t,u!==null?u.cachePool:null),u!==null?Sf(t,u):Lo(),dh(t);else return t.lanes=t.childLanes=536870912,Ch(e,t,u!==null?u.baseLanes|s:s,s)}else u!==null?(Sl(t,u.cachePool),Sf(t,u),Ln(),t.memoizedState=null):(e!==null&&Sl(t,null),Lo(),Ln());return nt(e,t,o,s),t.child}function Ch(e,t,s,i){var o=Do();return o=o===null?null:{parent:Fe._currentValue,pool:o},t.memoizedState={baseLanes:s,cachePool:o},e!==null&&Sl(t,null),Lo(),dh(t),e!==null&&Za(e,t,i,!0),null}function Hl(e,t){var s=t.ref;if(s===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(l(284));(e===null||e.ref!==s)&&(t.flags|=4194816)}}function sc(e,t,s,i,o){return fs(t),s=qo(e,t,s,i,void 0,o),i=Ho(),e!==null&&!Ke?(Io(e,t,o),mn(e,t,o)):(pe&&i&&wo(t),t.flags|=1,nt(e,t,s,o),t.child)}function Nh(e,t,s,i,o,u){return fs(t),t.updateQueue=null,s=Cf(t,i,s,o),Ef(e),i=Ho(),e!==null&&!Ke?(Io(e,t,u),mn(e,t,u)):(pe&&i&&wo(t),t.flags|=1,nt(e,t,s,u),t.child)}function Th(e,t,s,i,o){if(fs(t),t.stateNode===null){var u=Vs,m=s.contextType;typeof m=="object"&&m!==null&&(u=rt(m)),u=new s(i,u),t.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=tc,t.stateNode=u,u._reactInternals=t,u=t.stateNode,u.props=i,u.state=t.memoizedState,u.refs={},Mo(t),m=s.contextType,u.context=typeof m=="object"&&m!==null?rt(m):Vs,u.state=t.memoizedState,m=s.getDerivedStateFromProps,typeof m=="function"&&(ec(t,s,m,i),u.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(m=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),m!==u.state&&tc.enqueueReplaceState(u,u.state,null),si(t,i,u,o),ni(),u.state=t.memoizedState),typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!0}else if(e===null){u=t.stateNode;var v=t.memoizedProps,S=gs(s,v);u.props=S;var A=u.context,k=s.contextType;m=Vs,typeof k=="object"&&k!==null&&(m=rt(k));var B=s.getDerivedStateFromProps;k=typeof B=="function"||typeof u.getSnapshotBeforeUpdate=="function",v=t.pendingProps!==v,k||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(v||A!==m)&&hh(t,u,i,m),jn=!1;var D=t.memoizedState;u.state=D,si(t,i,u,o),ni(),A=t.memoizedState,v||D!==A||jn?(typeof B=="function"&&(ec(t,s,B,i),A=t.memoizedState),(S=jn||fh(t,s,S,i,D,A,m))?(k||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(t.flags|=4194308)):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=A),u.props=i,u.state=A,u.context=m,i=S):(typeof u.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{u=t.stateNode,Oo(e,t),m=t.memoizedProps,k=gs(s,m),u.props=k,B=t.pendingProps,D=u.context,A=s.contextType,S=Vs,typeof A=="object"&&A!==null&&(S=rt(A)),v=s.getDerivedStateFromProps,(A=typeof v=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(m!==B||D!==S)&&hh(t,u,i,S),jn=!1,D=t.memoizedState,u.state=D,si(t,i,u,o),ni();var j=t.memoizedState;m!==B||D!==j||jn||e!==null&&e.dependencies!==null&&_l(e.dependencies)?(typeof v=="function"&&(ec(t,s,v,i),j=t.memoizedState),(k=jn||fh(t,s,k,i,D,j,S)||e!==null&&e.dependencies!==null&&_l(e.dependencies))?(A||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(i,j,S),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(i,j,S)),typeof u.componentDidUpdate=="function"&&(t.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&D===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&D===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=j),u.props=i,u.state=j,u.context=S,i=k):(typeof u.componentDidUpdate!="function"||m===e.memoizedProps&&D===e.memoizedState||(t.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||m===e.memoizedProps&&D===e.memoizedState||(t.flags|=1024),i=!1)}return u=i,Hl(e,t),i=(t.flags&128)!==0,u||i?(u=t.stateNode,s=i&&typeof s.getDerivedStateFromError!="function"?null:u.render(),t.flags|=1,e!==null&&i?(t.child=ta(t,e.child,null,o),t.child=ta(t,null,s,o)):nt(e,t,s,o),t.memoizedState=u.state,e=t.child):e=mn(e,t,o),e}function Rh(e,t,s,i){return $a(),t.flags|=256,nt(e,t,s,i),t.child}var ac={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ic(e){return{baseLanes:e,cachePool:gf()}}function lc(e,t,s){return e=e!==null?e.childLanes&~s:0,t&&(e|=qt),e}function Ah(e,t,s){var i=t.pendingProps,o=!1,u=(t.flags&128)!==0,m;if((m=u)||(m=e!==null&&e.memoizedState===null?!1:(Ve.current&2)!==0),m&&(o=!0,t.flags&=-129),m=(t.flags&32)!==0,t.flags&=-33,e===null){if(pe){if(o?Un(t):Ln(),pe){var v=Le,S;if(S=v){e:{for(S=v,v=Jt;S.nodeType!==8;){if(!v){v=null;break e}if(S=Yt(S.nextSibling),S===null){v=null;break e}}v=S}v!==null?(t.memoizedState={dehydrated:v,treeContext:rs!==null?{id:on,overflow:cn}:null,retryLane:536870912,hydrationErrors:null},S=wt(18,null,null,0),S.stateNode=v,S.return=t,t.child=S,ft=t,Le=null,S=!0):S=!1}S||us(t)}if(v=t.memoizedState,v!==null&&(v=v.dehydrated,v!==null))return Yc(v)?t.lanes=32:t.lanes=536870912,null;hn(t)}return v=i.children,i=i.fallback,o?(Ln(),o=t.mode,v=Il({mode:"hidden",children:v},o),i=ls(i,o,s,null),v.return=t,i.return=t,v.sibling=i,t.child=v,o=t.child,o.memoizedState=ic(s),o.childLanes=lc(e,m,s),t.memoizedState=ac,i):(Un(t),rc(t,v))}if(S=e.memoizedState,S!==null&&(v=S.dehydrated,v!==null)){if(u)t.flags&256?(Un(t),t.flags&=-257,t=oc(e,t,s)):t.memoizedState!==null?(Ln(),t.child=e.child,t.flags|=128,t=null):(Ln(),o=i.fallback,v=t.mode,i=Il({mode:"visible",children:i.children},v),o=ls(o,v,s,null),o.flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,ta(t,e.child,null,s),i=t.child,i.memoizedState=ic(s),i.childLanes=lc(e,m,s),t.memoizedState=ac,t=o);else if(Un(t),Yc(v)){if(m=v.nextSibling&&v.nextSibling.dataset,m)var A=m.dgst;m=A,i=Error(l(419)),i.stack="",i.digest=m,Ka({value:i,source:null,stack:null}),t=oc(e,t,s)}else if(Ke||Za(e,t,s,!1),m=(s&e.childLanes)!==0,Ke||m){if(m=Te,m!==null&&(i=s&-s,i=(i&42)!==0?1:Yr(i),i=(i&(m.suspendedLanes|s))!==0?0:i,i!==0&&i!==S.retryLane))throw S.retryLane=i,Fs(e,i),Tt(m,e,i),xh;v.data==="$?"||Nc(),t=oc(e,t,s)}else v.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=S.treeContext,Le=Yt(v.nextSibling),ft=t,pe=!0,cs=null,Jt=!1,e!==null&&(Lt[zt++]=on,Lt[zt++]=cn,Lt[zt++]=rs,on=e.id,cn=e.overflow,rs=t),t=rc(t,i.children),t.flags|=4096);return t}return o?(Ln(),o=i.fallback,v=t.mode,S=e.child,A=S.sibling,i=rn(S,{mode:"hidden",children:i.children}),i.subtreeFlags=S.subtreeFlags&65011712,A!==null?o=rn(A,o):(o=ls(o,v,s,null),o.flags|=2),o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,v=e.child.memoizedState,v===null?v=ic(s):(S=v.cachePool,S!==null?(A=Fe._currentValue,S=S.parent!==A?{parent:A,pool:A}:S):S=gf(),v={baseLanes:v.baseLanes|s,cachePool:S}),o.memoizedState=v,o.childLanes=lc(e,m,s),t.memoizedState=ac,i):(Un(t),s=e.child,e=s.sibling,s=rn(s,{mode:"visible",children:i.children}),s.return=t,s.sibling=null,e!==null&&(m=t.deletions,m===null?(t.deletions=[e],t.flags|=16):m.push(e)),t.child=s,t.memoizedState=null,s)}function rc(e,t){return t=Il({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Il(e,t){return e=wt(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function oc(e,t,s){return ta(t,e.child,null,s),e=rc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Dh(e,t,s){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),No(e.return,t,s)}function cc(e,t,s,i,o){var u=e.memoizedState;u===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:s,tailMode:o}:(u.isBackwards=t,u.rendering=null,u.renderingStartTime=0,u.last=i,u.tail=s,u.tailMode=o)}function jh(e,t,s){var i=t.pendingProps,o=i.revealOrder,u=i.tail;if(nt(e,t,i.children,s),i=Ve.current,(i&2)!==0)i=i&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dh(e,s,t);else if(e.tag===19)Dh(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}switch(we(Ve,i),o){case"forwards":for(s=t.child,o=null;s!==null;)e=s.alternate,e!==null&&zl(e)===null&&(o=s),s=s.sibling;s=o,s===null?(o=t.child,t.child=null):(o=s.sibling,s.sibling=null),cc(t,!1,o,s,u);break;case"backwards":for(s=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&zl(e)===null){t.child=o;break}e=o.sibling,o.sibling=s,s=o,o=e}cc(t,!0,s,null,u);break;case"together":cc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function mn(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),In|=t.lanes,(s&t.childLanes)===0)if(e!==null){if(Za(e,t,s,!1),(s&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(l(153));if(t.child!==null){for(e=t.child,s=rn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=rn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function uc(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&_l(e)))}function Hy(e,t,s){switch(t.tag){case 3:Ji(t,t.stateNode.containerInfo),Dn(t,Fe,e.memoizedState.cache),$a();break;case 27:case 5:Br(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:Dn(t,t.type,t.memoizedProps.value);break;case 13:var i=t.memoizedState;if(i!==null)return i.dehydrated!==null?(Un(t),t.flags|=128,null):(s&t.child.childLanes)!==0?Ah(e,t,s):(Un(t),e=mn(e,t,s),e!==null?e.sibling:null);Un(t);break;case 19:var o=(e.flags&128)!==0;if(i=(s&t.childLanes)!==0,i||(Za(e,t,s,!1),i=(s&t.childLanes)!==0),o){if(i)return jh(e,t,s);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),we(Ve,Ve.current),i)break;return null;case 22:case 23:return t.lanes=0,Eh(e,t,s);case 24:Dn(t,Fe,e.memoizedState.cache)}return mn(e,t,s)}function Mh(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps)Ke=!0;else{if(!uc(e,s)&&(t.flags&128)===0)return Ke=!1,Hy(e,t,s);Ke=(e.flags&131072)!==0}else Ke=!1,pe&&(t.flags&1048576)!==0&&of(t,xl,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var i=t.elementType,o=i._init;if(i=o(i._payload),t.type=i,typeof i=="function")bo(i)?(e=gs(i,e),t.tag=1,t=Th(null,t,i,e,s)):(t.tag=0,t=sc(null,t,i,e,s));else{if(i!=null){if(o=i.$$typeof,o===I){t.tag=11,t=_h(null,t,i,e,s);break e}else if(o===$){t.tag=14,t=wh(null,t,i,e,s);break e}}throw t=Z(i)||i,Error(l(306,t,""))}}return t;case 0:return sc(e,t,t.type,t.pendingProps,s);case 1:return i=t.type,o=gs(i,t.pendingProps),Th(e,t,i,o,s);case 3:e:{if(Ji(t,t.stateNode.containerInfo),e===null)throw Error(l(387));i=t.pendingProps;var u=t.memoizedState;o=u.element,Oo(e,t),si(t,i,null,s);var m=t.memoizedState;if(i=m.cache,Dn(t,Fe,i),i!==u.cache&&To(t,[Fe],s,!0),ni(),i=m.element,u.isDehydrated)if(u={element:i,isDehydrated:!1,cache:m.cache},t.updateQueue.baseState=u,t.memoizedState=u,t.flags&256){t=Rh(e,t,i,s);break e}else if(i!==o){o=kt(Error(l(424)),t),Ka(o),t=Rh(e,t,i,s);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(Le=Yt(e.firstChild),ft=t,pe=!0,cs=null,Jt=!0,s=uh(t,null,i,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if($a(),i===o){t=mn(e,t,s);break e}nt(e,t,i,s)}t=t.child}return t;case 26:return Hl(e,t),e===null?(s=Lm(t.type,null,t.pendingProps,null))?t.memoizedState=s:pe||(s=t.type,e=t.pendingProps,i=tr(Nn.current).createElement(s),i[lt]=t,i[ht]=e,at(i,s,e),$e(i),t.stateNode=i):t.memoizedState=Lm(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Br(t),e===null&&pe&&(i=t.stateNode=Om(t.type,t.pendingProps,Nn.current),ft=t,Jt=!0,o=Le,Vn(t.type)?(Fc=o,Le=Yt(i.firstChild)):Le=o),nt(e,t,t.pendingProps.children,s),Hl(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&pe&&((o=i=Le)&&(i=mv(i,t.type,t.pendingProps,Jt),i!==null?(t.stateNode=i,ft=t,Le=Yt(i.firstChild),Jt=!1,o=!0):o=!1),o||us(t)),Br(t),o=t.type,u=t.pendingProps,m=e!==null?e.memoizedProps:null,i=u.children,Hc(o,u)?i=null:m!==null&&Hc(o,m)&&(t.flags|=32),t.memoizedState!==null&&(o=qo(e,t,My,null,null,s),Ci._currentValue=o),Hl(e,t),nt(e,t,i,s),t.child;case 6:return e===null&&pe&&((e=s=Le)&&(s=gv(s,t.pendingProps,Jt),s!==null?(t.stateNode=s,ft=t,Le=null,e=!0):e=!1),e||us(t)),null;case 13:return Ah(e,t,s);case 4:return Ji(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=ta(t,null,i,s):nt(e,t,i,s),t.child;case 11:return _h(e,t,t.type,t.pendingProps,s);case 7:return nt(e,t,t.pendingProps,s),t.child;case 8:return nt(e,t,t.pendingProps.children,s),t.child;case 12:return nt(e,t,t.pendingProps.children,s),t.child;case 10:return i=t.pendingProps,Dn(t,t.type,i.value),nt(e,t,i.children,s),t.child;case 9:return o=t.type._context,i=t.pendingProps.children,fs(t),o=rt(o),i=i(o),t.flags|=1,nt(e,t,i,s),t.child;case 14:return wh(e,t,t.type,t.pendingProps,s);case 15:return Sh(e,t,t.type,t.pendingProps,s);case 19:return jh(e,t,s);case 31:return i=t.pendingProps,s=t.mode,i={mode:i.mode,children:i.children},e===null?(s=Il(i,s),s.ref=t.ref,t.child=s,s.return=t,t=s):(s=rn(e.child,i),s.ref=t.ref,t.child=s,s.return=t,t=s),t;case 22:return Eh(e,t,s);case 24:return fs(t),i=rt(Fe),e===null?(o=Do(),o===null&&(o=Te,u=Ro(),o.pooledCache=u,u.refCount++,u!==null&&(o.pooledCacheLanes|=s),o=u),t.memoizedState={parent:i,cache:o},Mo(t),Dn(t,Fe,o)):((e.lanes&s)!==0&&(Oo(e,t),si(t,null,null,s),ni()),o=e.memoizedState,u=t.memoizedState,o.parent!==i?(o={parent:i,cache:i},t.memoizedState=o,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=o),Dn(t,Fe,i)):(i=u.cache,Dn(t,Fe,i),i!==o.cache&&To(t,[Fe],s,!0))),nt(e,t,t.pendingProps.children,s),t.child;case 29:throw t.pendingProps}throw Error(l(156,t.tag))}function gn(e){e.flags|=4}function Oh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Im(t)){if(t=Bt.current,t!==null&&((he&4194048)===he?Pt!==null:(he&62914560)!==he&&(he&536870912)===0||t!==Pt))throw ei=jo,pf;e.flags|=8192}}function Gl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?ud():536870912,e.lanes|=t,ia|=t)}function ui(e,t){if(!pe)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var i=null;s!==null;)s.alternate!==null&&(i=s),s=s.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function Ue(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,i=0;if(t)for(var o=e.child;o!==null;)s|=o.lanes|o.childLanes,i|=o.subtreeFlags&65011712,i|=o.flags&65011712,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)s|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=s,t}function Iy(e,t,s){var i=t.pendingProps;switch(So(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ue(t),null;case 1:return Ue(t),null;case 3:return s=t.stateNode,i=null,e!==null&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),dn(Fe),As(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Xa(t)?gn(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,df())),Ue(t),null;case 26:return s=t.memoizedState,e===null?(gn(t),s!==null?(Ue(t),Oh(t,s)):(Ue(t),t.flags&=-16777217)):s?s!==e.memoizedState?(gn(t),Ue(t),Oh(t,s)):(Ue(t),t.flags&=-16777217):(e.memoizedProps!==i&&gn(t),Ue(t),t.flags&=-16777217),null;case 27:Pi(t),s=Nn.current;var o=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==i&&gn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return Ue(t),null}e=Xe.current,Xa(t)?cf(t):(e=Om(o,i,s),t.stateNode=e,gn(t))}return Ue(t),null;case 5:if(Pi(t),s=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==i&&gn(t);else{if(!i){if(t.stateNode===null)throw Error(l(166));return Ue(t),null}if(e=Xe.current,Xa(t))cf(t);else{switch(o=tr(Nn.current),e){case 1:e=o.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:e=o.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":e=o.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":e=o.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof i.is=="string"?o.createElement("select",{is:i.is}):o.createElement("select"),i.multiple?e.multiple=!0:i.size&&(e.size=i.size);break;default:e=typeof i.is=="string"?o.createElement(s,{is:i.is}):o.createElement(s)}}e[lt]=t,e[ht]=i;e:for(o=t.child;o!==null;){if(o.tag===5||o.tag===6)e.appendChild(o.stateNode);else if(o.tag!==4&&o.tag!==27&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;o.sibling===null;){if(o.return===null||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=e;e:switch(at(e,s,i),s){case"button":case"input":case"select":case"textarea":e=!!i.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&gn(t)}}return Ue(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==i&&gn(t);else{if(typeof i!="string"&&t.stateNode===null)throw Error(l(166));if(e=Nn.current,Xa(t)){if(e=t.stateNode,s=t.memoizedProps,i=null,o=ft,o!==null)switch(o.tag){case 27:case 5:i=o.memoizedProps}e[lt]=t,e=!!(e.nodeValue===s||i!==null&&i.suppressHydrationWarning===!0||Nm(e.nodeValue,s)),e||us(t)}else e=tr(e).createTextNode(i),e[lt]=t,t.stateNode=e}return Ue(t),null;case 13:if(i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(o=Xa(t),i!==null&&i.dehydrated!==null){if(e===null){if(!o)throw Error(l(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(l(317));o[lt]=t}else $a(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ue(t),o=!1}else o=df(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=o),o=!0;if(!o)return t.flags&256?(hn(t),t):(hn(t),null)}if(hn(t),(t.flags&128)!==0)return t.lanes=s,t;if(s=i!==null,e=e!==null&&e.memoizedState!==null,s){i=t.child,o=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(o=i.alternate.memoizedState.cachePool.pool);var u=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048)}return s!==e&&s&&(t.child.flags|=8192),Gl(t,t.updateQueue),Ue(t),null;case 4:return As(),e===null&&Uc(t.stateNode.containerInfo),Ue(t),null;case 10:return dn(t.type),Ue(t),null;case 19:if(ke(Ve),o=t.memoizedState,o===null)return Ue(t),null;if(i=(t.flags&128)!==0,u=o.rendering,u===null)if(i)ui(o,!1);else{if(ze!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(u=zl(e),u!==null){for(t.flags|=128,ui(o,!1),e=u.updateQueue,t.updateQueue=e,Gl(t,e),t.subtreeFlags=0,e=s,s=t.child;s!==null;)rf(s,e),s=s.sibling;return we(Ve,Ve.current&1|2),t.child}e=e.sibling}o.tail!==null&&Wt()>Vl&&(t.flags|=128,i=!0,ui(o,!1),t.lanes=4194304)}else{if(!i)if(e=zl(u),e!==null){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,Gl(t,e),ui(o,!0),o.tail===null&&o.tailMode==="hidden"&&!u.alternate&&!pe)return Ue(t),null}else 2*Wt()-o.renderingStartTime>Vl&&s!==536870912&&(t.flags|=128,i=!0,ui(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(e=o.last,e!==null?e.sibling=u:t.child=u,o.last=u)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Wt(),t.sibling=null,e=Ve.current,we(Ve,i?e&1|2:e&1),t):(Ue(t),null);case 22:case 23:return hn(t),zo(),i=t.memoizedState!==null,e!==null?e.memoizedState!==null!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?(s&536870912)!==0&&(t.flags&128)===0&&(Ue(t),t.subtreeFlags&6&&(t.flags|=8192)):Ue(t),s=t.updateQueue,s!==null&&Gl(t,s.retryQueue),s=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),i=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(i=t.memoizedState.cachePool.pool),i!==s&&(t.flags|=2048),e!==null&&ke(hs),null;case 24:return s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),dn(Fe),Ue(t),null;case 25:return null;case 30:return null}throw Error(l(156,t.tag))}function Gy(e,t){switch(So(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return dn(Fe),As(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Pi(t),null;case 13:if(hn(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(l(340));$a()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ke(Ve),null;case 4:return As(),null;case 10:return dn(t.type),null;case 22:case 23:return hn(t),zo(),e!==null&&ke(hs),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return dn(Fe),null;case 25:return null;default:return null}}function kh(e,t){switch(So(t),t.tag){case 3:dn(Fe),As();break;case 26:case 27:case 5:Pi(t);break;case 4:As();break;case 13:hn(t);break;case 19:ke(Ve);break;case 10:dn(t.type);break;case 22:case 23:hn(t),zo(),e!==null&&ke(hs);break;case 24:dn(Fe)}}function di(e,t){try{var s=t.updateQueue,i=s!==null?s.lastEffect:null;if(i!==null){var o=i.next;s=o;do{if((s.tag&e)===e){i=void 0;var u=s.create,m=s.inst;i=u(),m.destroy=i}s=s.next}while(s!==o)}}catch(v){Ne(t,t.return,v)}}function zn(e,t,s){try{var i=t.updateQueue,o=i!==null?i.lastEffect:null;if(o!==null){var u=o.next;i=u;do{if((i.tag&e)===e){var m=i.inst,v=m.destroy;if(v!==void 0){m.destroy=void 0,o=t;var S=s,A=v;try{A()}catch(k){Ne(o,S,k)}}}i=i.next}while(i!==u)}}catch(k){Ne(t,t.return,k)}}function Uh(e){var t=e.updateQueue;if(t!==null){var s=e.stateNode;try{wf(t,s)}catch(i){Ne(e,e.return,i)}}}function Lh(e,t,s){s.props=gs(e.type,e.memoizedProps),s.state=e.memoizedState;try{s.componentWillUnmount()}catch(i){Ne(e,t,i)}}function fi(e,t){try{var s=e.ref;if(s!==null){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;case 30:i=e.stateNode;break;default:i=e.stateNode}typeof s=="function"?e.refCleanup=s(i):s.current=i}}catch(o){Ne(e,t,o)}}function en(e,t){var s=e.ref,i=e.refCleanup;if(s!==null)if(typeof i=="function")try{i()}catch(o){Ne(e,t,o)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(o){Ne(e,t,o)}else s.current=null}function zh(e){var t=e.type,s=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":s.autoFocus&&i.focus();break e;case"img":s.src?i.src=s.src:s.srcSet&&(i.srcset=s.srcSet)}}catch(o){Ne(e,e.return,o)}}function dc(e,t,s){try{var i=e.stateNode;cv(i,e.type,s,t),i[ht]=t}catch(o){Ne(e,e.return,o)}}function Bh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Vn(e.type)||e.tag===4}function fc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Bh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Vn(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hc(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(e,t):(t=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,t.appendChild(e),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=er));else if(i!==4&&(i===27&&Vn(e.type)&&(s=e.stateNode,t=null),e=e.child,e!==null))for(hc(e,t,s),e=e.sibling;e!==null;)hc(e,t,s),e=e.sibling}function Yl(e,t,s){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(i!==4&&(i===27&&Vn(e.type)&&(s=e.stateNode),e=e.child,e!==null))for(Yl(e,t,s),e=e.sibling;e!==null;)Yl(e,t,s),e=e.sibling}function qh(e){var t=e.stateNode,s=e.memoizedProps;try{for(var i=e.type,o=t.attributes;o.length;)t.removeAttributeNode(o[0]);at(t,i,s),t[lt]=e,t[ht]=s}catch(u){Ne(e,e.return,u)}}var pn=!1,He=!1,mc=!1,Hh=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Yy(e,t){if(e=e.containerInfo,Bc=rr,e=Zd(e),fo(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var i=s.getSelection&&s.getSelection();if(i&&i.rangeCount!==0){s=i.anchorNode;var o=i.anchorOffset,u=i.focusNode;i=i.focusOffset;try{s.nodeType,u.nodeType}catch{s=null;break e}var m=0,v=-1,S=-1,A=0,k=0,B=e,D=null;t:for(;;){for(var j;B!==s||o!==0&&B.nodeType!==3||(v=m+o),B!==u||i!==0&&B.nodeType!==3||(S=m+i),B.nodeType===3&&(m+=B.nodeValue.length),(j=B.firstChild)!==null;)D=B,B=j;for(;;){if(B===e)break t;if(D===s&&++A===o&&(v=m),D===u&&++k===i&&(S=m),(j=B.nextSibling)!==null)break;B=D,D=B.parentNode}B=j}s=v===-1||S===-1?null:{start:v,end:S}}else s=null}s=s||{start:0,end:0}}else s=null;for(qc={focusedElem:e,selectionRange:s},rr=!1,Ze=t;Ze!==null;)if(t=Ze,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Ze=e;else for(;Ze!==null;){switch(t=Ze,u=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&u!==null){e=void 0,s=t,o=u.memoizedProps,u=u.memoizedState,i=s.stateNode;try{var le=gs(s.type,o,s.elementType===s.type);e=i.getSnapshotBeforeUpdate(le,u),i.__reactInternalSnapshotBeforeUpdate=e}catch(ae){Ne(s,s.return,ae)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,s=e.nodeType,s===9)Gc(e);else if(s===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Gc(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(l(163))}if(e=t.sibling,e!==null){e.return=t.return,Ze=e;break}Ze=t.return}}function Ih(e,t,s){var i=s.flags;switch(s.tag){case 0:case 11:case 15:Bn(e,s),i&4&&di(5,s);break;case 1:if(Bn(e,s),i&4)if(e=s.stateNode,t===null)try{e.componentDidMount()}catch(m){Ne(s,s.return,m)}else{var o=gs(s.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(o,t,e.__reactInternalSnapshotBeforeUpdate)}catch(m){Ne(s,s.return,m)}}i&64&&Uh(s),i&512&&fi(s,s.return);break;case 3:if(Bn(e,s),i&64&&(e=s.updateQueue,e!==null)){if(t=null,s.child!==null)switch(s.child.tag){case 27:case 5:t=s.child.stateNode;break;case 1:t=s.child.stateNode}try{wf(e,t)}catch(m){Ne(s,s.return,m)}}break;case 27:t===null&&i&4&&qh(s);case 26:case 5:Bn(e,s),t===null&&i&4&&zh(s),i&512&&fi(s,s.return);break;case 12:Bn(e,s);break;case 13:Bn(e,s),i&4&&Fh(e,s),i&64&&(e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(s=Jy.bind(null,s),pv(e,s))));break;case 22:if(i=s.memoizedState!==null||pn,!i){t=t!==null&&t.memoizedState!==null||He,o=pn;var u=He;pn=i,(He=t)&&!u?qn(e,s,(s.subtreeFlags&8772)!==0):Bn(e,s),pn=o,He=u}break;case 30:break;default:Bn(e,s)}}function Gh(e){var t=e.alternate;t!==null&&(e.alternate=null,Gh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&Qr(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Me=null,pt=!1;function yn(e,t,s){for(s=s.child;s!==null;)Yh(e,t,s),s=s.sibling}function Yh(e,t,s){if(bt&&typeof bt.onCommitFiberUnmount=="function")try{bt.onCommitFiberUnmount(Oa,s)}catch{}switch(s.tag){case 26:He||en(s,t),yn(e,t,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:He||en(s,t);var i=Me,o=pt;Vn(s.type)&&(Me=s.stateNode,pt=!1),yn(e,t,s),_i(s.stateNode),Me=i,pt=o;break;case 5:He||en(s,t);case 6:if(i=Me,o=pt,Me=null,yn(e,t,s),Me=i,pt=o,Me!==null)if(pt)try{(Me.nodeType===9?Me.body:Me.nodeName==="HTML"?Me.ownerDocument.body:Me).removeChild(s.stateNode)}catch(u){Ne(s,t,u)}else try{Me.removeChild(s.stateNode)}catch(u){Ne(s,t,u)}break;case 18:Me!==null&&(pt?(e=Me,jm(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,s.stateNode),Ai(e)):jm(Me,s.stateNode));break;case 4:i=Me,o=pt,Me=s.stateNode.containerInfo,pt=!0,yn(e,t,s),Me=i,pt=o;break;case 0:case 11:case 14:case 15:He||zn(2,s,t),He||zn(4,s,t),yn(e,t,s);break;case 1:He||(en(s,t),i=s.stateNode,typeof i.componentWillUnmount=="function"&&Lh(s,t,i)),yn(e,t,s);break;case 21:yn(e,t,s);break;case 22:He=(i=He)||s.memoizedState!==null,yn(e,t,s),He=i;break;default:yn(e,t,s)}}function Fh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Ai(e)}catch(s){Ne(t,t.return,s)}}function Fy(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Hh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Hh),t;default:throw Error(l(435,e.tag))}}function gc(e,t){var s=Fy(e);t.forEach(function(i){var o=Py.bind(null,e,i);s.has(i)||(s.add(i),i.then(o,o))})}function St(e,t){var s=t.deletions;if(s!==null)for(var i=0;i<s.length;i++){var o=s[i],u=e,m=t,v=m;e:for(;v!==null;){switch(v.tag){case 27:if(Vn(v.type)){Me=v.stateNode,pt=!1;break e}break;case 5:Me=v.stateNode,pt=!1;break e;case 3:case 4:Me=v.stateNode.containerInfo,pt=!0;break e}v=v.return}if(Me===null)throw Error(l(160));Yh(u,m,o),Me=null,pt=!1,u=o.alternate,u!==null&&(u.return=null),o.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Vh(t,e),t=t.sibling}var Gt=null;function Vh(e,t){var s=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:St(t,e),Et(e),i&4&&(zn(3,e,e.return),di(3,e),zn(5,e,e.return));break;case 1:St(t,e),Et(e),i&512&&(He||s===null||en(s,s.return)),i&64&&pn&&(e=e.updateQueue,e!==null&&(i=e.callbacks,i!==null&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=s===null?i:s.concat(i))));break;case 26:var o=Gt;if(St(t,e),Et(e),i&512&&(He||s===null||en(s,s.return)),i&4){var u=s!==null?s.memoizedState:null;if(i=e.memoizedState,s===null)if(i===null)if(e.stateNode===null){e:{i=e.type,s=e.memoizedProps,o=o.ownerDocument||o;t:switch(i){case"title":u=o.getElementsByTagName("title")[0],(!u||u[La]||u[lt]||u.namespaceURI==="http://www.w3.org/2000/svg"||u.hasAttribute("itemprop"))&&(u=o.createElement(i),o.head.insertBefore(u,o.querySelector("head > title"))),at(u,i,s),u[lt]=e,$e(u),i=u;break e;case"link":var m=qm("link","href",o).get(i+(s.href||""));if(m){for(var v=0;v<m.length;v++)if(u=m[v],u.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&u.getAttribute("rel")===(s.rel==null?null:s.rel)&&u.getAttribute("title")===(s.title==null?null:s.title)&&u.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){m.splice(v,1);break t}}u=o.createElement(i),at(u,i,s),o.head.appendChild(u);break;case"meta":if(m=qm("meta","content",o).get(i+(s.content||""))){for(v=0;v<m.length;v++)if(u=m[v],u.getAttribute("content")===(s.content==null?null:""+s.content)&&u.getAttribute("name")===(s.name==null?null:s.name)&&u.getAttribute("property")===(s.property==null?null:s.property)&&u.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&u.getAttribute("charset")===(s.charSet==null?null:s.charSet)){m.splice(v,1);break t}}u=o.createElement(i),at(u,i,s),o.head.appendChild(u);break;default:throw Error(l(468,i))}u[lt]=e,$e(u),i=u}e.stateNode=i}else Hm(o,e.type,e.stateNode);else e.stateNode=Bm(o,i,e.memoizedProps);else u!==i?(u===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):u.count--,i===null?Hm(o,e.type,e.stateNode):Bm(o,i,e.memoizedProps)):i===null&&e.stateNode!==null&&dc(e,e.memoizedProps,s.memoizedProps)}break;case 27:St(t,e),Et(e),i&512&&(He||s===null||en(s,s.return)),s!==null&&i&4&&dc(e,e.memoizedProps,s.memoizedProps);break;case 5:if(St(t,e),Et(e),i&512&&(He||s===null||en(s,s.return)),e.flags&32){o=e.stateNode;try{zs(o,"")}catch(j){Ne(e,e.return,j)}}i&4&&e.stateNode!=null&&(o=e.memoizedProps,dc(e,o,s!==null?s.memoizedProps:o)),i&1024&&(mc=!0);break;case 6:if(St(t,e),Et(e),i&4){if(e.stateNode===null)throw Error(l(162));i=e.memoizedProps,s=e.stateNode;try{s.nodeValue=i}catch(j){Ne(e,e.return,j)}}break;case 3:if(ar=null,o=Gt,Gt=nr(t.containerInfo),St(t,e),Gt=o,Et(e),i&4&&s!==null&&s.memoizedState.isDehydrated)try{Ai(t.containerInfo)}catch(j){Ne(e,e.return,j)}mc&&(mc=!1,Qh(e));break;case 4:i=Gt,Gt=nr(e.stateNode.containerInfo),St(t,e),Et(e),Gt=i;break;case 12:St(t,e),Et(e);break;case 13:St(t,e),Et(e),e.child.flags&8192&&e.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(_c=Wt()),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,gc(e,i)));break;case 22:o=e.memoizedState!==null;var S=s!==null&&s.memoizedState!==null,A=pn,k=He;if(pn=A||o,He=k||S,St(t,e),He=k,pn=A,Et(e),i&8192)e:for(t=e.stateNode,t._visibility=o?t._visibility&-2:t._visibility|1,o&&(s===null||S||pn||He||ps(e)),s=null,t=e;;){if(t.tag===5||t.tag===26){if(s===null){S=s=t;try{if(u=S.stateNode,o)m=u.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{v=S.stateNode;var B=S.memoizedProps.style,D=B!=null&&B.hasOwnProperty("display")?B.display:null;v.style.display=D==null||typeof D=="boolean"?"":(""+D).trim()}}catch(j){Ne(S,S.return,j)}}}else if(t.tag===6){if(s===null){S=t;try{S.stateNode.nodeValue=o?"":S.memoizedProps}catch(j){Ne(S,S.return,j)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;s===t&&(s=null),t=t.return}s===t&&(s=null),t.sibling.return=t.return,t=t.sibling}i&4&&(i=e.updateQueue,i!==null&&(s=i.retryQueue,s!==null&&(i.retryQueue=null,gc(e,s))));break;case 19:St(t,e),Et(e),i&4&&(i=e.updateQueue,i!==null&&(e.updateQueue=null,gc(e,i)));break;case 30:break;case 21:break;default:St(t,e),Et(e)}}function Et(e){var t=e.flags;if(t&2){try{for(var s,i=e.return;i!==null;){if(Bh(i)){s=i;break}i=i.return}if(s==null)throw Error(l(160));switch(s.tag){case 27:var o=s.stateNode,u=fc(e);Yl(e,u,o);break;case 5:var m=s.stateNode;s.flags&32&&(zs(m,""),s.flags&=-33);var v=fc(e);Yl(e,v,m);break;case 3:case 4:var S=s.stateNode.containerInfo,A=fc(e);hc(e,A,S);break;default:throw Error(l(161))}}catch(k){Ne(e,e.return,k)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Qh(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Qh(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Bn(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Ih(e,t.alternate,t),t=t.sibling}function ps(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:zn(4,t,t.return),ps(t);break;case 1:en(t,t.return);var s=t.stateNode;typeof s.componentWillUnmount=="function"&&Lh(t,t.return,s),ps(t);break;case 27:_i(t.stateNode);case 26:case 5:en(t,t.return),ps(t);break;case 22:t.memoizedState===null&&ps(t);break;case 30:ps(t);break;default:ps(t)}e=e.sibling}}function qn(e,t,s){for(s=s&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var i=t.alternate,o=e,u=t,m=u.flags;switch(u.tag){case 0:case 11:case 15:qn(o,u,s),di(4,u);break;case 1:if(qn(o,u,s),i=u,o=i.stateNode,typeof o.componentDidMount=="function")try{o.componentDidMount()}catch(A){Ne(i,i.return,A)}if(i=u,o=i.updateQueue,o!==null){var v=i.stateNode;try{var S=o.shared.hiddenCallbacks;if(S!==null)for(o.shared.hiddenCallbacks=null,o=0;o<S.length;o++)_f(S[o],v)}catch(A){Ne(i,i.return,A)}}s&&m&64&&Uh(u),fi(u,u.return);break;case 27:qh(u);case 26:case 5:qn(o,u,s),s&&i===null&&m&4&&zh(u),fi(u,u.return);break;case 12:qn(o,u,s);break;case 13:qn(o,u,s),s&&m&4&&Fh(o,u);break;case 22:u.memoizedState===null&&qn(o,u,s),fi(u,u.return);break;case 30:break;default:qn(o,u,s)}t=t.sibling}}function pc(e,t){var s=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(s=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==s&&(e!=null&&e.refCount++,s!=null&&Wa(s))}function yc(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Wa(e))}function tn(e,t,s,i){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Xh(e,t,s,i),t=t.sibling}function Xh(e,t,s,i){var o=t.flags;switch(t.tag){case 0:case 11:case 15:tn(e,t,s,i),o&2048&&di(9,t);break;case 1:tn(e,t,s,i);break;case 3:tn(e,t,s,i),o&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Wa(e)));break;case 12:if(o&2048){tn(e,t,s,i),e=t.stateNode;try{var u=t.memoizedProps,m=u.id,v=u.onPostCommit;typeof v=="function"&&v(m,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(S){Ne(t,t.return,S)}}else tn(e,t,s,i);break;case 13:tn(e,t,s,i);break;case 23:break;case 22:u=t.stateNode,m=t.alternate,t.memoizedState!==null?u._visibility&2?tn(e,t,s,i):hi(e,t):u._visibility&2?tn(e,t,s,i):(u._visibility|=2,na(e,t,s,i,(t.subtreeFlags&10256)!==0)),o&2048&&pc(m,t);break;case 24:tn(e,t,s,i),o&2048&&yc(t.alternate,t);break;default:tn(e,t,s,i)}}function na(e,t,s,i,o){for(o=o&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var u=e,m=t,v=s,S=i,A=m.flags;switch(m.tag){case 0:case 11:case 15:na(u,m,v,S,o),di(8,m);break;case 23:break;case 22:var k=m.stateNode;m.memoizedState!==null?k._visibility&2?na(u,m,v,S,o):hi(u,m):(k._visibility|=2,na(u,m,v,S,o)),o&&A&2048&&pc(m.alternate,m);break;case 24:na(u,m,v,S,o),o&&A&2048&&yc(m.alternate,m);break;default:na(u,m,v,S,o)}t=t.sibling}}function hi(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var s=e,i=t,o=i.flags;switch(i.tag){case 22:hi(s,i),o&2048&&pc(i.alternate,i);break;case 24:hi(s,i),o&2048&&yc(i.alternate,i);break;default:hi(s,i)}t=t.sibling}}var mi=8192;function sa(e){if(e.subtreeFlags&mi)for(e=e.child;e!==null;)$h(e),e=e.sibling}function $h(e){switch(e.tag){case 26:sa(e),e.flags&mi&&e.memoizedState!==null&&Av(Gt,e.memoizedState,e.memoizedProps);break;case 5:sa(e);break;case 3:case 4:var t=Gt;Gt=nr(e.stateNode.containerInfo),sa(e),Gt=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=mi,mi=16777216,sa(e),mi=t):sa(e));break;default:sa(e)}}function Kh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function gi(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];Ze=i,Wh(i,e)}Kh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Zh(e),e=e.sibling}function Zh(e){switch(e.tag){case 0:case 11:case 15:gi(e),e.flags&2048&&zn(9,e,e.return);break;case 3:gi(e);break;case 12:gi(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Fl(e)):gi(e);break;default:gi(e)}}function Fl(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var s=0;s<t.length;s++){var i=t[s];Ze=i,Wh(i,e)}Kh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:zn(8,t,t.return),Fl(t);break;case 22:s=t.stateNode,s._visibility&2&&(s._visibility&=-3,Fl(t));break;default:Fl(t)}e=e.sibling}}function Wh(e,t){for(;Ze!==null;){var s=Ze;switch(s.tag){case 0:case 11:case 15:zn(8,s,t);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var i=s.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:Wa(s.memoizedState.cache)}if(i=s.child,i!==null)i.return=s,Ze=i;else e:for(s=e;Ze!==null;){i=Ze;var o=i.sibling,u=i.return;if(Gh(i),i===s){Ze=null;break e}if(o!==null){o.return=u,Ze=o;break e}Ze=u}}}var Vy={getCacheForType:function(e){var t=rt(Fe),s=t.data.get(e);return s===void 0&&(s=e(),t.data.set(e,s)),s}},Qy=typeof WeakMap=="function"?WeakMap:Map,be=0,Te=null,ce=null,he=0,xe=0,Ct=null,Hn=!1,aa=!1,vc=!1,vn=0,ze=0,In=0,ys=0,bc=0,qt=0,ia=0,pi=null,yt=null,xc=!1,_c=0,Vl=1/0,Ql=null,Gn=null,st=0,Yn=null,la=null,ra=0,wc=0,Sc=null,Jh=null,yi=0,Ec=null;function Nt(){if((be&2)!==0&&he!==0)return he&-he;if(T.T!==null){var e=$s;return e!==0?e:jc()}return hd()}function Ph(){qt===0&&(qt=(he&536870912)===0||pe?cd():536870912);var e=Bt.current;return e!==null&&(e.flags|=32),qt}function Tt(e,t,s){(e===Te&&(xe===2||xe===9)||e.cancelPendingCommit!==null)&&(oa(e,0),Fn(e,he,qt,!1)),Ua(e,s),((be&2)===0||e!==Te)&&(e===Te&&((be&2)===0&&(ys|=s),ze===4&&Fn(e,he,qt,!1)),nn(e))}function em(e,t,s){if((be&6)!==0)throw Error(l(327));var i=!s&&(t&124)===0&&(t&e.expiredLanes)===0||ka(e,t),o=i?Ky(e,t):Tc(e,t,!0),u=i;do{if(o===0){aa&&!i&&Fn(e,t,0,!1);break}else{if(s=e.current.alternate,u&&!Xy(s)){o=Tc(e,t,!1),u=!1;continue}if(o===2){if(u=t,e.errorRecoveryDisabledLanes&u)var m=0;else m=e.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){t=m;e:{var v=e;o=pi;var S=v.current.memoizedState.isDehydrated;if(S&&(oa(v,m).flags|=256),m=Tc(v,m,!1),m!==2){if(vc&&!S){v.errorRecoveryDisabledLanes|=u,ys|=u,o=4;break e}u=yt,yt=o,u!==null&&(yt===null?yt=u:yt.push.apply(yt,u))}o=m}if(u=!1,o!==2)continue}}if(o===1){oa(e,0),Fn(e,t,0,!0);break}e:{switch(i=e,u=o,u){case 0:case 1:throw Error(l(345));case 4:if((t&4194048)!==t)break;case 6:Fn(i,t,qt,!Hn);break e;case 2:yt=null;break;case 3:case 5:break;default:throw Error(l(329))}if((t&62914560)===t&&(o=_c+300-Wt(),10<o)){if(Fn(i,t,qt,!Hn),sl(i,0,!0)!==0)break e;i.timeoutHandle=Am(tm.bind(null,i,s,yt,Ql,xc,t,qt,ys,ia,Hn,u,2,-0,0),o);break e}tm(i,s,yt,Ql,xc,t,qt,ys,ia,Hn,u,0,-0,0)}}break}while(!0);nn(e)}function tm(e,t,s,i,o,u,m,v,S,A,k,B,D,j){if(e.timeoutHandle=-1,B=t.subtreeFlags,(B&8192||(B&16785408)===16785408)&&(Ei={stylesheets:null,count:0,unsuspend:Rv},$h(t),B=Dv(),B!==null)){e.cancelPendingCommit=B(om.bind(null,e,t,u,s,i,o,m,v,S,k,1,D,j)),Fn(e,u,m,!A);return}om(e,t,u,s,i,o,m,v,S)}function Xy(e){for(var t=e;;){var s=t.tag;if((s===0||s===11||s===15)&&t.flags&16384&&(s=t.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var i=0;i<s.length;i++){var o=s[i],u=o.getSnapshot;o=o.value;try{if(!_t(u(),o))return!1}catch{return!1}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fn(e,t,s,i){t&=~bc,t&=~ys,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var o=t;0<o;){var u=31-xt(o),m=1<<u;i[u]=-1,o&=~m}s!==0&&dd(e,s,t)}function Xl(){return(be&6)===0?(vi(0),!1):!0}function Cc(){if(ce!==null){if(xe===0)var e=ce.return;else e=ce,un=ds=null,Go(e),ea=null,oi=0,e=ce;for(;e!==null;)kh(e.alternate,e),e=e.return;ce=null}}function oa(e,t){var s=e.timeoutHandle;s!==-1&&(e.timeoutHandle=-1,dv(s)),s=e.cancelPendingCommit,s!==null&&(e.cancelPendingCommit=null,s()),Cc(),Te=e,ce=s=rn(e.current,null),he=t,xe=0,Ct=null,Hn=!1,aa=ka(e,t),vc=!1,ia=qt=bc=ys=In=ze=0,yt=pi=null,xc=!1,(t&8)!==0&&(t|=t&32);var i=e.entangledLanes;if(i!==0)for(e=e.entanglements,i&=t;0<i;){var o=31-xt(i),u=1<<o;t|=e[o],i&=~u}return vn=t,gl(),s}function nm(e,t){re=null,T.H=kl,t===Pa||t===El?(t=bf(),xe=3):t===pf?(t=bf(),xe=4):xe=t===xh?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,Ct=t,ce===null&&(ze=1,ql(e,kt(t,e.current)))}function sm(){var e=T.H;return T.H=kl,e===null?kl:e}function am(){var e=T.A;return T.A=Vy,e}function Nc(){ze=4,Hn||(he&4194048)!==he&&Bt.current!==null||(aa=!0),(In&134217727)===0&&(ys&134217727)===0||Te===null||Fn(Te,he,qt,!1)}function Tc(e,t,s){var i=be;be|=2;var o=sm(),u=am();(Te!==e||he!==t)&&(Ql=null,oa(e,t)),t=!1;var m=ze;e:do try{if(xe!==0&&ce!==null){var v=ce,S=Ct;switch(xe){case 8:Cc(),m=6;break e;case 3:case 2:case 9:case 6:Bt.current===null&&(t=!0);var A=xe;if(xe=0,Ct=null,ca(e,v,S,A),s&&aa){m=0;break e}break;default:A=xe,xe=0,Ct=null,ca(e,v,S,A)}}$y(),m=ze;break}catch(k){nm(e,k)}while(!0);return t&&e.shellSuspendCounter++,un=ds=null,be=i,T.H=o,T.A=u,ce===null&&(Te=null,he=0,gl()),m}function $y(){for(;ce!==null;)im(ce)}function Ky(e,t){var s=be;be|=2;var i=sm(),o=am();Te!==e||he!==t?(Ql=null,Vl=Wt()+500,oa(e,t)):aa=ka(e,t);e:do try{if(xe!==0&&ce!==null){t=ce;var u=Ct;t:switch(xe){case 1:xe=0,Ct=null,ca(e,t,u,1);break;case 2:case 9:if(yf(u)){xe=0,Ct=null,lm(t);break}t=function(){xe!==2&&xe!==9||Te!==e||(xe=7),nn(e)},u.then(t,t);break e;case 3:xe=7;break e;case 4:xe=5;break e;case 7:yf(u)?(xe=0,Ct=null,lm(t)):(xe=0,Ct=null,ca(e,t,u,7));break;case 5:var m=null;switch(ce.tag){case 26:m=ce.memoizedState;case 5:case 27:var v=ce;if(!m||Im(m)){xe=0,Ct=null;var S=v.sibling;if(S!==null)ce=S;else{var A=v.return;A!==null?(ce=A,$l(A)):ce=null}break t}}xe=0,Ct=null,ca(e,t,u,5);break;case 6:xe=0,Ct=null,ca(e,t,u,6);break;case 8:Cc(),ze=6;break e;default:throw Error(l(462))}}Zy();break}catch(k){nm(e,k)}while(!0);return un=ds=null,T.H=i,T.A=o,be=s,ce!==null?0:(Te=null,he=0,gl(),ze)}function Zy(){for(;ce!==null&&!vp();)im(ce)}function im(e){var t=Mh(e.alternate,e,vn);e.memoizedProps=e.pendingProps,t===null?$l(e):ce=t}function lm(e){var t=e,s=t.alternate;switch(t.tag){case 15:case 0:t=Nh(s,t,t.pendingProps,t.type,void 0,he);break;case 11:t=Nh(s,t,t.pendingProps,t.type.render,t.ref,he);break;case 5:Go(t);default:kh(s,t),t=ce=rf(t,vn),t=Mh(s,t,vn)}e.memoizedProps=e.pendingProps,t===null?$l(e):ce=t}function ca(e,t,s,i){un=ds=null,Go(t),ea=null,oi=0;var o=t.return;try{if(qy(e,o,t,s,he)){ze=1,ql(e,kt(s,e.current)),ce=null;return}}catch(u){if(o!==null)throw ce=o,u;ze=1,ql(e,kt(s,e.current)),ce=null;return}t.flags&32768?(pe||i===1?e=!0:aa||(he&536870912)!==0?e=!1:(Hn=e=!0,(i===2||i===9||i===3||i===6)&&(i=Bt.current,i!==null&&i.tag===13&&(i.flags|=16384))),rm(t,e)):$l(t)}function $l(e){var t=e;do{if((t.flags&32768)!==0){rm(t,Hn);return}e=t.return;var s=Iy(t.alternate,t,vn);if(s!==null){ce=s;return}if(t=t.sibling,t!==null){ce=t;return}ce=t=e}while(t!==null);ze===0&&(ze=5)}function rm(e,t){do{var s=Gy(e.alternate,e);if(s!==null){s.flags&=32767,ce=s;return}if(s=e.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!t&&(e=e.sibling,e!==null)){ce=e;return}ce=e=s}while(e!==null);ze=6,ce=null}function om(e,t,s,i,o,u,m,v,S){e.cancelPendingCommit=null;do Kl();while(st!==0);if((be&6)!==0)throw Error(l(327));if(t!==null){if(t===e.current)throw Error(l(177));if(u=t.lanes|t.childLanes,u|=yo,Rp(e,s,u,m,v,S),e===Te&&(ce=Te=null,he=0),la=t,Yn=e,ra=s,wc=u,Sc=o,Jh=i,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,ev(el,function(){return hm(),null})):(e.callbackNode=null,e.callbackPriority=0),i=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||i){i=T.T,T.T=null,o=Y.p,Y.p=2,m=be,be|=4;try{Yy(e,t,s)}finally{be=m,Y.p=o,T.T=i}}st=1,cm(),um(),dm()}}function cm(){if(st===1){st=0;var e=Yn,t=la,s=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||s){s=T.T,T.T=null;var i=Y.p;Y.p=2;var o=be;be|=4;try{Vh(t,e);var u=qc,m=Zd(e.containerInfo),v=u.focusedElem,S=u.selectionRange;if(m!==v&&v&&v.ownerDocument&&Kd(v.ownerDocument.documentElement,v)){if(S!==null&&fo(v)){var A=S.start,k=S.end;if(k===void 0&&(k=A),"selectionStart"in v)v.selectionStart=A,v.selectionEnd=Math.min(k,v.value.length);else{var B=v.ownerDocument||document,D=B&&B.defaultView||window;if(D.getSelection){var j=D.getSelection(),le=v.textContent.length,ae=Math.min(S.start,le),Ce=S.end===void 0?ae:Math.min(S.end,le);!j.extend&&ae>Ce&&(m=Ce,Ce=ae,ae=m);var N=$d(v,ae),E=$d(v,Ce);if(N&&E&&(j.rangeCount!==1||j.anchorNode!==N.node||j.anchorOffset!==N.offset||j.focusNode!==E.node||j.focusOffset!==E.offset)){var R=B.createRange();R.setStart(N.node,N.offset),j.removeAllRanges(),ae>Ce?(j.addRange(R),j.extend(E.node,E.offset)):(R.setEnd(E.node,E.offset),j.addRange(R))}}}}for(B=[],j=v;j=j.parentNode;)j.nodeType===1&&B.push({element:j,left:j.scrollLeft,top:j.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<B.length;v++){var z=B[v];z.element.scrollLeft=z.left,z.element.scrollTop=z.top}}rr=!!Bc,qc=Bc=null}finally{be=o,Y.p=i,T.T=s}}e.current=t,st=2}}function um(){if(st===2){st=0;var e=Yn,t=la,s=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||s){s=T.T,T.T=null;var i=Y.p;Y.p=2;var o=be;be|=4;try{Ih(e,t.alternate,t)}finally{be=o,Y.p=i,T.T=s}}st=3}}function dm(){if(st===4||st===3){st=0,bp();var e=Yn,t=la,s=ra,i=Jh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?st=5:(st=0,la=Yn=null,fm(e,e.pendingLanes));var o=e.pendingLanes;if(o===0&&(Gn=null),Fr(s),t=t.stateNode,bt&&typeof bt.onCommitFiberRoot=="function")try{bt.onCommitFiberRoot(Oa,t,void 0,(t.current.flags&128)===128)}catch{}if(i!==null){t=T.T,o=Y.p,Y.p=2,T.T=null;try{for(var u=e.onRecoverableError,m=0;m<i.length;m++){var v=i[m];u(v.value,{componentStack:v.stack})}}finally{T.T=t,Y.p=o}}(ra&3)!==0&&Kl(),nn(e),o=e.pendingLanes,(s&4194090)!==0&&(o&42)!==0?e===Ec?yi++:(yi=0,Ec=e):yi=0,vi(0)}}function fm(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Wa(t)))}function Kl(e){return cm(),um(),dm(),hm()}function hm(){if(st!==5)return!1;var e=Yn,t=wc;wc=0;var s=Fr(ra),i=T.T,o=Y.p;try{Y.p=32>s?32:s,T.T=null,s=Sc,Sc=null;var u=Yn,m=ra;if(st=0,la=Yn=null,ra=0,(be&6)!==0)throw Error(l(331));var v=be;if(be|=4,Zh(u.current),Xh(u,u.current,m,s),be=v,vi(0,!1),bt&&typeof bt.onPostCommitFiberRoot=="function")try{bt.onPostCommitFiberRoot(Oa,u)}catch{}return!0}finally{Y.p=o,T.T=i,fm(e,t)}}function mm(e,t,s){t=kt(s,t),t=nc(e.stateNode,t,2),e=On(e,t,2),e!==null&&(Ua(e,2),nn(e))}function Ne(e,t,s){if(e.tag===3)mm(e,e,s);else for(;t!==null;){if(t.tag===3){mm(t,e,s);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Gn===null||!Gn.has(i))){e=kt(s,e),s=vh(2),i=On(t,s,2),i!==null&&(bh(s,i,t,e),Ua(i,2),nn(i));break}}t=t.return}}function Rc(e,t,s){var i=e.pingCache;if(i===null){i=e.pingCache=new Qy;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(s)||(vc=!0,o.add(s),e=Wy.bind(null,e,t,s),t.then(e,e))}function Wy(e,t,s){var i=e.pingCache;i!==null&&i.delete(t),e.pingedLanes|=e.suspendedLanes&s,e.warmLanes&=~s,Te===e&&(he&s)===s&&(ze===4||ze===3&&(he&62914560)===he&&300>Wt()-_c?(be&2)===0&&oa(e,0):bc|=s,ia===he&&(ia=0)),nn(e)}function gm(e,t){t===0&&(t=ud()),e=Fs(e,t),e!==null&&(Ua(e,t),nn(e))}function Jy(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),gm(e,s)}function Py(e,t){var s=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(s=o.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(l(314))}i!==null&&i.delete(t),gm(e,s)}function ev(e,t){return Hr(e,t)}var Zl=null,ua=null,Ac=!1,Wl=!1,Dc=!1,vs=0;function nn(e){e!==ua&&e.next===null&&(ua===null?Zl=ua=e:ua=ua.next=e),Wl=!0,Ac||(Ac=!0,nv())}function vi(e,t){if(!Dc&&Wl){Dc=!0;do for(var s=!1,i=Zl;i!==null;){if(e!==0){var o=i.pendingLanes;if(o===0)var u=0;else{var m=i.suspendedLanes,v=i.pingedLanes;u=(1<<31-xt(42|e)+1)-1,u&=o&~(m&~v),u=u&201326741?u&201326741|1:u?u|2:0}u!==0&&(s=!0,bm(i,u))}else u=he,u=sl(i,i===Te?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),(u&3)===0||ka(i,u)||(s=!0,bm(i,u));i=i.next}while(s);Dc=!1}}function tv(){pm()}function pm(){Wl=Ac=!1;var e=0;vs!==0&&(uv()&&(e=vs),vs=0);for(var t=Wt(),s=null,i=Zl;i!==null;){var o=i.next,u=ym(i,t);u===0?(i.next=null,s===null?Zl=o:s.next=o,o===null&&(ua=s)):(s=i,(e!==0||(u&3)!==0)&&(Wl=!0)),i=o}vi(e)}function ym(e,t){for(var s=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes&-62914561;0<u;){var m=31-xt(u),v=1<<m,S=o[m];S===-1?((v&s)===0||(v&i)!==0)&&(o[m]=Tp(v,t)):S<=t&&(e.expiredLanes|=v),u&=~v}if(t=Te,s=he,s=sl(e,e===t?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i=e.callbackNode,s===0||e===t&&(xe===2||xe===9)||e.cancelPendingCommit!==null)return i!==null&&i!==null&&Ir(i),e.callbackNode=null,e.callbackPriority=0;if((s&3)===0||ka(e,s)){if(t=s&-s,t===e.callbackPriority)return t;switch(i!==null&&Ir(i),Fr(s)){case 2:case 8:s=rd;break;case 32:s=el;break;case 268435456:s=od;break;default:s=el}return i=vm.bind(null,e),s=Hr(s,i),e.callbackPriority=t,e.callbackNode=s,t}return i!==null&&i!==null&&Ir(i),e.callbackPriority=2,e.callbackNode=null,2}function vm(e,t){if(st!==0&&st!==5)return e.callbackNode=null,e.callbackPriority=0,null;var s=e.callbackNode;if(Kl()&&e.callbackNode!==s)return null;var i=he;return i=sl(e,e===Te?i:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),i===0?null:(em(e,i,t),ym(e,Wt()),e.callbackNode!=null&&e.callbackNode===s?vm.bind(null,e):null)}function bm(e,t){if(Kl())return null;em(e,t,!0)}function nv(){fv(function(){(be&6)!==0?Hr(ld,tv):pm()})}function jc(){return vs===0&&(vs=cd()),vs}function xm(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ol(""+e)}function _m(e,t){var s=t.ownerDocument.createElement("input");return s.name=t.name,s.value=t.value,e.id&&s.setAttribute("form",e.id),t.parentNode.insertBefore(s,t),e=new FormData(e),s.parentNode.removeChild(s),e}function sv(e,t,s,i,o){if(t==="submit"&&s&&s.stateNode===o){var u=xm((o[ht]||null).action),m=i.submitter;m&&(t=(t=m[ht]||null)?xm(t.formAction):m.getAttribute("formAction"),t!==null&&(u=t,m=null));var v=new fl("action","action",null,i,o);e.push({event:v,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(vs!==0){var S=m?_m(o,m):new FormData(o);Wo(s,{pending:!0,data:S,method:o.method,action:u},null,S)}}else typeof u=="function"&&(v.preventDefault(),S=m?_m(o,m):new FormData(o),Wo(s,{pending:!0,data:S,method:o.method,action:u},u,S))},currentTarget:o}]})}}for(var Mc=0;Mc<po.length;Mc++){var Oc=po[Mc],av=Oc.toLowerCase(),iv=Oc[0].toUpperCase()+Oc.slice(1);It(av,"on"+iv)}It(Pd,"onAnimationEnd"),It(ef,"onAnimationIteration"),It(tf,"onAnimationStart"),It("dblclick","onDoubleClick"),It("focusin","onFocus"),It("focusout","onBlur"),It(wy,"onTransitionRun"),It(Sy,"onTransitionStart"),It(Ey,"onTransitionCancel"),It(nf,"onTransitionEnd"),ks("onMouseEnter",["mouseout","mouseover"]),ks("onMouseLeave",["mouseout","mouseover"]),ks("onPointerEnter",["pointerout","pointerover"]),ks("onPointerLeave",["pointerout","pointerover"]),ns("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ns("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ns("onBeforeInput",["compositionend","keypress","textInput","paste"]),ns("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ns("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ns("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(bi));function wm(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var i=e[s],o=i.event;i=i.listeners;e:{var u=void 0;if(t)for(var m=i.length-1;0<=m;m--){var v=i[m],S=v.instance,A=v.currentTarget;if(v=v.listener,S!==u&&o.isPropagationStopped())break e;u=v,o.currentTarget=A;try{u(o)}catch(k){Bl(k)}o.currentTarget=null,u=S}else for(m=0;m<i.length;m++){if(v=i[m],S=v.instance,A=v.currentTarget,v=v.listener,S!==u&&o.isPropagationStopped())break e;u=v,o.currentTarget=A;try{u(o)}catch(k){Bl(k)}o.currentTarget=null,u=S}}}}function ue(e,t){var s=t[Vr];s===void 0&&(s=t[Vr]=new Set);var i=e+"__bubble";s.has(i)||(Sm(t,e,2,!1),s.add(i))}function kc(e,t,s){var i=0;t&&(i|=4),Sm(s,e,i,t)}var Jl="_reactListening"+Math.random().toString(36).slice(2);function Uc(e){if(!e[Jl]){e[Jl]=!0,gd.forEach(function(s){s!=="selectionchange"&&(lv.has(s)||kc(s,!1,e),kc(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Jl]||(t[Jl]=!0,kc("selectionchange",!1,t))}}function Sm(e,t,s,i){switch(Xm(t)){case 2:var o=Ov;break;case 8:o=kv;break;default:o=Kc}s=o.bind(null,t,s,e),o=void 0,!no||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,s,{capture:!0,passive:o}):e.addEventListener(t,s,!0):o!==void 0?e.addEventListener(t,s,{passive:o}):e.addEventListener(t,s,!1)}function Lc(e,t,s,i,o){var u=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var m=i.tag;if(m===3||m===4){var v=i.stateNode.containerInfo;if(v===o)break;if(m===4)for(m=i.return;m!==null;){var S=m.tag;if((S===3||S===4)&&m.stateNode.containerInfo===o)return;m=m.return}for(;v!==null;){if(m=js(v),m===null)return;if(S=m.tag,S===5||S===6||S===26||S===27){i=u=m;continue e}v=v.parentNode}}i=i.return}Ad(function(){var A=u,k=eo(s),B=[];e:{var D=sf.get(e);if(D!==void 0){var j=fl,le=e;switch(e){case"keypress":if(ul(s)===0)break e;case"keydown":case"keyup":j=ey;break;case"focusin":le="focus",j=lo;break;case"focusout":le="blur",j=lo;break;case"beforeblur":case"afterblur":j=lo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":j=Md;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":j=Gp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":j=sy;break;case Pd:case ef:case tf:j=Vp;break;case nf:j=iy;break;case"scroll":case"scrollend":j=Hp;break;case"wheel":j=ry;break;case"copy":case"cut":case"paste":j=Xp;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":j=kd;break;case"toggle":case"beforetoggle":j=cy}var ae=(t&4)!==0,Ce=!ae&&(e==="scroll"||e==="scrollend"),N=ae?D!==null?D+"Capture":null:D;ae=[];for(var E=A,R;E!==null;){var z=E;if(R=z.stateNode,z=z.tag,z!==5&&z!==26&&z!==27||R===null||N===null||(z=Ba(E,N),z!=null&&ae.push(xi(E,z,R))),Ce)break;E=E.return}0<ae.length&&(D=new j(D,le,null,s,k),B.push({event:D,listeners:ae}))}}if((t&7)===0){e:{if(D=e==="mouseover"||e==="pointerover",j=e==="mouseout"||e==="pointerout",D&&s!==Pr&&(le=s.relatedTarget||s.fromElement)&&(js(le)||le[Ds]))break e;if((j||D)&&(D=k.window===k?k:(D=k.ownerDocument)?D.defaultView||D.parentWindow:window,j?(le=s.relatedTarget||s.toElement,j=A,le=le?js(le):null,le!==null&&(Ce=d(le),ae=le.tag,le!==Ce||ae!==5&&ae!==27&&ae!==6)&&(le=null)):(j=null,le=A),j!==le)){if(ae=Md,z="onMouseLeave",N="onMouseEnter",E="mouse",(e==="pointerout"||e==="pointerover")&&(ae=kd,z="onPointerLeave",N="onPointerEnter",E="pointer"),Ce=j==null?D:za(j),R=le==null?D:za(le),D=new ae(z,E+"leave",j,s,k),D.target=Ce,D.relatedTarget=R,z=null,js(k)===A&&(ae=new ae(N,E+"enter",le,s,k),ae.target=R,ae.relatedTarget=Ce,z=ae),Ce=z,j&&le)t:{for(ae=j,N=le,E=0,R=ae;R;R=da(R))E++;for(R=0,z=N;z;z=da(z))R++;for(;0<E-R;)ae=da(ae),E--;for(;0<R-E;)N=da(N),R--;for(;E--;){if(ae===N||N!==null&&ae===N.alternate)break t;ae=da(ae),N=da(N)}ae=null}else ae=null;j!==null&&Em(B,D,j,ae,!1),le!==null&&Ce!==null&&Em(B,Ce,le,ae,!0)}}e:{if(D=A?za(A):window,j=D.nodeName&&D.nodeName.toLowerCase(),j==="select"||j==="input"&&D.type==="file")var W=Gd;else if(Hd(D))if(Yd)W=by;else{W=yy;var oe=py}else j=D.nodeName,!j||j.toLowerCase()!=="input"||D.type!=="checkbox"&&D.type!=="radio"?A&&Jr(A.elementType)&&(W=Gd):W=vy;if(W&&(W=W(e,A))){Id(B,W,s,k);break e}oe&&oe(e,D,A),e==="focusout"&&A&&D.type==="number"&&A.memoizedProps.value!=null&&Wr(D,"number",D.value)}switch(oe=A?za(A):window,e){case"focusin":(Hd(oe)||oe.contentEditable==="true")&&(Is=oe,ho=A,Qa=null);break;case"focusout":Qa=ho=Is=null;break;case"mousedown":mo=!0;break;case"contextmenu":case"mouseup":case"dragend":mo=!1,Wd(B,s,k);break;case"selectionchange":if(_y)break;case"keydown":case"keyup":Wd(B,s,k)}var te;if(oo)e:{switch(e){case"compositionstart":var ie="onCompositionStart";break e;case"compositionend":ie="onCompositionEnd";break e;case"compositionupdate":ie="onCompositionUpdate";break e}ie=void 0}else Hs?Bd(e,s)&&(ie="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(ie="onCompositionStart");ie&&(Ud&&s.locale!=="ko"&&(Hs||ie!=="onCompositionStart"?ie==="onCompositionEnd"&&Hs&&(te=Dd()):(An=k,so="value"in An?An.value:An.textContent,Hs=!0)),oe=Pl(A,ie),0<oe.length&&(ie=new Od(ie,e,null,s,k),B.push({event:ie,listeners:oe}),te?ie.data=te:(te=qd(s),te!==null&&(ie.data=te)))),(te=dy?fy(e,s):hy(e,s))&&(ie=Pl(A,"onBeforeInput"),0<ie.length&&(oe=new Od("onBeforeInput","beforeinput",null,s,k),B.push({event:oe,listeners:ie}),oe.data=te)),sv(B,e,A,s,k)}wm(B,t)})}function xi(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Pl(e,t){for(var s=t+"Capture",i=[];e!==null;){var o=e,u=o.stateNode;if(o=o.tag,o!==5&&o!==26&&o!==27||u===null||(o=Ba(e,s),o!=null&&i.unshift(xi(e,o,u)),o=Ba(e,t),o!=null&&i.push(xi(e,o,u))),e.tag===3)return i;e=e.return}return[]}function da(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Em(e,t,s,i,o){for(var u=t._reactName,m=[];s!==null&&s!==i;){var v=s,S=v.alternate,A=v.stateNode;if(v=v.tag,S!==null&&S===i)break;v!==5&&v!==26&&v!==27||A===null||(S=A,o?(A=Ba(s,u),A!=null&&m.unshift(xi(s,A,S))):o||(A=Ba(s,u),A!=null&&m.push(xi(s,A,S)))),s=s.return}m.length!==0&&e.push({event:t,listeners:m})}var rv=/\r\n?/g,ov=/\u0000|\uFFFD/g;function Cm(e){return(typeof e=="string"?e:""+e).replace(rv,`
`).replace(ov,"")}function Nm(e,t){return t=Cm(t),Cm(e)===t}function er(){}function Ee(e,t,s,i,o,u){switch(s){case"children":typeof i=="string"?t==="body"||t==="textarea"&&i===""||zs(e,i):(typeof i=="number"||typeof i=="bigint")&&t!=="body"&&zs(e,""+i);break;case"className":il(e,"class",i);break;case"tabIndex":il(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":il(e,s,i);break;case"style":Td(e,i,u);break;case"data":if(t!=="object"){il(e,"data",i);break}case"src":case"href":if(i===""&&(t!=="a"||s!=="href")){e.removeAttribute(s);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(s);break}i=ol(""+i),e.setAttribute(s,i);break;case"action":case"formAction":if(typeof i=="function"){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof u=="function"&&(s==="formAction"?(t!=="input"&&Ee(e,t,"name",o.name,o,null),Ee(e,t,"formEncType",o.formEncType,o,null),Ee(e,t,"formMethod",o.formMethod,o,null),Ee(e,t,"formTarget",o.formTarget,o,null)):(Ee(e,t,"encType",o.encType,o,null),Ee(e,t,"method",o.method,o,null),Ee(e,t,"target",o.target,o,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){e.removeAttribute(s);break}i=ol(""+i),e.setAttribute(s,i);break;case"onClick":i!=null&&(e.onclick=er);break;case"onScroll":i!=null&&ue("scroll",e);break;case"onScrollEnd":i!=null&&ue("scrollend",e);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(s=i.__html,s!=null){if(o.children!=null)throw Error(l(60));e.innerHTML=s}}break;case"multiple":e.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":e.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){e.removeAttribute("xlink:href");break}s=ol(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(s,""+i):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":i===!0?e.setAttribute(s,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?e.setAttribute(s,i):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?e.setAttribute(s,i):e.removeAttribute(s);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?e.removeAttribute(s):e.setAttribute(s,i);break;case"popover":ue("beforetoggle",e),ue("toggle",e),al(e,"popover",i);break;case"xlinkActuate":an(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":an(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":an(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":an(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":an(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":an(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":an(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":an(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":an(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":al(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=Bp.get(s)||s,al(e,s,i))}}function zc(e,t,s,i,o,u){switch(s){case"style":Td(e,i,u);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(l(61));if(s=i.__html,s!=null){if(o.children!=null)throw Error(l(60));e.innerHTML=s}}break;case"children":typeof i=="string"?zs(e,i):(typeof i=="number"||typeof i=="bigint")&&zs(e,""+i);break;case"onScroll":i!=null&&ue("scroll",e);break;case"onScrollEnd":i!=null&&ue("scrollend",e);break;case"onClick":i!=null&&(e.onclick=er);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!pd.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(o=s.endsWith("Capture"),t=s.slice(2,o?s.length-7:void 0),u=e[ht]||null,u=u!=null?u[s]:null,typeof u=="function"&&e.removeEventListener(t,u,o),typeof i=="function")){typeof u!="function"&&u!==null&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(t,i,o);break e}s in e?e[s]=i:i===!0?e.setAttribute(s,""):al(e,s,i)}}}function at(e,t,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ue("error",e),ue("load",e);var i=!1,o=!1,u;for(u in s)if(s.hasOwnProperty(u)){var m=s[u];if(m!=null)switch(u){case"src":i=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:Ee(e,t,u,m,s,null)}}o&&Ee(e,t,"srcSet",s.srcSet,s,null),i&&Ee(e,t,"src",s.src,s,null);return;case"input":ue("invalid",e);var v=u=m=o=null,S=null,A=null;for(i in s)if(s.hasOwnProperty(i)){var k=s[i];if(k!=null)switch(i){case"name":o=k;break;case"type":m=k;break;case"checked":S=k;break;case"defaultChecked":A=k;break;case"value":u=k;break;case"defaultValue":v=k;break;case"children":case"dangerouslySetInnerHTML":if(k!=null)throw Error(l(137,t));break;default:Ee(e,t,i,k,s,null)}}Sd(e,u,v,S,A,m,o,!1),ll(e);return;case"select":ue("invalid",e),i=m=u=null;for(o in s)if(s.hasOwnProperty(o)&&(v=s[o],v!=null))switch(o){case"value":u=v;break;case"defaultValue":m=v;break;case"multiple":i=v;default:Ee(e,t,o,v,s,null)}t=u,s=m,e.multiple=!!i,t!=null?Ls(e,!!i,t,!1):s!=null&&Ls(e,!!i,s,!0);return;case"textarea":ue("invalid",e),u=o=i=null;for(m in s)if(s.hasOwnProperty(m)&&(v=s[m],v!=null))switch(m){case"value":i=v;break;case"defaultValue":o=v;break;case"children":u=v;break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(l(91));break;default:Ee(e,t,m,v,s,null)}Cd(e,i,o,u),ll(e);return;case"option":for(S in s)if(s.hasOwnProperty(S)&&(i=s[S],i!=null))switch(S){case"selected":e.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ee(e,t,S,i,s,null)}return;case"dialog":ue("beforetoggle",e),ue("toggle",e),ue("cancel",e),ue("close",e);break;case"iframe":case"object":ue("load",e);break;case"video":case"audio":for(i=0;i<bi.length;i++)ue(bi[i],e);break;case"image":ue("error",e),ue("load",e);break;case"details":ue("toggle",e);break;case"embed":case"source":case"link":ue("error",e),ue("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(A in s)if(s.hasOwnProperty(A)&&(i=s[A],i!=null))switch(A){case"children":case"dangerouslySetInnerHTML":throw Error(l(137,t));default:Ee(e,t,A,i,s,null)}return;default:if(Jr(t)){for(k in s)s.hasOwnProperty(k)&&(i=s[k],i!==void 0&&zc(e,t,k,i,s,void 0));return}}for(v in s)s.hasOwnProperty(v)&&(i=s[v],i!=null&&Ee(e,t,v,i,s,null))}function cv(e,t,s,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var o=null,u=null,m=null,v=null,S=null,A=null,k=null;for(j in s){var B=s[j];if(s.hasOwnProperty(j)&&B!=null)switch(j){case"checked":break;case"value":break;case"defaultValue":S=B;default:i.hasOwnProperty(j)||Ee(e,t,j,null,i,B)}}for(var D in i){var j=i[D];if(B=s[D],i.hasOwnProperty(D)&&(j!=null||B!=null))switch(D){case"type":u=j;break;case"name":o=j;break;case"checked":A=j;break;case"defaultChecked":k=j;break;case"value":m=j;break;case"defaultValue":v=j;break;case"children":case"dangerouslySetInnerHTML":if(j!=null)throw Error(l(137,t));break;default:j!==B&&Ee(e,t,D,j,i,B)}}Zr(e,m,v,S,A,k,u,o);return;case"select":j=m=v=D=null;for(u in s)if(S=s[u],s.hasOwnProperty(u)&&S!=null)switch(u){case"value":break;case"multiple":j=S;default:i.hasOwnProperty(u)||Ee(e,t,u,null,i,S)}for(o in i)if(u=i[o],S=s[o],i.hasOwnProperty(o)&&(u!=null||S!=null))switch(o){case"value":D=u;break;case"defaultValue":v=u;break;case"multiple":m=u;default:u!==S&&Ee(e,t,o,u,i,S)}t=v,s=m,i=j,D!=null?Ls(e,!!s,D,!1):!!i!=!!s&&(t!=null?Ls(e,!!s,t,!0):Ls(e,!!s,s?[]:"",!1));return;case"textarea":j=D=null;for(v in s)if(o=s[v],s.hasOwnProperty(v)&&o!=null&&!i.hasOwnProperty(v))switch(v){case"value":break;case"children":break;default:Ee(e,t,v,null,i,o)}for(m in i)if(o=i[m],u=s[m],i.hasOwnProperty(m)&&(o!=null||u!=null))switch(m){case"value":D=o;break;case"defaultValue":j=o;break;case"children":break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(l(91));break;default:o!==u&&Ee(e,t,m,o,i,u)}Ed(e,D,j);return;case"option":for(var le in s)if(D=s[le],s.hasOwnProperty(le)&&D!=null&&!i.hasOwnProperty(le))switch(le){case"selected":e.selected=!1;break;default:Ee(e,t,le,null,i,D)}for(S in i)if(D=i[S],j=s[S],i.hasOwnProperty(S)&&D!==j&&(D!=null||j!=null))switch(S){case"selected":e.selected=D&&typeof D!="function"&&typeof D!="symbol";break;default:Ee(e,t,S,D,i,j)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ae in s)D=s[ae],s.hasOwnProperty(ae)&&D!=null&&!i.hasOwnProperty(ae)&&Ee(e,t,ae,null,i,D);for(A in i)if(D=i[A],j=s[A],i.hasOwnProperty(A)&&D!==j&&(D!=null||j!=null))switch(A){case"children":case"dangerouslySetInnerHTML":if(D!=null)throw Error(l(137,t));break;default:Ee(e,t,A,D,i,j)}return;default:if(Jr(t)){for(var Ce in s)D=s[Ce],s.hasOwnProperty(Ce)&&D!==void 0&&!i.hasOwnProperty(Ce)&&zc(e,t,Ce,void 0,i,D);for(k in i)D=i[k],j=s[k],!i.hasOwnProperty(k)||D===j||D===void 0&&j===void 0||zc(e,t,k,D,i,j);return}}for(var N in s)D=s[N],s.hasOwnProperty(N)&&D!=null&&!i.hasOwnProperty(N)&&Ee(e,t,N,null,i,D);for(B in i)D=i[B],j=s[B],!i.hasOwnProperty(B)||D===j||D==null&&j==null||Ee(e,t,B,D,i,j)}var Bc=null,qc=null;function tr(e){return e.nodeType===9?e:e.ownerDocument}function Tm(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Rm(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function Hc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ic=null;function uv(){var e=window.event;return e&&e.type==="popstate"?e===Ic?!1:(Ic=e,!0):(Ic=null,!1)}var Am=typeof setTimeout=="function"?setTimeout:void 0,dv=typeof clearTimeout=="function"?clearTimeout:void 0,Dm=typeof Promise=="function"?Promise:void 0,fv=typeof queueMicrotask=="function"?queueMicrotask:typeof Dm<"u"?function(e){return Dm.resolve(null).then(e).catch(hv)}:Am;function hv(e){setTimeout(function(){throw e})}function Vn(e){return e==="head"}function jm(e,t){var s=t,i=0,o=0;do{var u=s.nextSibling;if(e.removeChild(s),u&&u.nodeType===8)if(s=u.data,s==="/$"){if(0<i&&8>i){s=i;var m=e.ownerDocument;if(s&1&&_i(m.documentElement),s&2&&_i(m.body),s&4)for(s=m.head,_i(s),m=s.firstChild;m;){var v=m.nextSibling,S=m.nodeName;m[La]||S==="SCRIPT"||S==="STYLE"||S==="LINK"&&m.rel.toLowerCase()==="stylesheet"||s.removeChild(m),m=v}}if(o===0){e.removeChild(u),Ai(t);return}o--}else s==="$"||s==="$?"||s==="$!"?o++:i=s.charCodeAt(0)-48;else i=0;s=u}while(s);Ai(t)}function Gc(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var s=t;switch(t=t.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":Gc(s),Qr(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}e.removeChild(s)}}function mv(e,t,s,i){for(;e.nodeType===1;){var o=s;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(i){if(!e[La])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(u=e.getAttribute("rel"),u==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(u!==o.rel||e.getAttribute("href")!==(o.href==null||o.href===""?null:o.href)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin)||e.getAttribute("title")!==(o.title==null?null:o.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(u=e.getAttribute("src"),(u!==(o.src==null?null:o.src)||e.getAttribute("type")!==(o.type==null?null:o.type)||e.getAttribute("crossorigin")!==(o.crossOrigin==null?null:o.crossOrigin))&&u&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var u=o.name==null?null:""+o.name;if(o.type==="hidden"&&e.getAttribute("name")===u)return e}else return e;if(e=Yt(e.nextSibling),e===null)break}return null}function gv(e,t,s){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!s||(e=Yt(e.nextSibling),e===null))return null;return e}function Yc(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function pv(e,t){var s=e.ownerDocument;if(e.data!=="$?"||s.readyState==="complete")t();else{var i=function(){t(),s.removeEventListener("DOMContentLoaded",i)};s.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}function Yt(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Fc=null;function Mm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}function Om(e,t,s){switch(t=tr(s),e){case"html":if(e=t.documentElement,!e)throw Error(l(452));return e;case"head":if(e=t.head,!e)throw Error(l(453));return e;case"body":if(e=t.body,!e)throw Error(l(454));return e;default:throw Error(l(451))}}function _i(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qr(e)}var Ht=new Map,km=new Set;function nr(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var bn=Y.d;Y.d={f:yv,r:vv,D:bv,C:xv,L:_v,m:wv,X:Ev,S:Sv,M:Cv};function yv(){var e=bn.f(),t=Xl();return e||t}function vv(e){var t=Ms(e);t!==null&&t.tag===5&&t.type==="form"?eh(t):bn.r(e)}var fa=typeof document>"u"?null:document;function Um(e,t,s){var i=fa;if(i&&typeof t=="string"&&t){var o=Ot(t);o='link[rel="'+e+'"][href="'+o+'"]',typeof s=="string"&&(o+='[crossorigin="'+s+'"]'),km.has(o)||(km.add(o),e={rel:e,crossOrigin:s,href:t},i.querySelector(o)===null&&(t=i.createElement("link"),at(t,"link",e),$e(t),i.head.appendChild(t)))}}function bv(e){bn.D(e),Um("dns-prefetch",e,null)}function xv(e,t){bn.C(e,t),Um("preconnect",e,t)}function _v(e,t,s){bn.L(e,t,s);var i=fa;if(i&&e&&t){var o='link[rel="preload"][as="'+Ot(t)+'"]';t==="image"&&s&&s.imageSrcSet?(o+='[imagesrcset="'+Ot(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(o+='[imagesizes="'+Ot(s.imageSizes)+'"]')):o+='[href="'+Ot(e)+'"]';var u=o;switch(t){case"style":u=ha(e);break;case"script":u=ma(e)}Ht.has(u)||(e=b({rel:"preload",href:t==="image"&&s&&s.imageSrcSet?void 0:e,as:t},s),Ht.set(u,e),i.querySelector(o)!==null||t==="style"&&i.querySelector(wi(u))||t==="script"&&i.querySelector(Si(u))||(t=i.createElement("link"),at(t,"link",e),$e(t),i.head.appendChild(t)))}}function wv(e,t){bn.m(e,t);var s=fa;if(s&&e){var i=t&&typeof t.as=="string"?t.as:"script",o='link[rel="modulepreload"][as="'+Ot(i)+'"][href="'+Ot(e)+'"]',u=o;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":u=ma(e)}if(!Ht.has(u)&&(e=b({rel:"modulepreload",href:e},t),Ht.set(u,e),s.querySelector(o)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(Si(u)))return}i=s.createElement("link"),at(i,"link",e),$e(i),s.head.appendChild(i)}}}function Sv(e,t,s){bn.S(e,t,s);var i=fa;if(i&&e){var o=Os(i).hoistableStyles,u=ha(e);t=t||"default";var m=o.get(u);if(!m){var v={loading:0,preload:null};if(m=i.querySelector(wi(u)))v.loading=5;else{e=b({rel:"stylesheet",href:e,"data-precedence":t},s),(s=Ht.get(u))&&Vc(e,s);var S=m=i.createElement("link");$e(S),at(S,"link",e),S._p=new Promise(function(A,k){S.onload=A,S.onerror=k}),S.addEventListener("load",function(){v.loading|=1}),S.addEventListener("error",function(){v.loading|=2}),v.loading|=4,sr(m,t,i)}m={type:"stylesheet",instance:m,count:1,state:v},o.set(u,m)}}}function Ev(e,t){bn.X(e,t);var s=fa;if(s&&e){var i=Os(s).hoistableScripts,o=ma(e),u=i.get(o);u||(u=s.querySelector(Si(o)),u||(e=b({src:e,async:!0},t),(t=Ht.get(o))&&Qc(e,t),u=s.createElement("script"),$e(u),at(u,"link",e),s.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(o,u))}}function Cv(e,t){bn.M(e,t);var s=fa;if(s&&e){var i=Os(s).hoistableScripts,o=ma(e),u=i.get(o);u||(u=s.querySelector(Si(o)),u||(e=b({src:e,async:!0,type:"module"},t),(t=Ht.get(o))&&Qc(e,t),u=s.createElement("script"),$e(u),at(u,"link",e),s.head.appendChild(u)),u={type:"script",instance:u,count:1,state:null},i.set(o,u))}}function Lm(e,t,s,i){var o=(o=Nn.current)?nr(o):null;if(!o)throw Error(l(446));switch(e){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(t=ha(s.href),s=Os(o).hoistableStyles,i=s.get(t),i||(i={type:"style",instance:null,count:0,state:null},s.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){e=ha(s.href);var u=Os(o).hoistableStyles,m=u.get(e);if(m||(o=o.ownerDocument||o,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,m),(u=o.querySelector(wi(e)))&&!u._p&&(m.instance=u,m.state.loading=5),Ht.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},Ht.set(e,s),u||Nv(o,e,s,m.state))),t&&i===null)throw Error(l(528,""));return m}if(t&&i!==null)throw Error(l(529,""));return null;case"script":return t=s.async,s=s.src,typeof s=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=ma(s),s=Os(o).hoistableScripts,i=s.get(t),i||(i={type:"script",instance:null,count:0,state:null},s.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(l(444,e))}}function ha(e){return'href="'+Ot(e)+'"'}function wi(e){return'link[rel="stylesheet"]['+e+"]"}function zm(e){return b({},e,{"data-precedence":e.precedence,precedence:null})}function Nv(e,t,s,i){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?i.loading=1:(t=e.createElement("link"),i.preload=t,t.addEventListener("load",function(){return i.loading|=1}),t.addEventListener("error",function(){return i.loading|=2}),at(t,"link",s),$e(t),e.head.appendChild(t))}function ma(e){return'[src="'+Ot(e)+'"]'}function Si(e){return"script[async]"+e}function Bm(e,t,s){if(t.count++,t.instance===null)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+Ot(s.href)+'"]');if(i)return t.instance=i,$e(i),i;var o=b({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return i=(e.ownerDocument||e).createElement("style"),$e(i),at(i,"style",o),sr(i,s.precedence,e),t.instance=i;case"stylesheet":o=ha(s.href);var u=e.querySelector(wi(o));if(u)return t.state.loading|=4,t.instance=u,$e(u),u;i=zm(s),(o=Ht.get(o))&&Vc(i,o),u=(e.ownerDocument||e).createElement("link"),$e(u);var m=u;return m._p=new Promise(function(v,S){m.onload=v,m.onerror=S}),at(u,"link",i),t.state.loading|=4,sr(u,s.precedence,e),t.instance=u;case"script":return u=ma(s.src),(o=e.querySelector(Si(u)))?(t.instance=o,$e(o),o):(i=s,(o=Ht.get(u))&&(i=b({},s),Qc(i,o)),e=e.ownerDocument||e,o=e.createElement("script"),$e(o),at(o,"link",i),e.head.appendChild(o),t.instance=o);case"void":return null;default:throw Error(l(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(i=t.instance,t.state.loading|=4,sr(i,s.precedence,e));return t.instance}function sr(e,t,s){for(var i=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),o=i.length?i[i.length-1]:null,u=o,m=0;m<i.length;m++){var v=i[m];if(v.dataset.precedence===t)u=v;else if(u!==o)break}u?u.parentNode.insertBefore(e,u.nextSibling):(t=s.nodeType===9?s.head:s,t.insertBefore(e,t.firstChild))}function Vc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Qc(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var ar=null;function qm(e,t,s){if(ar===null){var i=new Map,o=ar=new Map;o.set(s,i)}else o=ar,i=o.get(s),i||(i=new Map,o.set(s,i));if(i.has(e))return i;for(i.set(e,null),s=s.getElementsByTagName(e),o=0;o<s.length;o++){var u=s[o];if(!(u[La]||u[lt]||e==="link"&&u.getAttribute("rel")==="stylesheet")&&u.namespaceURI!=="http://www.w3.org/2000/svg"){var m=u.getAttribute(t)||"";m=e+m;var v=i.get(m);v?v.push(u):i.set(m,[u])}}return i}function Hm(e,t,s){e=e.ownerDocument||e,e.head.insertBefore(s,t==="title"?e.querySelector("head > title"):null)}function Tv(e,t,s){if(s===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Im(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var Ei=null;function Rv(){}function Av(e,t,s){if(Ei===null)throw Error(l(475));var i=Ei;if(t.type==="stylesheet"&&(typeof s.media!="string"||matchMedia(s.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var o=ha(s.href),u=e.querySelector(wi(o));if(u){e=u._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(i.count++,i=ir.bind(i),e.then(i,i)),t.state.loading|=4,t.instance=u,$e(u);return}u=e.ownerDocument||e,s=zm(s),(o=Ht.get(o))&&Vc(s,o),u=u.createElement("link"),$e(u);var m=u;m._p=new Promise(function(v,S){m.onload=v,m.onerror=S}),at(u,"link",s),t.instance=u}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(i.count++,t=ir.bind(i),e.addEventListener("load",t),e.addEventListener("error",t))}}function Dv(){if(Ei===null)throw Error(l(475));var e=Ei;return e.stylesheets&&e.count===0&&Xc(e,e.stylesheets),0<e.count?function(t){var s=setTimeout(function(){if(e.stylesheets&&Xc(e,e.stylesheets),e.unsuspend){var i=e.unsuspend;e.unsuspend=null,i()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(s)}}:null}function ir(){if(this.count--,this.count===0){if(this.stylesheets)Xc(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var lr=null;function Xc(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,lr=new Map,t.forEach(jv,e),lr=null,ir.call(e))}function jv(e,t){if(!(t.state.loading&4)){var s=lr.get(e);if(s)var i=s.get(null);else{s=new Map,lr.set(e,s);for(var o=e.querySelectorAll("link[data-precedence],style[data-precedence]"),u=0;u<o.length;u++){var m=o[u];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(s.set(m.dataset.precedence,m),i=m)}i&&s.set(null,i)}o=t.instance,m=o.getAttribute("data-precedence"),u=s.get(m)||i,u===i&&s.set(null,o),s.set(m,o),this.count++,i=ir.bind(this),o.addEventListener("load",i),o.addEventListener("error",i),u?u.parentNode.insertBefore(o,u.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(o,e.firstChild)),t.state.loading|=4}}var Ci={$$typeof:U,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function Mv(e,t,s,i,o,u,m,v){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Gr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gr(0),this.hiddenUpdates=Gr(null),this.identifierPrefix=i,this.onUncaughtError=o,this.onCaughtError=u,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=v,this.incompleteTransitions=new Map}function Gm(e,t,s,i,o,u,m,v,S,A,k,B){return e=new Mv(e,t,s,m,v,S,A,B),t=1,u===!0&&(t|=24),u=wt(3,null,null,t),e.current=u,u.stateNode=e,t=Ro(),t.refCount++,e.pooledCache=t,t.refCount++,u.memoizedState={element:i,isDehydrated:s,cache:t},Mo(u),e}function Ym(e){return e?(e=Vs,e):Vs}function Fm(e,t,s,i,o,u){o=Ym(o),i.context===null?i.context=o:i.pendingContext=o,i=Mn(t),i.payload={element:s},u=u===void 0?null:u,u!==null&&(i.callback=u),s=On(e,i,t),s!==null&&(Tt(s,e,t),ti(s,e,t))}function Vm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function $c(e,t){Vm(e,t),(e=e.alternate)&&Vm(e,t)}function Qm(e){if(e.tag===13){var t=Fs(e,67108864);t!==null&&Tt(t,e,67108864),$c(e,67108864)}}var rr=!0;function Ov(e,t,s,i){var o=T.T;T.T=null;var u=Y.p;try{Y.p=2,Kc(e,t,s,i)}finally{Y.p=u,T.T=o}}function kv(e,t,s,i){var o=T.T;T.T=null;var u=Y.p;try{Y.p=8,Kc(e,t,s,i)}finally{Y.p=u,T.T=o}}function Kc(e,t,s,i){if(rr){var o=Zc(i);if(o===null)Lc(e,t,i,or,s),$m(e,i);else if(Lv(o,e,t,s,i))i.stopPropagation();else if($m(e,i),t&4&&-1<Uv.indexOf(e)){for(;o!==null;){var u=Ms(o);if(u!==null)switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var m=ts(u.pendingLanes);if(m!==0){var v=u;for(v.pendingLanes|=2,v.entangledLanes|=2;m;){var S=1<<31-xt(m);v.entanglements[1]|=S,m&=~S}nn(u),(be&6)===0&&(Vl=Wt()+500,vi(0))}}break;case 13:v=Fs(u,2),v!==null&&Tt(v,u,2),Xl(),$c(u,2)}if(u=Zc(i),u===null&&Lc(e,t,i,or,s),u===o)break;o=u}o!==null&&i.stopPropagation()}else Lc(e,t,i,null,s)}}function Zc(e){return e=eo(e),Wc(e)}var or=null;function Wc(e){if(or=null,e=js(e),e!==null){var t=d(e);if(t===null)e=null;else{var s=t.tag;if(s===13){if(e=h(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return or=e,null}function Xm(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(xp()){case ld:return 2;case rd:return 8;case el:case _p:return 32;case od:return 268435456;default:return 32}default:return 32}}var Jc=!1,Qn=null,Xn=null,$n=null,Ni=new Map,Ti=new Map,Kn=[],Uv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $m(e,t){switch(e){case"focusin":case"focusout":Qn=null;break;case"dragenter":case"dragleave":Xn=null;break;case"mouseover":case"mouseout":$n=null;break;case"pointerover":case"pointerout":Ni.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ti.delete(t.pointerId)}}function Ri(e,t,s,i,o,u){return e===null||e.nativeEvent!==u?(e={blockedOn:t,domEventName:s,eventSystemFlags:i,nativeEvent:u,targetContainers:[o]},t!==null&&(t=Ms(t),t!==null&&Qm(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Lv(e,t,s,i,o){switch(t){case"focusin":return Qn=Ri(Qn,e,t,s,i,o),!0;case"dragenter":return Xn=Ri(Xn,e,t,s,i,o),!0;case"mouseover":return $n=Ri($n,e,t,s,i,o),!0;case"pointerover":var u=o.pointerId;return Ni.set(u,Ri(Ni.get(u)||null,e,t,s,i,o)),!0;case"gotpointercapture":return u=o.pointerId,Ti.set(u,Ri(Ti.get(u)||null,e,t,s,i,o)),!0}return!1}function Km(e){var t=js(e.target);if(t!==null){var s=d(t);if(s!==null){if(t=s.tag,t===13){if(t=h(s),t!==null){e.blockedOn=t,Ap(e.priority,function(){if(s.tag===13){var i=Nt();i=Yr(i);var o=Fs(s,i);o!==null&&Tt(o,s,i),$c(s,i)}});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cr(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Zc(e.nativeEvent);if(s===null){s=e.nativeEvent;var i=new s.constructor(s.type,s);Pr=i,s.target.dispatchEvent(i),Pr=null}else return t=Ms(s),t!==null&&Qm(t),e.blockedOn=s,!1;t.shift()}return!0}function Zm(e,t,s){cr(e)&&s.delete(t)}function zv(){Jc=!1,Qn!==null&&cr(Qn)&&(Qn=null),Xn!==null&&cr(Xn)&&(Xn=null),$n!==null&&cr($n)&&($n=null),Ni.forEach(Zm),Ti.forEach(Zm)}function ur(e,t){e.blockedOn===t&&(e.blockedOn=null,Jc||(Jc=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,zv)))}var dr=null;function Wm(e){dr!==e&&(dr=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){dr===e&&(dr=null);for(var t=0;t<e.length;t+=3){var s=e[t],i=e[t+1],o=e[t+2];if(typeof i!="function"){if(Wc(i||s)===null)continue;break}var u=Ms(s);u!==null&&(e.splice(t,3),t-=3,Wo(u,{pending:!0,data:o,method:s.method,action:i},i,o))}}))}function Ai(e){function t(S){return ur(S,e)}Qn!==null&&ur(Qn,e),Xn!==null&&ur(Xn,e),$n!==null&&ur($n,e),Ni.forEach(t),Ti.forEach(t);for(var s=0;s<Kn.length;s++){var i=Kn[s];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Kn.length&&(s=Kn[0],s.blockedOn===null);)Km(s),s.blockedOn===null&&Kn.shift();if(s=(e.ownerDocument||e).$$reactFormReplay,s!=null)for(i=0;i<s.length;i+=3){var o=s[i],u=s[i+1],m=o[ht]||null;if(typeof u=="function")m||Wm(s);else if(m){var v=null;if(u&&u.hasAttribute("formAction")){if(o=u,m=u[ht]||null)v=m.formAction;else if(Wc(o)!==null)continue}else v=m.action;typeof v=="function"?s[i+1]=v:(s.splice(i,3),i-=3),Wm(s)}}}function Pc(e){this._internalRoot=e}fr.prototype.render=Pc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(l(409));var s=t.current,i=Nt();Fm(s,i,e,t,null,null)},fr.prototype.unmount=Pc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fm(e.current,2,null,e,null,null),Xl(),t[Ds]=null}};function fr(e){this._internalRoot=e}fr.prototype.unstable_scheduleHydration=function(e){if(e){var t=hd();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Kn.length&&t!==0&&t<Kn[s].priority;s++);Kn.splice(s,0,e),s===0&&Km(e)}};var Jm=n.version;if(Jm!=="19.1.1")throw Error(l(527,Jm,"19.1.1"));Y.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(l(188)):(e=Object.keys(e).join(","),Error(l(268,e)));return e=p(t),e=e!==null?y(e):null,e=e===null?null:e.stateNode,e};var Bv={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:T,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hr.isDisabled&&hr.supportsFiber)try{Oa=hr.inject(Bv),bt=hr}catch{}}return ji.createRoot=function(e,t){if(!c(e))throw Error(l(299));var s=!1,i="",o=mh,u=gh,m=ph,v=null;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(u=t.onCaughtError),t.onRecoverableError!==void 0&&(m=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(v=t.unstable_transitionCallbacks)),t=Gm(e,1,!1,null,null,s,i,o,u,m,v,null),e[Ds]=t.current,Uc(e),new Pc(t)},ji.hydrateRoot=function(e,t,s){if(!c(e))throw Error(l(299));var i=!1,o="",u=mh,m=gh,v=ph,S=null,A=null;return s!=null&&(s.unstable_strictMode===!0&&(i=!0),s.identifierPrefix!==void 0&&(o=s.identifierPrefix),s.onUncaughtError!==void 0&&(u=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(v=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(S=s.unstable_transitionCallbacks),s.formState!==void 0&&(A=s.formState)),t=Gm(e,1,!0,t,s??null,i,o,u,m,v,S,A),t.context=Ym(null),s=t.current,i=Nt(),i=Yr(i),o=Mn(i),o.callback=null,On(s,o,i),s=i,t.current.lanes=s,Ua(t,s),nn(t),e[Ds]=t.current,Uc(e),new fr(t)},ji.version="19.1.1",ji}var dg;function Sb(){if(dg)return nu.exports;dg=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(n){console.error(n)}}return r(),nu.exports=wb(),nu.exports}var Eb=Sb();const Cb="modulepreload",Nb=function(r){return"/lora_dataset_builder/"+r},fg={},yr=function(n,a,l){let c=Promise.resolve();if(a&&a.length>0){let p=function(y){return Promise.all(y.map(b=>Promise.resolve(b).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};document.getElementsByTagName("link");const h=document.querySelector("meta[property=csp-nonce]"),g=h?.nonce||h?.getAttribute("nonce");c=p(a.map(y=>{if(y=Nb(y),y in fg)return;fg[y]=!0;const b=y.endsWith(".css"),x=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${y}"]${x}`))return;const _=document.createElement("link");if(_.rel=b?"stylesheet":Cb,b||(_.as="script"),_.crossOrigin="",_.href=y,g&&_.setAttribute("nonce",g),document.head.appendChild(_),b)return new Promise((C,O)=>{_.addEventListener("load",C),_.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${y}`)))})}))}function d(h){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=h,window.dispatchEvent(g),!g.defaultPrevented)throw h}return c.then(h=>{for(const g of h||[])g.status==="rejected"&&d(g.reason);return n().catch(d)})},Tb={apiKey:"AIzaSyAfWv4Jjjv0ghvn6av4FmZ_Y5kjxCYuwho",authDomain:"lora-dataset-builder-prod.firebaseapp.com",projectId:"lora-dataset-builder-prod",storageBucket:"lora-dataset-builder-prod.firebasestorage.app",messagingSenderId:"524055956982",appId:"1:524055956982:web:526363bdb84f39f2780bd7"},Rb=Tb,n0=Iv(Rb),Oe=Gv(n0),Wn=Yv(n0);console.log("🚀 Connected to production Firebase");const Ab=Object.freeze(Object.defineProperty({__proto__:null,db:Oe,storage:Wn},Symbol.toStringTag,{value:"Module"}));async function s0(r,n={}){const{maxRetries:a=3,baseDelay:l=1e3,maxDelay:c=3e4,backoffFactor:d=2,jitter:h=!0,retryCondition:g=Db,onRetry:p}=n;let y;for(let b=1;b<=a+1;b++)try{return await r()}catch(x){if(y=x instanceof Error?x:new Error(String(x)),b>a)break;if(!g(y,b))throw y;p&&p(y,b);let _=Math.min(l*Math.pow(d,b-1),c);if(h){const C=_*.25;_+=(Math.random()-.5)*2*C}await qb(Math.max(0,_))}throw y}function Db(r,n){return kb(r)||Ub(r)||hg(r)&&n>1?!1:jb(r)||Mb(r)||Ob(r)||hg(r)}function jb(r){return r.message.includes("Network")||r.message.includes("fetch")||r.message.includes("connection")||r.name==="NetworkError"}function Mb(r){return r.message.toLowerCase().includes("timeout")||r.message.toLowerCase().includes("timed out")||r.name==="TimeoutError"}function Ob(r){return r.message.includes("500")||r.message.includes("502")||r.message.includes("503")||r.message.includes("504")||r.message.includes("Internal Server Error")}function kb(r){return r.message.includes("auth")||r.message.includes("Auth")||r.message.includes("401")||r.message.includes("403")||r.message.includes("Unauthorized")||r.message.includes("Forbidden")}function Ub(r){return r.message.toLowerCase().includes("validation")||r.message.toLowerCase().includes("invalid")||r.message.includes("400")||r.message.includes("Bad Request")}function hg(r){return r.message.toLowerCase().includes("rate limit")||r.message.includes("429")||r.message.includes("Too Many Requests")}async function Lb(r,n,a={}){const{concurrency:l=3,...c}=a,d=Date.now(),h=[],g=[],p=new zb(l),y=r.map(async b=>p.acquire(async()=>{try{const x=await s0(()=>n(b),c);h.push(x)}catch(x){g.push({item:b,error:x instanceof Error?x:new Error(String(x))})}}));return await Promise.all(y),{successful:h,failed:g,totalTime:Date.now()-d}}class zb{permits;waiting=[];constructor(n){this.permits=n}async acquire(n){return new Promise((a,l)=>{this.permits>0?(this.permits--,this.executeTask(n,a,l)):this.waiting.push(()=>{this.permits--,this.executeTask(n,a,l)})})}async executeTask(n,a,l){try{const c=await n();a(c)}catch(c){l(c)}finally{if(this.permits++,this.waiting.length>0){const c=this.waiting.shift();c&&c()}}}}class Bb{constructor(n=5,a=6e4){this.failureThreshold=n,this.recoveryTimeout=a}failures=0;lastFailureTime=0;state="closed";async execute(n){if(this.state==="open")if(Date.now()-this.lastFailureTime>this.recoveryTimeout)this.state="half-open";else throw new Error("Circuit breaker is open");try{const a=await n();return this.onSuccess(),a}catch(a){throw this.onFailure(),a}}onSuccess(){this.failures=0,this.state="closed"}onFailure(){this.failures++,this.lastFailureTime=Date.now(),this.failures>=this.failureThreshold&&(this.state="open")}getState(){return{state:this.state,failures:this.failures,lastFailureTime:this.lastFailureTime}}}function qb(r){return new Promise(n=>setTimeout(n,r))}function mr(r,n,a="Operation timed out"){return Promise.race([r,new Promise((l,c)=>{setTimeout(()=>c(new Error(a)),n)})])}class Hb{strategies=new Map;circuitBreakers=new Map;errorHistory=[];maxHistorySize=100;constructor(){this.initializeDefaultStrategies()}registerStrategy(n){this.strategies.set(n.id,n)}async executeWithRecovery(n,a,l={}){const{retryOptions:c,useCircuitBreaker:d=!1,metadata:h}=l;try{return d?await this.getCircuitBreaker(a).execute(n):await s0(n,{...c,onRetry:(g,p)=>{this.recordError(a,g,h),c?.onRetry?.(g,p)}})}catch(g){const p=this.recordError(a,g,h);if(await this.attemptRecovery(p))return await n();throw g}}async executeBatchWithRecovery(n,a,l,c={}){const{retryOptions:d,concurrency:h,metadata:g}=c;return await Lb(n,async p=>await this.executeWithRecovery(()=>a(p),l,{retryOptions:d,metadata:{...g,item:p}}),{...d,concurrency:h})}getErrorStats(n=36e5){const a=Date.now()-n,l=this.errorHistory.filter(h=>h.timestamp>a),c=new Map,d=new Map;return l.forEach(h=>{c.set(h.operation,(c.get(h.operation)||0)+1),d.set(h.error.name,(d.get(h.error.name)||0)+1)}),{totalErrors:l.length,errorsByOperation:Object.fromEntries(c),errorsByType:Object.fromEntries(d),timeWindow:n,oldestError:l[0]?.timestamp,newestError:l[l.length-1]?.timestamp}}isSystemDegraded(n={errorRate:.1,timeWindowMs:3e5}){return this.getErrorStats(n.timeWindowMs).totalErrors/(n.timeWindowMs/1e3)>n.errorRate}getCircuitBreakerStatus(){const n={};return this.circuitBreakers.forEach((a,l)=>{n[l]=a.getState()}),n}initializeDefaultStrategies(){this.registerStrategy({id:"network-recovery",name:"Network Recovery",description:"Attempt to restore network connectivity",canRecover:n=>n.message.includes("Network")||n.message.includes("fetch"),execute:async()=>{await new Promise(n=>setTimeout(n,2e3));try{await fetch("/favicon.ico",{method:"HEAD",cache:"no-cache"})}catch{throw new Error("Network connectivity not restored")}}}),this.registerStrategy({id:"firebase-recovery",name:"Firebase Service Recovery",description:"Attempt to restore Firebase connection",canRecover:n=>n.message.includes("Firebase")||n.message.includes("firestore"),execute:async()=>{await new Promise(n=>setTimeout(n,1e3))}}),this.registerStrategy({id:"auth-recovery",name:"Authentication Recovery",description:"Attempt to restore authentication",canRecover:n=>n.message.includes("auth")||n.message.includes("401"),execute:async()=>{throw new Error("Authentication recovery requires user intervention")}}),this.registerStrategy({id:"memory-recovery",name:"Memory Cleanup",description:"Free up memory resources",canRecover:n=>n.message.includes("memory")||n.message.includes("heap"),execute:async()=>{if(window.gc&&window.gc(),"caches"in window){const n=await caches.keys();await Promise.all(n.map(a=>caches.delete(a)))}}})}recordError(n,a,l){const c={operation:n,timestamp:Date.now(),error:a,metadata:l};return this.errorHistory.push(c),this.errorHistory.length>this.maxHistorySize&&(this.errorHistory=this.errorHistory.slice(-this.maxHistorySize)),c}async attemptRecovery(n){const a=Array.from(this.strategies.values()).filter(l=>l.canRecover(n.error));for(const l of a)try{return console.log(`Attempting recovery with strategy: ${l.name}`),await l.execute(),console.log(`Recovery successful with strategy: ${l.name}`),!0}catch(c){console.warn(`Recovery failed with strategy ${l.name}:`,c)}return!1}getCircuitBreaker(n){return this.circuitBreakers.has(n)||this.circuitBreakers.set(n,new Bb),this.circuitBreakers.get(n)}}const xr=new Hb,xn=xr.executeWithRecovery.bind(xr),Ib=xr.executeBatchWithRecovery.bind(xr);class Au{cache=new Map;defaultTTL;maxSize;constructor({ttl:n=300*1e3,maxSize:a=100}={}){this.defaultTTL=n,this.maxSize=a}set(n,a,l){this.cache.size>=this.maxSize&&(this.evictExpired(),this.cache.size>=this.maxSize&&this.evictOldest());const c={data:a,timestamp:Date.now(),ttl:l??this.defaultTTL};this.cache.set(n,c)}get(n){const a=this.cache.get(n);return a?Date.now()-a.timestamp>a.ttl?(this.cache.delete(n),null):a.data:null}has(n){return this.get(n)!==null}delete(n){return this.cache.delete(n)}clear(){this.cache.clear()}getStats(){const n=Date.now();let a=0,l=0;for(const[,c]of this.cache)l++,n-c.timestamp>c.ttl&&a++;return{totalEntries:l,expiredEntries:a,hitRate:this.hitCount/(this.hitCount+this.missCount)||0,memoryUsage:this.estimateMemoryUsage()}}hitCount=0;missCount=0;evictExpired(){const n=Date.now(),a=[];for(const[l,c]of this.cache)n-c.timestamp>c.ttl&&a.push(l);a.forEach(l=>this.cache.delete(l))}evictOldest(){const n=Array.from(this.cache.entries());n.sort((l,c)=>l[1].timestamp-c[1].timestamp);const a=Math.ceil(n.length*.25);for(let l=0;l<a;l++)this.cache.delete(n[l][0])}estimateMemoryUsage(){let n=0;for(const[a,l]of this.cache)n+=a.length*2,n+=JSON.stringify(l.data).length*2,n+=24;return n}}const Je=new Au({ttl:600*1e3,maxSize:200});new Au({ttl:1800*1e3,maxSize:500});new Au({ttl:3600*1e3,maxSize:10});class xa{static instance;state;listeners=new Set;storageKey="lora-dataset-sync-state";operationsKey="lora-dataset-pending-operations";broadcastChannel;onlineListener;offlineListener;constructor(){this.state=this.loadState(),this.broadcastChannel=new BroadcastChannel("lora-dataset-sync"),this.setupEventListeners()}static getInstance(){return xa.instance||(xa.instance=new xa),xa.instance}getState(){return{...this.state}}addEventListener(n){return this.listeners.add(n),()=>this.listeners.delete(n)}setConnectionStatus(n){this.state.isConnected!==n&&(this.state.isConnected=n,this.state.lastSync=n?Date.now():this.state.lastSync,this.saveState(),this.emitEvent({type:"state-change",data:{isConnected:n,lastSync:this.state.lastSync},timestamp:Date.now()}),n&&this.state.pendingOperations.length>0&&this.processPendingOperations())}queueOperation(n){const a=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,l={...n,id:a,timestamp:Date.now(),retryCount:0};return this.state.pendingOperations.push(l),this.saveState(),this.savePendingOperations(),this.emitEvent({type:"operation-queued",data:l,timestamp:Date.now()}),this.state.isOnline&&this.state.isConnected&&this.processPendingOperations(),a}completeOperation(n){const a=this.state.pendingOperations.findIndex(l=>l.id===n);if(a!==-1){const l=this.state.pendingOperations[a];this.state.pendingOperations.splice(a,1),this.saveState(),this.savePendingOperations(),this.emitEvent({type:"operation-synced",data:l,timestamp:Date.now()})}}detectConflict(n,a,l){const c={id:`${n}-${Date.now()}`,documentId:n,clientVersion:a,serverVersion:l,timestamp:Date.now(),resolved:!1};this.state.conflictResolution.conflicts.push(c),this.saveState(),this.emitEvent({type:"conflict-detected",data:c,timestamp:Date.now()})}resolveConflict(n){const a=this.state.conflictResolution.conflicts.find(c=>c.id===n);if(!a||a.resolved)return null;let l;switch(this.state.conflictResolution.strategy){case"client-wins":l=a.clientVersion;break;case"server-wins":l=a.serverVersion;break;case"merge":l=this.mergeVersions(a.clientVersion,a.serverVersion);break;case"manual":return{client:a.clientVersion,server:a.serverVersion,requiresManualResolution:!0}}return a.resolved=!0,this.saveState(),l}setConflictResolutionStrategy(n){this.state.conflictResolution.strategy=n,this.saveState()}getPendingOperationsCount(){return this.state.pendingOperations.length}clearPendingOperations(){this.state.pendingOperations=[],this.saveState(),this.savePendingOperations()}async processPendingOperations(){if(!this.state.isOnline||!this.state.isConnected)return;const n=[...this.state.pendingOperations];for(const a of n)try{await this.executeOperation(a),this.completeOperation(a.id)}catch(l){console.warn(`Failed to sync operation ${a.id}:`,l);const c=this.state.pendingOperations.findIndex(d=>d.id===a.id);c!==-1&&(this.state.pendingOperations[c].retryCount++,this.state.pendingOperations[c].retryCount>=5&&(console.error(`Removing operation ${a.id} after 5 failed attempts`),this.state.pendingOperations.splice(c,1))),this.saveState(),this.savePendingOperations()}}async executeOperation(n){throw new Error(`Operation execution not implemented for type: ${n.type}`)}mergeVersions(n,a){return!n||!a?a||n:n.id&&a.id?{...a,selectedIndex:n.selectedIndex??a.selectedIndex,selectedTextOverride:n.selectedTextOverride??a.selectedTextOverride,updatedAt:Math.max(n.updatedAt||0,a.updatedAt||0)}:{...a,...n}}setupEventListeners(){this.onlineListener=()=>{this.state.isOnline=!0,this.saveState(),this.emitEvent({type:"state-change",data:{isOnline:!0},timestamp:Date.now()})},this.offlineListener=()=>{this.state.isOnline=!1,this.state.isConnected=!1,this.saveState(),this.emitEvent({type:"state-change",data:{isOnline:!1,isConnected:!1},timestamp:Date.now()})},window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener),this.broadcastChannel.addEventListener("message",n=>{n.data.type==="sync-state-update"&&this.mergeStateFromOtherTab(n.data.state)}),this.addEventListener(n=>{this.broadcastChannel.postMessage({type:"sync-state-update",state:this.state,event:n})}),this.state.isOnline=navigator.onLine}mergeStateFromOtherTab(n){const a=new Set(this.state.pendingOperations.map(c=>c.id)),l=n.pendingOperations.filter(c=>!a.has(c.id));l.length>0&&(this.state.pendingOperations.push(...l),this.saveState(),this.savePendingOperations()),n.lastSync>this.state.lastSync&&(this.state.isConnected=n.isConnected,this.state.lastSync=n.lastSync,this.saveState())}emitEvent(n){this.listeners.forEach(a=>{try{a(n)}catch(l){console.error("Error in sync event listener:",l)}})}loadState(){try{const n=localStorage.getItem(this.storageKey);if(n)return{...JSON.parse(n),isOnline:navigator.onLine,pendingOperations:this.loadPendingOperations()}}catch(n){console.warn("Failed to load sync state:",n)}return{isOnline:navigator.onLine,isConnected:!1,lastSync:0,pendingOperations:[],conflictResolution:{strategy:"merge",conflicts:[]}}}saveState(){try{const n={...this.state,pendingOperations:[]};localStorage.setItem(this.storageKey,JSON.stringify(n))}catch(n){console.warn("Failed to save sync state:",n)}}loadPendingOperations(){try{const n=localStorage.getItem(this.operationsKey);return n?JSON.parse(n):[]}catch(n){return console.warn("Failed to load pending operations:",n),[]}}savePendingOperations(){try{localStorage.setItem(this.operationsKey,JSON.stringify(this.state.pendingOperations))}catch(n){console.warn("Failed to save pending operations:",n)}}destroy(){this.onlineListener&&window.removeEventListener("online",this.onlineListener),this.offlineListener&&window.removeEventListener("offline",this.offlineListener),this.broadcastChannel.close(),this.listeners.clear()}}const Rt=xa.getInstance();class _a{static instance;db=null;dbName="LoraDatasetBuilder";dbVersion=1;stores={images:"images",userSettings:"userSettings",metadata:"metadata"};constructor(){}static getInstance(){return _a.instance||(_a.instance=new _a),_a.instance}async initialize(){return this.db?Promise.resolve():new Promise((n,a)=>{const l=indexedDB.open(this.dbName,this.dbVersion);l.onerror=()=>{a(new Error("Failed to open IndexedDB"))},l.onsuccess=()=>{this.db=l.result,n()},l.onupgradeneeded=c=>{const d=c.target.result;if(!d.objectStoreNames.contains(this.stores.images)){const h=d.createObjectStore(this.stores.images,{keyPath:"id"});h.createIndex("userId","userId",{unique:!1}),h.createIndex("status","status",{unique:!1}),h.createIndex("createdAt","createdAt",{unique:!1})}d.objectStoreNames.contains(this.stores.userSettings)||d.createObjectStore(this.stores.userSettings,{keyPath:"userId"}),d.objectStoreNames.contains(this.stores.metadata)||d.createObjectStore(this.stores.metadata,{keyPath:"key"})}})}async storeImages(n,a){if(!this.db)throw new Error("Database not initialized");const l=this.db.transaction([this.stores.images],"readwrite"),c=l.objectStore(this.stores.images),d=a.map(h=>({...h,userId:n}));for(const h of d)await this.promisifyRequest(c.put(h));await this.promisifyTransaction(l),await this.updateLastSync()}async getImages(n){if(!this.db)throw new Error("Database not initialized");const d=this.db.transaction([this.stores.images],"readonly").objectStore(this.stores.images).index("userId").getAll(n);return(await this.promisifyRequest(d)).map(({userId:g,...p})=>p)}async storeImage(n,a){if(!this.db)throw new Error("Database not initialized");const l=this.db.transaction([this.stores.images],"readwrite"),c=l.objectStore(this.stores.images);await this.promisifyRequest(c.put({...a,userId:n})),await this.promisifyTransaction(l)}async getImage(n){if(!this.db)throw new Error("Database not initialized");const l=this.db.transaction([this.stores.images],"readonly").objectStore(this.stores.images),c=await this.promisifyRequest(l.get(n));if(c){const{userId:d,...h}=c;return h}return null}async updateImage(n,a,l){if(!this.db)throw new Error("Database not initialized");const c=this.db.transaction([this.stores.images],"readwrite"),d=c.objectStore(this.stores.images),h=await this.promisifyRequest(d.get(a));if(h){const g={...h,...l,updatedAt:Date.now()};await this.promisifyRequest(d.put(g))}await this.promisifyTransaction(c)}async deleteImage(n){if(!this.db)throw new Error("Database not initialized");const a=this.db.transaction([this.stores.images],"readwrite"),l=a.objectStore(this.stores.images);await this.promisifyRequest(l.delete(n)),await this.promisifyTransaction(a)}async getImagesByStatus(n,a){if(!this.db)throw new Error("Database not initialized");return this.db.transaction([this.stores.images],"readonly").objectStore(this.stores.images),(await this.getImages(n)).filter(d=>d.status===a)}async storeUserSettings(n){if(!this.db)throw new Error("Database not initialized");const a=this.db.transaction([this.stores.userSettings],"readwrite"),l=a.objectStore(this.stores.userSettings);await this.promisifyRequest(l.put({userId:"default",...n,updatedAt:Date.now()})),await this.promisifyTransaction(a)}async getUserSettings(){if(!this.db)throw new Error("Database not initialized");const a=this.db.transaction([this.stores.userSettings],"readonly").objectStore(this.stores.userSettings),l=await this.promisifyRequest(a.get("default"));if(l){const{userId:c,...d}=l;return d}return null}async getLastSync(){if(!this.db)throw new Error("Database not initialized");const a=this.db.transaction([this.stores.metadata],"readonly").objectStore(this.stores.metadata);return(await this.promisifyRequest(a.get("lastSync:default")))?.timestamp||0}async updateLastSync(){if(!this.db)throw new Error("Database not initialized");const n=this.db.transaction([this.stores.metadata],"readwrite"),a=n.objectStore(this.stores.metadata);await this.promisifyRequest(a.put({key:"lastSync:default",timestamp:Date.now()})),await this.promisifyTransaction(n)}async clearUserData(){if(!this.db)throw new Error("Database not initialized");const n=this.db.transaction([this.stores.images,this.stores.userSettings],"readwrite"),a=n.objectStore(this.stores.images);await this.promisifyRequest(a.clear());const l=n.objectStore(this.stores.userSettings);await this.promisifyRequest(l.clear()),await this.promisifyTransaction(n)}async getStorageQuota(){if("storage"in navigator&&"estimate"in navigator.storage)try{const n=await navigator.storage.estimate();return{used:n.usage||0,available:(n.quota||0)-(n.usage||0),total:n.quota||0}}catch(n){console.warn("Failed to get storage estimate:",n)}return{used:0,available:50*1024*1024,total:50*1024*1024}}async isStorageAvailable(){try{return(await this.getStorageQuota()).available>1024*1024}catch{return!1}}async cleanup(n,a=10080*60*1e3){if(!this.db)throw new Error("Database not initialized");const l=Date.now()-a;let c=0;const d=this.db.transaction([this.stores.images],"readwrite"),p=d.objectStore(this.stores.images).index("userId").openCursor(n);let y=await this.promisifyRequest(p);for(;y;){const b=y.value;b.createdAt<l&&b.status==="complete"&&(await this.promisifyRequest(y.delete()),c++);const x=y.continue();y=x?await this.promisifyRequest(x):null}return await this.promisifyTransaction(d),c}async exportData(n){const a=await this.getImages(n),l=await this.getUserSettings(),c=await this.getLastSync(),d={};return a.forEach(h=>{d[h.id]=h}),{images:d,userSettings:{default:l},lastSync:c,version:this.dbVersion}}async importData(n,a){const l=Object.values(a.images);await this.storeImages(n,l),a.userSettings.default&&await this.storeUserSettings(a.userSettings.default)}promisifyRequest(n){return new Promise((a,l)=>{n.onsuccess=()=>a(n.result),n.onerror=()=>l(n.error)})}promisifyTransaction(n){return new Promise((a,l)=>{n.oncomplete=()=>a(),n.onerror=()=>l(n.error)})}close(){this.db&&(this.db.close(),this.db=null)}}const sn=_a.getInstance();class Be{static COLLECTION_NAME="images";static PAGE_SIZE=20;static async uploadImage(n,a){return console.log("🔄 ImageService.uploadImage called with:",{fileName:n.name,userId:a}),await xn(async()=>{console.log("🔄 Starting upload process...");const l=Date.now(),c=`${l}_${n.name}`,d=`uploads/${a}/${l}/${c}`;console.log("📁 Storage path:",d),console.log("📁 Filename:",c);const h=xs(Wn,d);console.log("🔥 Starting Firebase Storage upload...");const g=await mr(Pm(h,n),6e4,`Upload timeout for file: ${c}`);console.log("✅ Firebase Storage upload complete:",g.ref.fullPath),console.log("🔗 Getting download URL...");const p=await vr(g.ref);console.log("🔗 Download URL obtained:",p);const y={filename:c,storagePath:g.ref.fullPath,downloadURL:p,status:"pending",candidates:[],selectedIndex:null,createdAt:l,updatedAt:l},b=Object.fromEntries(Object.entries(y).filter(([C,O])=>O!==void 0));console.log("🧹 Cleaned image data:",b);const x=`users/${a}/${Be.COLLECTION_NAME}`;console.log("📝 Creating Firestore document at:",x,"for user:",a),console.log("📄 Document data:",y);let _;try{console.log("🔥 Attempting to create Firestore document..."),console.log("🔥 Collection path:",x),console.log("🔥 Using db instance:",!!Oe);const C=await eg(Vt(Oe,"users",a,Be.COLLECTION_NAME),b);console.log("✅ Created Firestore document:",C.id,"at path:",C.path),console.log("🔍 Full document reference:",{id:C.id,path:C.path,parent:C.parent.path}),_={id:C.id,...y},console.log("🎉 Final imageDoc created:",_)}catch(C){throw console.error("❌ Firestore document creation FAILED:",C),console.error("❌ Error type:",C.constructor.name),console.error("❌ Error message:",C.message),console.error("❌ Error code:",C.code),console.error("❌ Error details:",C),C}try{await sn.storeImage(a,_)}catch(C){console.warn("Failed to store image offline:",C)}return _},"image-upload",{retryOptions:{maxRetries:3,baseDelay:1e3,onRetry:(l,c)=>{console.warn(`Upload retry attempt ${c} for ${n.name}:`,l.message)}},metadata:{filename:n.name,fileSize:n.size,userId:a}})}static async updateImage(n,a,l){return await xn(async()=>{const c={...l,updatedAt:Date.now()},d=Rt.getState();if(d.isOnline&&d.isConnected){const h=Ft(Oe,"users",a,Be.COLLECTION_NAME,n);await eu(h,c)}else Rt.queueOperation({type:"update",collection:"images",documentId:n,data:c,userId:a});try{await sn.updateImage(a,n,c)}catch(h){console.warn("Failed to update image offline:",h)}Je.delete(`images:${a}`),l.status&&["pending","processing","complete","error"].forEach(h=>{Je.delete(`images:${a}:status:${h}`)})},"image-update",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{imageId:n,userId:a,updateFields:Object.keys(l)}})}static async deleteImage(n,a){return await xn(async()=>{let l=!1,c=!1,d=null;try{if(d=(await this.getImages(a)).find(p=>p.id===n)||null,!d)throw new Error("Image document not found");const g=Rt.getState();if(g.isOnline&&g.isConnected){const p=Ft(Oe,"users",a,Be.COLLECTION_NAME,n);if(d.storagePath)try{const y=xs(Wn,d.storagePath);await mr(mu(y),3e4,"Storage deletion timeout"),l=!0}catch(y){if(y instanceof Error&&y.message.includes("object-not-found"))console.warn(`Storage file not found for image ${n}, continuing with Firestore deletion`),l=!0;else throw new Error(`Failed to delete storage file: ${y instanceof Error?y.message:"Unknown storage error"}`)}else l=!0;try{await tg(p),c=!0}catch(y){throw new Error(`Failed to delete Firestore document: ${y instanceof Error?y.message:"Unknown Firestore error"}`)}}else Rt.queueOperation({type:"delete",collection:"images",documentId:n,data:{storagePath:d.storagePath},userId:a}),c=!0;try{await sn.deleteImage(n)}catch(p){console.warn("Failed to delete image from offline storage:",p)}Je.delete(`images:${a}`),["pending","processing","complete","error"].forEach(p=>{Je.delete(`images:${a}:status:${p}`)})}catch(h){throw console.error("Error deleting image:",h),l&&!c&&d&&console.error(`Partial deletion detected for image ${n}: Storage deleted but Firestore deletion failed. Manual cleanup may be required.`),h}},"image-delete",{retryOptions:{maxRetries:2,baseDelay:1e3},metadata:{imageId:n,userId:a}})}static async getImages(n){const a=`images:${n}`,l=Je.get(a);if(l)return l;const c=Rt.getState();if(c.isOnline&&c.isConnected)return await xn(async()=>{const d=`users/${n}/${Be.COLLECTION_NAME}`;console.log("Fetching images from:",d,"for user:",n);const h=_n(Vt(Oe,"users",n,Be.COLLECTION_NAME),ga("createdAt","desc")),g=await ba(h);console.log("Found",g.docs.length,"documents in Firestore");const p=g.docs.map(y=>({id:y.id,...y.data()}));Je.set(a,p,300*1e3);try{await sn.storeImages(n,p)}catch(y){console.warn("Failed to update offline storage:",y)}return p},"images-fetch",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{userId:n}});try{await sn.initialize();const d=await sn.getImages(n);return Je.set(a,d,300*1e3),d}catch(d){return console.warn("Failed to fetch images from offline storage:",d),[]}}static async getImagesPaginated(n,a=Be.PAGE_SIZE,l){return await xn(async()=>{let c=_n(Vt(Oe,"users",n,Be.COLLECTION_NAME),ga("createdAt","desc"),Fv(a+1));l&&(c=_n(c,Vv(l)));const h=(await ba(c)).docs,g=h.length>a;return{images:h.slice(0,a).map(y=>({id:y.id,...y.data()})),lastDoc:g?h[a-1]:void 0,hasMore:g}},"images-fetch-paginated",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{userId:n,pageSize:a}})}static async getImagesByStatus(n,a){const l=`images:${n}:status:${a}`,c=Je.get(l);return c||await xn(async()=>{const d=_n(Vt(Oe,"users",n,Be.COLLECTION_NAME),Qv("status","==",a),ga("createdAt","desc")),g=(await ba(d)).docs.map(p=>({id:p.id,...p.data()}));return Je.set(l,g,120*1e3),g},"images-fetch-by-status",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{userId:n,status:a}})}static subscribeToImages(n,a,l){try{const c=`users/${n}/${Be.COLLECTION_NAME}`;console.log(`🔍 Setting up Firestore subscription for path: ${c}`);const d=_n(Vt(Oe,"users",n,Be.COLLECTION_NAME),ga("createdAt","desc"));return ng(d,h=>{try{console.log(`📊 Firestore subscription received ${h.docs.length} documents for user: ${n}`),h.docs.length===0&&(console.log("📭 No documents found. Checking if this is expected..."),console.log("🔍 Query metadata:",{fromCache:h.metadata.fromCache,hasPendingWrites:h.metadata.hasPendingWrites,isEqual:h.metadata.isEqual}));const g=h.docs.map(p=>{const y=p.data();return console.log(`📄 Document ${p.id}:`,y),{id:p.id,...y}});console.log(`✅ Processed ${g.length} images, calling callback`),a(g)}catch(g){console.error("Error processing subscription data:",g),l&&l(new Error(`Data processing error: ${g instanceof Error?g.message:"Unknown error"}`))}},h=>{console.error("❌ Error in images subscription:",h),l&&l(new Error(`Subscription error: ${h.message}`))})}catch(c){throw console.error("❌ Error setting up images subscription:",c),new Error(`Failed to subscribe to images: ${c instanceof Error?c.message:"Unknown error"}`)}}static async batchDeleteImages(n,a,l){return await Ib(n,async c=>(l?.(0,n.length,c),await this.deleteImage(c,a),c),"batch-delete-images",{concurrency:3,retryOptions:{maxRetries:2,baseDelay:1e3},metadata:{userId:a,totalImages:n.length}}).then(c=>(l?.(n.length,n.length,""),{successful:c.successful,failed:c.failed.map(d=>({imageId:d.item,error:d.error.message}))}))}static async withRetry(n,a=3,l=1e3){let c;for(let d=0;d<=a;d++)try{return await n()}catch(h){if(c=h instanceof Error?h:new Error("Unknown error"),d===a)break;const g=l*Math.pow(2,d)+Math.random()*1e3;await new Promise(p=>setTimeout(p,g))}throw c}static subscribeToImagesSimple(n,a){try{const l="images";console.log(`🔍 Setting up Firestore subscription for simple path: ${l}`);const c=_n(Vt(Oe,l),ga("createdAt","desc"));console.log("📡 Query created, setting up onSnapshot listener...");let d,h=!1;const g=ng(c,p=>{try{h=!0,d&&(clearTimeout(d),d=void 0),console.log(`📊 Firestore subscription received ${p.docs.length} documents from simple collection`),console.log("🔍 Query metadata:",{fromCache:p.metadata.fromCache,hasPendingWrites:p.metadata.hasPendingWrites,isEqual:p.metadata.isEqual}),p.docs.length===0&&console.log("📭 No documents found in simple collection. This might be expected for a new app.");const y=p.docs.map(b=>{const x=b.data();return console.log(`📄 Document ${b.id}:`,{id:b.id,filename:x.filename,status:x.status,createdAt:x.createdAt,candidates:x.candidates?.length||0}),{id:b.id,...x}});console.log(`✅ Processed ${y.length} images, calling callback`),n(y)}catch(y){console.error("❌ Error processing subscription data:",y),a&&a(new Error(`Data processing error: ${y instanceof Error?y.message:"Unknown error"}`))}},p=>{console.error("❌ Error in simple images subscription:",p),d&&(clearTimeout(d),d=void 0),a&&a(new Error(`Subscription error: ${p.message}`))});return()=>{d&&clearTimeout(d),g()}}catch(l){throw console.error("❌ Error setting up simple images subscription:",l),new Error(`Failed to subscribe to simple images: ${l instanceof Error?l.message:"Unknown error"}`)}}static async getImagesSimple(){const n="images:simple",a=Je.get(n);if(a)return a;const l=Rt.getState();return l.isOnline&&l.isConnected?await xn(async()=>{const c="images";console.log("Fetching images from simple collection:",c);const d=_n(Vt(Oe,c),ga("createdAt","desc")),h=await ba(d);console.log("Found",h.docs.length,"documents in simple collection");const g=h.docs.map(p=>({id:p.id,...p.data()}));return Je.set(n,g,300*1e3),g},"images-fetch-simple",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{collection:"images"}}):(console.log("Offline mode - returning empty array for simple collection"),[])}static async updateImageSimple(n,a,l){return await xn(async()=>{const c={...a,updatedAt:Date.now()};let d;l?(d=Ft(Oe,"users",l,"images",n),console.log(`🔄 Updating image ${n} in user collection: users/${l}/images`)):(d=Ft(Oe,"images",n),console.log(`🔄 Updating image ${n} in old collection: images`)),await eu(d,c),l?Je.delete(`images:${l}`):Je.delete("images:simple")},"image-update-simple",{retryOptions:{maxRetries:2,baseDelay:500},metadata:{imageId:n,updateFields:Object.keys(a),userId:l}})}static async deleteImageSimple(n,a){return await xn(async()=>{let l;a?(l=Ft(Oe,"users",a,"images",n),console.log(`🗑️ Deleting image ${n} from user collection: users/${a}/images`)):(l=Ft(Oe,"images",n),console.log(`🗑️ Deleting image ${n} from old collection: images`));const c=await sg(l);if(!c.exists())throw new Error("Image document not found");const d=c.data();if(d.storagePath)try{const h=xs(Wn,d.storagePath);await mr(mu(h),3e4,"Storage deletion timeout")}catch(h){if(h instanceof Error&&h.message.includes("object-not-found"))console.warn(`Storage file not found for image ${n}, continuing with Firestore deletion`);else throw new Error(`Failed to delete storage file: ${h instanceof Error?h.message:"Unknown storage error"}`)}await tg(l),a?Je.delete(`images:${a}`):Je.delete("images:simple")},"image-delete-simple",{retryOptions:{maxRetries:2,baseDelay:1e3},metadata:{imageId:n,userId:a}})}static async uploadImageSimple(n){console.log("🚀 Starting upload for file:",n.name,"Size:",n.size,"Type:",n.type);const a=Date.now(),l=`${a}_${n.name}`,c=`uploads/${a}/${l}`,d=xs(Wn,c);console.log("🔥 Uploading to Firebase Storage...");const h=await mr(Pm(d,n),6e4,`Upload timeout for file: ${l}`);console.log("✅ Storage upload complete:",h.ref.fullPath);const g=await vr(h.ref);console.log("🔗 Download URL:",g);const p={filename:l,storagePath:h.ref.fullPath,downloadURL:g,status:"pending",candidates:[],selectedIndex:null,createdAt:a,updatedAt:a};console.log("📝 Creating Firestore document with data:",p);try{const y=await eg(Vt(Oe,"images"),p);console.log("✅ Firestore document created with ID:",y.id);const b={id:y.id,...p};return Je.delete("images:simple"),console.log("🗑️ Cache invalidated"),b}catch(y){throw console.error("❌ Failed to create Firestore document:",y),y}}static async getImageById(n,a){try{let l;a?(l=Ft(Oe,"users",a,"images",n),console.log(`🔍 Looking for image ${n} in user collection: users/${a}/images`)):(l=Ft(Oe,"images",n),console.log(`🔍 Looking for image ${n} in old collection: images`));const c=await sg(l);if(c.exists()){const d={id:c.id,...c.data()};return console.log(`✅ Found image ${n} in ${l.path}`),d}return console.log(`❌ Image ${n} not found in ${l.path}`),null}catch(l){throw console.error("❌ Failed to get image by ID:",l),l}}static async updateImageCandidates(n,a,l){try{const c=a.map(h=>{const g={};return Object.keys(h).forEach(p=>{h[p]!==void 0&&(g[p]=h[p])}),g});let d;l?(d=Ft(Oe,"users",l,"images",n),console.log(`🔄 Updating candidates for image ${n} in user collection: users/${l}/images`)):(d=Ft(Oe,"images",n),console.log(`🔄 Updating candidates for image ${n} in old collection: images`)),await eu(d,{candidates:c,status:c.length>0?"complete":"pending",updatedAt:Date.now()}),l?Je.delete(`images:${l}`):Je.delete("images:simple"),console.log("✅ Updated image candidates for:",n)}catch(c){throw console.error("❌ Failed to update image candidates:",c),c}}}function Du({enabled:r=!0,sampleRate:n=.1,onMetrics:a}={}){const l=w.useRef(0),c=w.useRef(0),d=w.useRef([]),h=w.useCallback(()=>{!r||Math.random()>n||(l.current=performance.now())},[r,n]),g=w.useCallback((y=0)=>{if(!r||l.current===0)return;const b=performance.now()-l.current;l.current=0;let x;"memory"in performance&&(x=performance.memory.usedJSHeapSize);const _={renderTime:b,memoryUsage:x,imageCount:y,timestamp:Date.now()};d.current.push(_),(d.current.length>=10||Math.abs(y-c.current)>5)&&p(),c.current=y},[r]),p=w.useCallback(()=>{if(d.current.length===0)return;const y=[...d.current];d.current=[];const b=y.reduce((L,V)=>L+V.renderTime,0)/y.length,x=Math.max(...y.map(L=>L.renderTime)),_=y[y.length-1].memoryUsage,C=y[y.length-1].imageCount,O={renderTime:b,memoryUsage:_,imageCount:C,timestamp:Date.now()};a?.(O),x>100&&console.warn(`Slow render detected: ${x.toFixed(2)}ms`),_&&_>100*1024*1024&&console.warn(`High memory usage detected: ${(_/1024/1024).toFixed(2)}MB`)},[a]);return w.useEffect(()=>()=>{p()},[p]),{startMeasurement:h,endMeasurement:g,flushMetrics:p}}function Gb(){const r=w.useRef(new Map),n=w.useCallback(c=>{r.current.set(c,performance.now())},[]),a=w.useCallback((c,d=!0)=>{const h=r.current.get(c);if(!h)return;const g=performance.now()-h;return r.current.delete(c),console.log(`Caption generation for ${c}: ${g.toFixed(2)}ms (${d?"success":"failed"})`),g>1e4&&console.warn(`Slow caption generation: ${g.toFixed(2)}ms for image ${c}`),g},[]),l=w.useCallback(()=>r.current.size,[]);return{startCaptionGeneration:n,endCaptionGeneration:a,getActiveRequestCount:l}}function Yb(){const r=w.useRef(new Map),n=w.useCallback((l,c)=>{r.current.set(l,{startTime:performance.now(),fileSize:c})},[]),a=w.useCallback((l,c=!0)=>{const d=r.current.get(l);if(!d)return;const h=performance.now()-d.startTime,g=d.fileSize/(h/1e3);return r.current.delete(l),console.log(`Upload ${l}: ${h.toFixed(2)}ms, ${(g/1024).toFixed(2)} KB/s (${c?"success":"failed"})`),g<50*1024&&console.warn(`Slow upload detected: ${(g/1024).toFixed(2)} KB/s for file ${l}`),{duration:h,throughput:g}},[]);return{startUpload:n,endUpload:a}}var mg={};const gg="@firebase/database",pg="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a0="";function Fb(r){a0=r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(n){this.domStorage_=n,this.prefix_="firebase:"}set(n,a){a==null?this.domStorage_.removeItem(this.prefixedName_(n)):this.domStorage_.setItem(this.prefixedName_(n),it(a))}get(n){const a=this.domStorage_.getItem(this.prefixedName_(n));return a==null?null:Ru(a)}remove(n){this.domStorage_.removeItem(this.prefixedName_(n))}prefixedName_(n){return this.prefix_+n}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(n,a){a==null?delete this.cache_[n]:this.cache_[n]=a}get(n){return Cn(this.cache_,n)?this.cache_[n]:null}remove(n){delete this.cache_[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i0=function(r){try{if(typeof window<"u"&&typeof window[r]<"u"){const n=window[r];return n.setItem("firebase:sentinel","cache"),n.removeItem("firebase:sentinel"),new Vb(n)}}catch{}return new Qb},_s=i0("localStorage"),Xb=i0("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new Xv("@firebase/database"),$b=(function(){let r=1;return function(){return r++}})(),l0=function(r){const n=Zv(r),a=new Wv;a.update(n);const l=a.digest();return Jv.encodeByteArray(l)},Vi=function(...r){let n="";for(let a=0;a<r.length;a++){const l=r[a];Array.isArray(l)||l&&typeof l=="object"&&typeof l.length=="number"?n+=Vi.apply(null,l):typeof l=="object"?n+=it(l):n+=l,n+=" "}return n};let zi=null,yg=!0;const Kb=function(r,n){X(!0,"Can't turn on custom loggers persistently."),Ca.logLevel=tb.VERBOSE,zi=Ca.log.bind(Ca)},ot=function(...r){if(yg===!0&&(yg=!1,zi===null&&Xb.get("logging_enabled")===!0&&Kb()),zi){const n=Vi.apply(null,r);zi(n)}},Qi=function(r){return function(...n){ot(r,...n)}},gu=function(...r){const n="FIREBASE INTERNAL ERROR: "+Vi(...r);Ca.error(n)},ws=function(...r){const n=`FIREBASE FATAL ERROR: ${Vi(...r)}`;throw Ca.error(n),new Error(n)},Dt=function(...r){const n="FIREBASE WARNING: "+Vi(...r);Ca.warn(n)},Zb=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Dt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},r0=function(r){return typeof r=="number"&&(r!==r||r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY)},Wb=function(r){if(document.readyState==="complete")r();else{let n=!1;const a=function(){if(!document.body){setTimeout(a,Math.floor(10));return}n||(n=!0,r())};document.addEventListener?(document.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&a()}),window.attachEvent("onload",a))}},Ra="[MIN_NAME]",Ss="[MAX_NAME]",Da=function(r,n){if(r===n)return 0;if(r===Ra||n===Ss)return-1;if(n===Ra||r===Ss)return 1;{const a=vg(r),l=vg(n);return a!==null?l!==null?a-l===0?r.length-n.length:a-l:-1:l!==null?1:r<n?-1:1}},Jb=function(r,n){return r===n?0:r<n?-1:1},Mi=function(r,n){if(n&&r in n)return n[r];throw new Error("Missing required key ("+r+") in object: "+it(n))},ju=function(r){if(typeof r!="object"||r===null)return it(r);const n=[];for(const l in r)n.push(l);n.sort();let a="{";for(let l=0;l<n.length;l++)l!==0&&(a+=","),a+=it(n[l]),a+=":",a+=ju(r[n[l]]);return a+="}",a},o0=function(r,n){const a=r.length;if(a<=n)return[r];const l=[];for(let c=0;c<a;c+=n)c+n>a?l.push(r.substring(c,a)):l.push(r.substring(c,c+n));return l};function jt(r,n){for(const a in r)r.hasOwnProperty(a)&&n(a,r[a])}const c0=function(r){X(!r0(r),"Invalid JSON number");const n=11,a=52,l=(1<<n-1)-1;let c,d,h,g,p;r===0?(d=0,h=0,c=1/r===-1/0?1:0):(c=r<0,r=Math.abs(r),r>=Math.pow(2,1-l)?(g=Math.min(Math.floor(Math.log(r)/Math.LN2),l),d=g+l,h=Math.round(r*Math.pow(2,a-g)-Math.pow(2,a))):(d=0,h=Math.round(r/Math.pow(2,1-l-a))));const y=[];for(p=a;p;p-=1)y.push(h%2?1:0),h=Math.floor(h/2);for(p=n;p;p-=1)y.push(d%2?1:0),d=Math.floor(d/2);y.push(c?1:0),y.reverse();const b=y.join("");let x="";for(p=0;p<64;p+=8){let _=parseInt(b.substr(p,8),2).toString(16);_.length===1&&(_="0"+_),x=x+_}return x.toLowerCase()},Pb=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},ex=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function tx(r,n){let a="Unknown Error";r==="too_big"?a="The data requested exceeds the maximum size that can be accessed with a single request.":r==="permission_denied"?a="Client doesn't have permission to access the desired data.":r==="unavailable"&&(a="The service is unavailable");const l=new Error(r+" at "+n._path.toString()+": "+a);return l.code=r.toUpperCase(),l}const nx=new RegExp("^-?(0*)\\d{1,10}$"),sx=-2147483648,ax=2147483647,vg=function(r){if(nx.test(r)){const n=Number(r);if(n>=sx&&n<=ax)return n}return null},Xi=function(r){try{r()}catch(n){setTimeout(()=>{const a=n.stack||"";throw Dt("Exception was thrown by user callback.",a),n},Math.floor(0))}},ix=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Bi=function(r,n){const a=setTimeout(r,n);return typeof a=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(a):typeof a=="object"&&a.unref&&a.unref(),a};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(n,a){this.appCheckProvider=a,this.appName=n.name,eb(n)&&n.settings.appCheckToken&&(this.serverAppAppCheckToken=n.settings.appCheckToken),this.appCheck=a?.getImmediate({optional:!0}),this.appCheck||a?.get().then(l=>this.appCheck=l)}getToken(n){if(this.serverAppAppCheckToken){if(n)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(n):new Promise((a,l)=>{setTimeout(()=>{this.appCheck?this.getToken(n).then(a,l):a(null)},0)})}addTokenChangeListener(n){this.appCheckProvider?.get().then(a=>a.addTokenListener(n))}notifyForInvalidToken(){Dt(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(n,a,l){this.appName_=n,this.firebaseOptions_=a,this.authProvider_=l,this.auth_=null,this.auth_=l.getImmediate({optional:!0}),this.auth_||l.onInit(c=>this.auth_=c)}getToken(n){return this.auth_?this.auth_.getToken(n).catch(a=>a&&a.code==="auth/token-not-initialized"?(ot("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(a)):new Promise((a,l)=>{setTimeout(()=>{this.auth_?this.getToken(n).then(a,l):a(null)},0)})}addTokenChangeListener(n){this.auth_?this.auth_.addAuthTokenListener(n):this.authProvider_.get().then(a=>a.addAuthTokenListener(n))}removeTokenChangeListener(n){this.authProvider_.get().then(a=>a.removeAuthTokenListener(n))}notifyForInvalidToken(){let n='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?n+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?n+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':n+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Dt(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mu="5",u0="v",d0="s",f0="r",h0="f",m0=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,g0="ls",p0="p",pu="ac",y0="websocket",v0="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(n,a,l,c,d=!1,h="",g=!1,p=!1,y=null){this.secure=a,this.namespace=l,this.webSocketOnly=c,this.nodeAdmin=d,this.persistenceKey=h,this.includeNamespaceInQueryParams=g,this.isUsingEmulator=p,this.emulatorOptions=y,this._host=n.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=_s.get("host:"+n)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(n){n!==this.internalHost&&(this.internalHost=n,this.isCacheableHost()&&_s.set("host:"+this._host,this.internalHost))}toString(){let n=this.toURLString();return this.persistenceKey&&(n+="<"+this.persistenceKey+">"),n}toURLString(){const n=this.secure?"https://":"http://",a=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${n}${this.host}/${a}`}}function cx(r){return r.host!==r.internalHost||r.isCustomHost()||r.includeNamespaceInQueryParams}function b0(r,n,a){X(typeof n=="string","typeof type must == string"),X(typeof a=="object","typeof params must == object");let l;if(n===y0)l=(r.secure?"wss://":"ws://")+r.internalHost+"/.ws?";else if(n===v0)l=(r.secure?"https://":"http://")+r.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+n);cx(r)&&(a.ns=r.namespace);const c=[];return jt(a,(d,h)=>{c.push(d+"="+h)}),l+c.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(){this.counters_={}}incrementCounter(n,a=1){Cn(this.counters_,n)||(this.counters_[n]=0),this.counters_[n]+=a}get(){return rb(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iu={},lu={};function Ou(r){const n=r.toString();return iu[n]||(iu[n]=new ux),iu[n]}function dx(r,n){const a=r.toString();return lu[a]||(lu[a]=n()),lu[a]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(n){this.onMessage_=n,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(n,a){this.closeAfterResponse=n,this.onClose=a,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(n,a){for(this.pendingResponses[n]=a;this.pendingResponses[this.currentResponseNum];){const l=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let c=0;c<l.length;++c)l[c]&&Xi(()=>{this.onMessage_(l[c])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bg="start",hx="close",mx="pLPCommand",gx="pRTLPCB",x0="id",_0="pw",w0="ser",px="cb",yx="seg",vx="ts",bx="d",xx="dframe",S0=1870,E0=30,_x=S0-E0,wx=25e3,Sx=3e4;class wa{constructor(n,a,l,c,d,h,g){this.connId=n,this.repoInfo=a,this.applicationId=l,this.appCheckToken=c,this.authToken=d,this.transportSessionId=h,this.lastSessionId=g,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qi(n),this.stats_=Ou(a),this.urlFn=p=>(this.appCheckToken&&(p[pu]=this.appCheckToken),b0(a,v0,p))}open(n,a){this.curSegmentNum=0,this.onDisconnect_=a,this.myPacketOrderer=new fx(n),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Sx)),Wb(()=>{if(this.isClosed_)return;this.scriptTagHolder=new ku((...d)=>{const[h,g,p,y,b]=d;if(this.incrementIncomingBytes_(d),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,h===bg)this.id=g,this.password=p;else if(h===hx)g?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(g,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+h)},(...d)=>{const[h,g]=d;this.incrementIncomingBytes_(d),this.myPacketOrderer.handleResponse(h,g)},()=>{this.onClosed_()},this.urlFn);const l={};l[bg]="t",l[w0]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(l[px]=this.scriptTagHolder.uniqueCallbackIdentifier),l[u0]=Mu,this.transportSessionId&&(l[d0]=this.transportSessionId),this.lastSessionId&&(l[g0]=this.lastSessionId),this.applicationId&&(l[p0]=this.applicationId),this.appCheckToken&&(l[pu]=this.appCheckToken),typeof location<"u"&&location.hostname&&m0.test(location.hostname)&&(l[f0]=h0);const c=this.urlFn(l);this.log_("Connecting via long-poll to "+c),this.scriptTagHolder.addTag(c,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){wa.forceAllow_=!0}static forceDisallow(){wa.forceDisallow_=!0}static isAvailable(){return wa.forceAllow_?!0:!wa.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Pb()&&!ex()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(n){const a=it(n);this.bytesSent+=a.length,this.stats_.incrementCounter("bytes_sent",a.length);const l=ob(a),c=o0(l,_x);for(let d=0;d<c.length;d++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,c.length,c[d]),this.curSegmentNum++}addDisconnectPingFrame(n,a){this.myDisconnFrame=document.createElement("iframe");const l={};l[xx]="t",l[x0]=n,l[_0]=a,this.myDisconnFrame.src=this.urlFn(l),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(n){const a=it(n).length;this.bytesReceived+=a,this.stats_.incrementCounter("bytes_received",a)}}class ku{constructor(n,a,l,c){this.onDisconnect=l,this.urlFn=c,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=$b(),window[mx+this.uniqueCallbackIdentifier]=n,window[gx+this.uniqueCallbackIdentifier]=a,this.myIFrame=ku.createIFrame_();let d="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(d='<script>document.domain="'+document.domain+'";<\/script>');const h="<html><body>"+d+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(h),this.myIFrame.doc.close()}catch(g){ot("frame writing exception"),g.stack&&ot(g.stack),ot(g)}}}static createIFrame_(){const n=document.createElement("iframe");if(n.style.display="none",document.body){document.body.appendChild(n);try{n.contentWindow.document||ot("No IE domain setting required")}catch{const l=document.domain;n.src="javascript:void((function(){document.open();document.domain='"+l+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return n.contentDocument?n.doc=n.contentDocument:n.contentWindow?n.doc=n.contentWindow.document:n.document&&(n.doc=n.document),n}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const n=this.onDisconnect;n&&(this.onDisconnect=null,n())}startLongPoll(n,a){for(this.myID=n,this.myPW=a,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const n={};n[x0]=this.myID,n[_0]=this.myPW,n[w0]=this.currentSerial;let a=this.urlFn(n),l="",c=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+E0+l.length<=S0;){const h=this.pendingSegs.shift();l=l+"&"+yx+c+"="+h.seg+"&"+vx+c+"="+h.ts+"&"+bx+c+"="+h.d,c++}return a=a+l,this.addLongPollTag_(a,this.currentSerial),!0}else return!1}enqueueSegment(n,a,l){this.pendingSegs.push({seg:n,ts:a,d:l}),this.alive&&this.newRequest_()}addLongPollTag_(n,a){this.outstandingRequests.add(a);const l=()=>{this.outstandingRequests.delete(a),this.newRequest_()},c=setTimeout(l,Math.floor(wx)),d=()=>{clearTimeout(c),l()};this.addTag(n,d)}addTag(n,a){setTimeout(()=>{try{if(!this.sendNewPolls)return;const l=this.myIFrame.doc.createElement("script");l.type="text/javascript",l.async=!0,l.src=n,l.onload=l.onreadystatechange=function(){const c=l.readyState;(!c||c==="loaded"||c==="complete")&&(l.onload=l.onreadystatechange=null,l.parentNode&&l.parentNode.removeChild(l),a())},l.onerror=()=>{ot("Long-poll script failed to load: "+n),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(l)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ex=16384,Cx=45e3;let _r=null;typeof MozWebSocket<"u"?_r=MozWebSocket:typeof WebSocket<"u"&&(_r=WebSocket);class Qt{constructor(n,a,l,c,d,h,g){this.connId=n,this.applicationId=l,this.appCheckToken=c,this.authToken=d,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qi(this.connId),this.stats_=Ou(a),this.connURL=Qt.connectionURL_(a,h,g,c,l),this.nodeAdmin=a.nodeAdmin}static connectionURL_(n,a,l,c,d){const h={};return h[u0]=Mu,typeof location<"u"&&location.hostname&&m0.test(location.hostname)&&(h[f0]=h0),a&&(h[d0]=a),l&&(h[g0]=l),c&&(h[pu]=c),d&&(h[p0]=d),b0(n,y0,h)}open(n,a){this.onDisconnect=a,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,_s.set("previous_websocket_failure",!0);try{let l;cb(),this.mySock=new _r(this.connURL,[],l)}catch(l){this.log_("Error instantiating WebSocket.");const c=l.message||l.data;c&&this.log_(c),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=l=>{this.handleIncomingFrame(l)},this.mySock.onerror=l=>{this.log_("WebSocket error.  Closing connection.");const c=l.message||l.data;c&&this.log_(c),this.onClosed_()}}start(){}static forceDisallow(){Qt.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){const a=/Android ([0-9]{0,}\.[0-9]{0,})/,l=navigator.userAgent.match(a);l&&l.length>1&&parseFloat(l[1])<4.4&&(n=!0)}return!n&&_r!==null&&!Qt.forceDisallow_}static previouslyFailed(){return _s.isInMemoryStorage||_s.get("previous_websocket_failure")===!0}markConnectionHealthy(){_s.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){const a=this.frames.join("");this.frames=null;const l=Ru(a);this.onMessage(l)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(X(this.frames===null,"We already have a frame buffer"),n.length<=6){const a=Number(n);if(!isNaN(a))return this.handleNewFrameCount_(a),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;const a=n.data;if(this.bytesReceived+=a.length,this.stats_.incrementCounter("bytes_received",a.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(a);else{const l=this.extractFrameCount_(a);l!==null&&this.appendFrame_(l)}}send(n){this.resetKeepAlive();const a=it(n);this.bytesSent+=a.length,this.stats_.incrementCounter("bytes_sent",a.length);const l=o0(a,Ex);l.length>1&&this.sendString_(String(l.length));for(let c=0;c<l.length;c++)this.sendString_(l[c])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Cx))}sendString_(n){try{this.mySock.send(n)}catch(a){this.log_("Exception thrown from WebSocket.send():",a.message||a.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Qt.responsesRequiredToBeHealthy=2;Qt.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii{static get ALL_TRANSPORTS(){return[wa,Qt]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(n){this.initTransports_(n)}initTransports_(n){const a=Qt&&Qt.isAvailable();let l=a&&!Qt.previouslyFailed();if(n.webSocketOnly&&(a||Dt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),l=!0),l)this.transports_=[Qt];else{const c=this.transports_=[];for(const d of Ii.ALL_TRANSPORTS)d&&d.isAvailable()&&c.push(d);Ii.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ii.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=6e4,Tx=5e3,Rx=10*1024,Ax=100*1024,ru="t",xg="d",Dx="s",_g="r",jx="e",wg="o",Sg="a",Eg="n",Cg="p",Mx="h";class Ox{constructor(n,a,l,c,d,h,g,p,y,b){this.id=n,this.repoInfo_=a,this.applicationId_=l,this.appCheckToken_=c,this.authToken_=d,this.onMessage_=h,this.onReady_=g,this.onDisconnect_=p,this.onKill_=y,this.lastSessionId=b,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qi("c:"+this.id+":"),this.transportManager_=new Ii(a),this.log_("Connection created"),this.start_()}start_(){const n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const a=this.connReceiver_(this.conn_),l=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(a,l)},Math.floor(0));const c=n.healthyTimeout||0;c>0&&(this.healthyTimeout_=Bi(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Ax?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Rx?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(c)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(n){return a=>{n===this.conn_?this.onConnectionLost_(a):n===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(n){return a=>{this.state_!==2&&(n===this.rx_?this.onPrimaryMessageReceived_(a):n===this.secondaryConn_?this.onSecondaryMessageReceived_(a):this.log_("message on old connection"))}}sendRequest(n){const a={t:"d",d:n};this.sendData_(a)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(n){if(ru in n){const a=n[ru];a===Sg?this.upgradeIfSecondaryHealthy_():a===_g?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):a===wg&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(n){const a=Mi("t",n),l=Mi("d",n);if(a==="c")this.onSecondaryControl_(l);else if(a==="d")this.pendingDataMessages.push(l);else throw new Error("Unknown protocol layer: "+a)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Cg,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Sg,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Eg,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(n){const a=Mi("t",n),l=Mi("d",n);a==="c"?this.onControl_(l):a==="d"&&this.onDataMessage_(l)}onDataMessage_(n){this.onPrimaryResponse_(),this.onMessage_(n)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(n){const a=Mi(ru,n);if(xg in n){const l=n[xg];if(a===Mx){const c={...l};this.repoInfo_.isUsingEmulator&&(c.h=this.repoInfo_.host),this.onHandshake_(c)}else if(a===Eg){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let c=0;c<this.pendingDataMessages.length;++c)this.onDataMessage_(this.pendingDataMessages[c]);this.pendingDataMessages=[],this.tryCleanupConnection()}else a===Dx?this.onConnectionShutdown_(l):a===_g?this.onReset_(l):a===jx?gu("Server Error: "+l):a===wg?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):gu("Unknown control packet command: "+a)}}onHandshake_(n){const a=n.ts,l=n.v,c=n.h;this.sessionId=n.s,this.repoInfo_.host=c,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,a),Mu!==l&&Dt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const n=this.transportManager_.upgradeTransport();n&&this.startUpgrade_(n)}startUpgrade_(n){this.secondaryConn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;const a=this.connReceiver_(this.secondaryConn_),l=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(a,l),Bi(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Nx))}onReset_(n){this.log_("Reset packet received.  New host: "+n),this.repoInfo_.host=n,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(n,a){this.log_("Realtime connection established."),this.conn_=n,this.state_=1,this.onReady_&&(this.onReady_(a,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Bi(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Tx))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Cg,d:{}}}))}onSecondaryConnectionLost_(){const n=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===n||this.rx_===n)&&this.close()}onConnectionLost_(n){this.conn_=null,!n&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(_s.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(n){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(n),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(n){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(n)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C0{put(n,a,l,c){}merge(n,a,l,c){}refreshAuthToken(n){}refreshAppCheckToken(n){}onDisconnectPut(n,a,l){}onDisconnectMerge(n,a,l){}onDisconnectCancel(n,a){}reportStats(n){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(n){this.allowedEvents_=n,this.listeners_={},X(Array.isArray(n)&&n.length>0,"Requires a non-empty array")}trigger(n,...a){if(Array.isArray(this.listeners_[n])){const l=[...this.listeners_[n]];for(let c=0;c<l.length;c++)l[c].callback.apply(l[c].context,a)}}on(n,a,l){this.validateEventType_(n),this.listeners_[n]=this.listeners_[n]||[],this.listeners_[n].push({callback:a,context:l});const c=this.getInitialEvent(n);c&&a.apply(l,c)}off(n,a,l){this.validateEventType_(n);const c=this.listeners_[n]||[];for(let d=0;d<c.length;d++)if(c[d].callback===a&&(!l||l===c[d].context)){c.splice(d,1);return}}validateEventType_(n){X(this.allowedEvents_.find(a=>a===n),"Unknown event: "+n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr extends N0{static getInstance(){return new wr}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!e0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(n){return X(n==="online","Unknown event type: "+n),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ng=32,Tg=768;class je{constructor(n,a){if(a===void 0){this.pieces_=n.split("/");let l=0;for(let c=0;c<this.pieces_.length;c++)this.pieces_[c].length>0&&(this.pieces_[l]=this.pieces_[c],l++);this.pieces_.length=l,this.pieceNum_=0}else this.pieces_=n,this.pieceNum_=a}toString(){let n="";for(let a=this.pieceNum_;a<this.pieces_.length;a++)this.pieces_[a]!==""&&(n+="/"+this.pieces_[a]);return n||"/"}}function _e(){return new je("")}function fe(r){return r.pieceNum_>=r.pieces_.length?null:r.pieces_[r.pieceNum_]}function es(r){return r.pieces_.length-r.pieceNum_}function Re(r){let n=r.pieceNum_;return n<r.pieces_.length&&n++,new je(r.pieces_,n)}function T0(r){return r.pieceNum_<r.pieces_.length?r.pieces_[r.pieces_.length-1]:null}function kx(r){let n="";for(let a=r.pieceNum_;a<r.pieces_.length;a++)r.pieces_[a]!==""&&(n+="/"+encodeURIComponent(String(r.pieces_[a])));return n||"/"}function R0(r,n=0){return r.pieces_.slice(r.pieceNum_+n)}function A0(r){if(r.pieceNum_>=r.pieces_.length)return null;const n=[];for(let a=r.pieceNum_;a<r.pieces_.length-1;a++)n.push(r.pieces_[a]);return new je(n,0)}function tt(r,n){const a=[];for(let l=r.pieceNum_;l<r.pieces_.length;l++)a.push(r.pieces_[l]);if(n instanceof je)for(let l=n.pieceNum_;l<n.pieces_.length;l++)a.push(n.pieces_[l]);else{const l=n.split("/");for(let c=0;c<l.length;c++)l[c].length>0&&a.push(l[c])}return new je(a,0)}function de(r){return r.pieceNum_>=r.pieces_.length}function At(r,n){const a=fe(r),l=fe(n);if(a===null)return n;if(a===l)return At(Re(r),Re(n));throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+r+")")}function Uu(r,n){if(es(r)!==es(n))return!1;for(let a=r.pieceNum_,l=n.pieceNum_;a<=r.pieces_.length;a++,l++)if(r.pieces_[a]!==n.pieces_[l])return!1;return!0}function Xt(r,n){let a=r.pieceNum_,l=n.pieceNum_;if(es(r)>es(n))return!1;for(;a<r.pieces_.length;){if(r.pieces_[a]!==n.pieces_[l])return!1;++a,++l}return!0}class Ux{constructor(n,a){this.errorPrefix_=a,this.parts_=R0(n,0),this.byteLength_=Math.max(1,this.parts_.length);for(let l=0;l<this.parts_.length;l++)this.byteLength_+=Or(this.parts_[l]);D0(this)}}function Lx(r,n){r.parts_.length>0&&(r.byteLength_+=1),r.parts_.push(n),r.byteLength_+=Or(n),D0(r)}function zx(r){const n=r.parts_.pop();r.byteLength_-=Or(n),r.parts_.length>0&&(r.byteLength_-=1)}function D0(r){if(r.byteLength_>Tg)throw new Error(r.errorPrefix_+"has a key path longer than "+Tg+" bytes ("+r.byteLength_+").");if(r.parts_.length>Ng)throw new Error(r.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ng+") or object contains a cycle "+bs(r))}function bs(r){return r.parts_.length===0?"":"in property '"+r.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu extends N0{static getInstance(){return new Lu}constructor(){super(["visible"]);let n,a;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(a="visibilitychange",n="hidden"):typeof document.mozHidden<"u"?(a="mozvisibilitychange",n="mozHidden"):typeof document.msHidden<"u"?(a="msvisibilitychange",n="msHidden"):typeof document.webkitHidden<"u"&&(a="webkitvisibilitychange",n="webkitHidden")),this.visible_=!0,a&&document.addEventListener(a,()=>{const l=!document[n];l!==this.visible_&&(this.visible_=l,this.trigger("visible",l))},!1)}getInitialEvent(n){return X(n==="visible","Unknown event type: "+n),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=1e3,Bx=300*1e3,Rg=30*1e3,qx=1.3,Hx=3e4,Ix="server_kill",Ag=3;class En extends C0{constructor(n,a,l,c,d,h,g,p){if(super(),this.repoInfo_=n,this.applicationId_=a,this.onDataUpdate_=l,this.onConnectStatus_=c,this.onServerInfoUpdate_=d,this.authTokenProvider_=h,this.appCheckTokenProvider_=g,this.authOverride_=p,this.id=En.nextPersistentConnectionId_++,this.log_=Qi("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Oi,this.maxReconnectDelay_=Bx,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,p)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Lu.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&wr.getInstance().on("online",this.onOnline_,this)}sendRequest(n,a,l){const c=++this.requestNumber_,d={r:c,a:n,b:a};this.log_(it(d)),X(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(d),l&&(this.requestCBHash_[c]=l)}get(n){this.initConnection_();const a=new Pg,c={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:h=>{const g=h.d;h.s==="ok"?a.resolve(g):a.reject(g)}};this.outstandingGets_.push(c),this.outstandingGetCount_++;const d=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(d),a.promise}listen(n,a,l,c){this.initConnection_();const d=n._queryIdentifier,h=n._path.toString();this.log_("Listen called for "+h+" "+d),this.listens.has(h)||this.listens.set(h,new Map),X(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),X(!this.listens.get(h).has(d),"listen() called twice for same path/queryId.");const g={onComplete:c,hashFn:a,query:n,tag:l};this.listens.get(h).set(d,g),this.connected_&&this.sendListen_(g)}sendGet_(n){const a=this.outstandingGets_[n];this.sendRequest("g",a.request,l=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),a.onComplete&&a.onComplete(l)})}sendListen_(n){const a=n.query,l=a._path.toString(),c=a._queryIdentifier;this.log_("Listen on "+l+" for "+c);const d={p:l},h="q";n.tag&&(d.q=a._queryObject,d.t=n.tag),d.h=n.hashFn(),this.sendRequest(h,d,g=>{const p=g.d,y=g.s;En.warnOnListenWarnings_(p,a),(this.listens.get(l)&&this.listens.get(l).get(c))===n&&(this.log_("listen response",g),y!=="ok"&&this.removeListen_(l,c),n.onComplete&&n.onComplete(y,p))})}static warnOnListenWarnings_(n,a){if(n&&typeof n=="object"&&Cn(n,"w")){const l=Ta(n,"w");if(Array.isArray(l)&&~l.indexOf("no_index")){const c='".indexOn": "'+a._queryParams.getIndex().toString()+'"',d=a._path.toString();Dt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${c} at ${d} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||sb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Rg)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const n=this.authToken_,a=ab(n)?"auth":"gauth",l={cred:n};this.authOverride_===null?l.noauth=!0:typeof this.authOverride_=="object"&&(l.authvar=this.authOverride_),this.sendRequest(a,l,c=>{const d=c.s,h=c.d||"error";this.authToken_===n&&(d==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(d,h))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{const a=n.s,l=n.d||"error";a==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(a,l)})}unlisten(n,a){const l=n._path.toString(),c=n._queryIdentifier;this.log_("Unlisten called for "+l+" "+c),X(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(l,c)&&this.connected_&&this.sendUnlisten_(l,c,n._queryObject,a)}sendUnlisten_(n,a,l,c){this.log_("Unlisten on "+n+" for "+a);const d={p:n},h="n";c&&(d.q=l,d.t=c),this.sendRequest(h,d)}onDisconnectPut(n,a,l){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,a,l):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:a,onComplete:l})}onDisconnectMerge(n,a,l){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,a,l):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:a,onComplete:l})}onDisconnectCancel(n,a){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,a):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:a})}sendOnDisconnect_(n,a,l,c){const d={p:a,d:l};this.log_("onDisconnect "+n,d),this.sendRequest(n,d,h=>{c&&setTimeout(()=>{c(h.s,h.d)},Math.floor(0))})}put(n,a,l,c){this.putInternal("p",n,a,l,c)}merge(n,a,l,c){this.putInternal("m",n,a,l,c)}putInternal(n,a,l,c,d){this.initConnection_();const h={p:a,d:l};d!==void 0&&(h.h=d),this.outstandingPuts_.push({action:n,request:h,onComplete:c}),this.outstandingPutCount_++;const g=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(g):this.log_("Buffering put: "+a)}sendPut_(n){const a=this.outstandingPuts_[n].action,l=this.outstandingPuts_[n].request,c=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(a,l,d=>{this.log_(a+" response",d),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),c&&c(d.s,d.d)})}reportStats(n){if(this.connected_){const a={c:n};this.log_("reportStats",a),this.sendRequest("s",a,l=>{if(l.s!=="ok"){const d=l.d;this.log_("reportStats","Error sending stats: "+d)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+it(n));const a=n.r,l=this.requestCBHash_[a];l&&(delete this.requestCBHash_[a],l(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,a){this.log_("handleServerMessage",n,a),n==="d"?this.onDataUpdate_(a.p,a.d,!1,a.t):n==="m"?this.onDataUpdate_(a.p,a.d,!0,a.t):n==="c"?this.onListenRevoked_(a.p,a.q):n==="ac"?this.onAuthRevoked_(a.s,a.d):n==="apc"?this.onAppCheckRevoked_(a.s,a.d):n==="sd"?this.onSecurityDebugPacket_(a):gu("Unrecognized action received from server: "+it(n)+`
Are you using the latest client?`)}onReady_(n,a){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=a,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){X(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Oi,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Oi,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>Hx&&(this.reconnectDelay_=Oi),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const n=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let a=Math.max(0,this.reconnectDelay_-n);a=Math.random()*a,this.log_("Trying to reconnect in "+a+"ms"),this.scheduleConnect_(a),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qx)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const n=this.onDataMessage_.bind(this),a=this.onReady_.bind(this),l=this.onRealtimeDisconnect_.bind(this),c=this.id+":"+En.nextConnectionId_++,d=this.lastSessionId;let h=!1,g=null;const p=function(){g?g.close():(h=!0,l())},y=function(x){X(g,"sendRequest call when we're not connected not allowed."),g.sendRequest(x)};this.realtime_={close:p,sendRequest:y};const b=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[x,_]=await Promise.all([this.authTokenProvider_.getToken(b),this.appCheckTokenProvider_.getToken(b)]);h?ot("getToken() completed but was canceled"):(ot("getToken() completed. Creating connection."),this.authToken_=x&&x.accessToken,this.appCheckToken_=_&&_.token,g=new Ox(c,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,a,l,C=>{Dt(C+" ("+this.repoInfo_.toString()+")"),this.interrupt(Ix)},d))}catch(x){this.log_("Failed to get token: "+x),h||(this.repoInfo_.nodeAdmin&&Dt(x),p())}}}interrupt(n){ot("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){ot("Resuming connection for reason: "+n),delete this.interruptReasons_[n],ig(this.interruptReasons_)&&(this.reconnectDelay_=Oi,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){const a=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:a})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){const a=this.outstandingPuts_[n];a&&"h"in a.request&&a.queued&&(a.onComplete&&a.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,a){let l;a?l=a.map(d=>ju(d)).join("$"):l="default";const c=this.removeListen_(n,l);c&&c.onComplete&&c.onComplete("permission_denied")}removeListen_(n,a){const l=new je(n).toString();let c;if(this.listens.has(l)){const d=this.listens.get(l);c=d.get(a),d.delete(a),d.size===0&&this.listens.delete(l)}else c=void 0;return c}onAuthRevoked_(n,a){ot("Auth token revoked: "+n+"/"+a),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Ag&&(this.reconnectDelay_=Rg,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,a){ot("App check token revoked: "+n+"/"+a),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Ag&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const n of this.listens.values())for(const a of n.values())this.sendListen_(a);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){const n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){const n={};let a="js";n["sdk."+a+"."+a0.replace(/\./g,"-")]=1,e0()?n["framework.cordova"]=1:ib()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){const n=wr.getInstance().currentlyOnline();return ig(this.interruptReasons_)&&n}}En.nextPersistentConnectionId_=0;En.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(n,a){this.name=n,this.node=a}static Wrap(n,a){return new me(n,a)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{getCompare(){return this.compare.bind(this)}indexedValueChanged(n,a){const l=new me(Ra,n),c=new me(Ra,a);return this.compare(l,c)!==0}minPost(){return me.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gr;class j0 extends kr{static get __EMPTY_NODE(){return gr}static set __EMPTY_NODE(n){gr=n}compare(n,a){return Da(n.name,a.name)}isDefinedOn(n){throw Fi("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(n,a){return!1}minPost(){return me.MIN}maxPost(){return new me(Ss,gr)}makePost(n,a){return X(typeof n=="string","KeyIndex indexValue must always be a string."),new me(n,gr)}toString(){return".key"}}const Na=new j0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(n,a,l,c,d=null){this.isReverse_=c,this.resultGenerator_=d,this.nodeStack_=[];let h=1;for(;!n.isEmpty();)if(n=n,h=a?l(n.key,a):1,c&&(h*=-1),h<0)this.isReverse_?n=n.left:n=n.right;else if(h===0){this.nodeStack_.push(n);break}else this.nodeStack_.push(n),this.isReverse_?n=n.right:n=n.left}getNext(){if(this.nodeStack_.length===0)return null;let n=this.nodeStack_.pop(),a;if(this.resultGenerator_?a=this.resultGenerator_(n.key,n.value):a={key:n.key,value:n.value},this.isReverse_)for(n=n.left;!n.isEmpty();)this.nodeStack_.push(n),n=n.right;else for(n=n.right;!n.isEmpty();)this.nodeStack_.push(n),n=n.left;return a}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const n=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(n.key,n.value):{key:n.key,value:n.value}}}class et{constructor(n,a,l,c,d){this.key=n,this.value=a,this.color=l??et.RED,this.left=c??vt.EMPTY_NODE,this.right=d??vt.EMPTY_NODE}copy(n,a,l,c,d){return new et(n??this.key,a??this.value,l??this.color,c??this.left,d??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,a,l){let c=this;const d=l(n,c.key);return d<0?c=c.copy(null,null,null,c.left.insert(n,a,l),null):d===0?c=c.copy(null,a,null,null,null):c=c.copy(null,null,null,null,c.right.insert(n,a,l)),c.fixUp_()}removeMin_(){if(this.left.isEmpty())return vt.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,a){let l,c;if(l=this,a(n,l.key)<0)!l.left.isEmpty()&&!l.left.isRed_()&&!l.left.left.isRed_()&&(l=l.moveRedLeft_()),l=l.copy(null,null,null,l.left.remove(n,a),null);else{if(l.left.isRed_()&&(l=l.rotateRight_()),!l.right.isEmpty()&&!l.right.isRed_()&&!l.right.left.isRed_()&&(l=l.moveRedRight_()),a(n,l.key)===0){if(l.right.isEmpty())return vt.EMPTY_NODE;c=l.right.min_(),l=l.copy(c.key,c.value,null,null,l.right.removeMin_())}l=l.copy(null,null,null,null,l.right.remove(n,a))}return l.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){const n=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){const n=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){const n=this.left.copy(null,null,!this.left.color,null,null),a=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,a)}checkMaxDepth_(){const n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}et.RED=!0;et.BLACK=!1;class Gx{copy(n,a,l,c,d){return this}insert(n,a,l){return new et(n,a,null)}remove(n,a){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class vt{constructor(n,a=vt.EMPTY_NODE){this.comparator_=n,this.root_=a}insert(n,a){return new vt(this.comparator_,this.root_.insert(n,a,this.comparator_).copy(null,null,et.BLACK,null,null))}remove(n){return new vt(this.comparator_,this.root_.remove(n,this.comparator_).copy(null,null,et.BLACK,null,null))}get(n){let a,l=this.root_;for(;!l.isEmpty();){if(a=this.comparator_(n,l.key),a===0)return l.value;a<0?l=l.left:a>0&&(l=l.right)}return null}getPredecessorKey(n){let a,l=this.root_,c=null;for(;!l.isEmpty();)if(a=this.comparator_(n,l.key),a===0){if(l.left.isEmpty())return c?c.key:null;for(l=l.left;!l.right.isEmpty();)l=l.right;return l.key}else a<0?l=l.left:a>0&&(c=l,l=l.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(n){return this.root_.inorderTraversal(n)}reverseTraversal(n){return this.root_.reverseTraversal(n)}getIterator(n){return new pr(this.root_,null,this.comparator_,!1,n)}getIteratorFrom(n,a){return new pr(this.root_,n,this.comparator_,!1,a)}getReverseIteratorFrom(n,a){return new pr(this.root_,n,this.comparator_,!0,a)}getReverseIterator(n){return new pr(this.root_,null,this.comparator_,!0,n)}}vt.EMPTY_NODE=new Gx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yx(r,n){return Da(r.name,n.name)}function zu(r,n){return Da(r,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yu;function Fx(r){yu=r}const M0=function(r){return typeof r=="number"?"number:"+c0(r):"string:"+r},O0=function(r){if(r.isLeafNode()){const n=r.val();X(typeof n=="string"||typeof n=="number"||typeof n=="object"&&Cn(n,".sv"),"Priority must be a string or number.")}else X(r===yu||r.isEmpty(),"priority of unexpected type.");X(r===yu||r.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dg;class Pe{static set __childrenNodeConstructor(n){Dg=n}static get __childrenNodeConstructor(){return Dg}constructor(n,a=Pe.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=a,this.lazyHash_=null,X(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),O0(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new Pe(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return de(n)?this:fe(n)===".priority"?this.priorityNode_:Pe.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,a){return null}updateImmediateChild(n,a){return n===".priority"?this.updatePriority(a):a.isEmpty()&&n!==".priority"?this:Pe.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,a).updatePriority(this.priorityNode_)}updateChild(n,a){const l=fe(n);return l===null?a:a.isEmpty()&&l!==".priority"?this:(X(l!==".priority"||es(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(l,Pe.__childrenNodeConstructor.EMPTY_NODE.updateChild(Re(n),a)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,a){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+M0(this.priorityNode_.val())+":");const a=typeof this.value_;n+=a+":",a==="number"?n+=c0(this.value_):n+=this.value_,this.lazyHash_=l0(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===Pe.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof Pe.__childrenNodeConstructor?-1:(X(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){const a=typeof n.value_,l=typeof this.value_,c=Pe.VALUE_TYPE_ORDER.indexOf(a),d=Pe.VALUE_TYPE_ORDER.indexOf(l);return X(c>=0,"Unknown leaf type: "+a),X(d>=0,"Unknown leaf type: "+l),c===d?l==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:d-c}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){const a=n;return this.value_===a.value_&&this.priorityNode_.equals(a.priorityNode_)}else return!1}}Pe.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let k0,U0;function Vx(r){k0=r}function Qx(r){U0=r}class Xx extends kr{compare(n,a){const l=n.node.getPriority(),c=a.node.getPriority(),d=l.compareTo(c);return d===0?Da(n.name,a.name):d}isDefinedOn(n){return!n.getPriority().isEmpty()}indexedValueChanged(n,a){return!n.getPriority().equals(a.getPriority())}minPost(){return me.MIN}maxPost(){return new me(Ss,new Pe("[PRIORITY-POST]",U0))}makePost(n,a){const l=k0(n);return new me(a,new Pe("[PRIORITY-POST]",l))}toString(){return".priority"}}const ut=new Xx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=Math.log(2);class Kx{constructor(n){const a=d=>parseInt(Math.log(d)/$x,10),l=d=>parseInt(Array(d+1).join("1"),2);this.count=a(n+1),this.current_=this.count-1;const c=l(this.count);this.bits_=n+1&c}nextBitIsOne(){const n=!(this.bits_&1<<this.current_);return this.current_--,n}}const Sr=function(r,n,a,l){r.sort(n);const c=function(p,y){const b=y-p;let x,_;if(b===0)return null;if(b===1)return x=r[p],_=a?a(x):x,new et(_,x.node,et.BLACK,null,null);{const C=parseInt(b/2,10)+p,O=c(p,C),L=c(C+1,y);return x=r[C],_=a?a(x):x,new et(_,x.node,et.BLACK,O,L)}},d=function(p){let y=null,b=null,x=r.length;const _=function(O,L){const V=x-O,K=x;x-=O;const P=c(V+1,K),U=r[V],I=a?a(U):U;C(new et(I,U.node,L,null,P))},C=function(O){y?(y.left=O,y=O):(b=O,y=O)};for(let O=0;O<p.count;++O){const L=p.nextBitIsOne(),V=Math.pow(2,p.count-(O+1));L?_(V,et.BLACK):(_(V,et.BLACK),_(V,et.RED))}return b},h=new Kx(r.length),g=d(h);return new vt(l||n,g)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ou;const pa={};class Sn{static get Default(){return X(pa&&ut,"ChildrenNode.ts has not been loaded"),ou=ou||new Sn({".priority":pa},{".priority":ut}),ou}constructor(n,a){this.indexes_=n,this.indexSet_=a}get(n){const a=Ta(this.indexes_,n);if(!a)throw new Error("No index defined for "+n);return a instanceof vt?a:null}hasIndex(n){return Cn(this.indexSet_,n.toString())}addIndex(n,a){X(n!==Na,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const l=[];let c=!1;const d=a.getIterator(me.Wrap);let h=d.getNext();for(;h;)c=c||n.isDefinedOn(h.node),l.push(h),h=d.getNext();let g;c?g=Sr(l,n.getCompare()):g=pa;const p=n.toString(),y={...this.indexSet_};y[p]=n;const b={...this.indexes_};return b[p]=g,new Sn(b,y)}addToIndexes(n,a){const l=br(this.indexes_,(c,d)=>{const h=Ta(this.indexSet_,d);if(X(h,"Missing index implementation for "+d),c===pa)if(h.isDefinedOn(n.node)){const g=[],p=a.getIterator(me.Wrap);let y=p.getNext();for(;y;)y.name!==n.name&&g.push(y),y=p.getNext();return g.push(n),Sr(g,h.getCompare())}else return pa;else{const g=a.get(n.name);let p=c;return g&&(p=p.remove(new me(n.name,g))),p.insert(n,n.node)}});return new Sn(l,this.indexSet_)}removeFromIndexes(n,a){const l=br(this.indexes_,c=>{if(c===pa)return c;{const d=a.get(n.name);return d?c.remove(new me(n.name,d)):c}});return new Sn(l,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki;class ye{static get EMPTY_NODE(){return ki||(ki=new ye(new vt(zu),null,Sn.Default))}constructor(n,a,l){this.children_=n,this.priorityNode_=a,this.indexMap_=l,this.lazyHash_=null,this.priorityNode_&&O0(this.priorityNode_),this.children_.isEmpty()&&X(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ki}updatePriority(n){return this.children_.isEmpty()?this:new ye(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{const a=this.children_.get(n);return a===null?ki:a}}getChild(n){const a=fe(n);return a===null?this:this.getImmediateChild(a).getChild(Re(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,a){if(X(a,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(a);{const l=new me(n,a);let c,d;a.isEmpty()?(c=this.children_.remove(n),d=this.indexMap_.removeFromIndexes(l,this.children_)):(c=this.children_.insert(n,a),d=this.indexMap_.addToIndexes(l,this.children_));const h=c.isEmpty()?ki:this.priorityNode_;return new ye(c,h,d)}}updateChild(n,a){const l=fe(n);if(l===null)return a;{X(fe(n)!==".priority"||es(n)===1,".priority must be the last token in a path");const c=this.getImmediateChild(l).updateChild(Re(n),a);return this.updateImmediateChild(l,c)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;const a={};let l=0,c=0,d=!0;if(this.forEachChild(ut,(h,g)=>{a[h]=g.val(n),l++,d&&ye.INTEGER_REGEXP_.test(h)?c=Math.max(c,Number(h)):d=!1}),!n&&d&&c<2*l){const h=[];for(const g in a)h[g]=a[g];return h}else return n&&!this.getPriority().isEmpty()&&(a[".priority"]=this.getPriority().val()),a}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+M0(this.getPriority().val())+":"),this.forEachChild(ut,(a,l)=>{const c=l.hash();c!==""&&(n+=":"+a+":"+c)}),this.lazyHash_=n===""?"":l0(n)}return this.lazyHash_}getPredecessorChildName(n,a,l){const c=this.resolveIndex_(l);if(c){const d=c.getPredecessorKey(new me(n,a));return d?d.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){const a=this.resolveIndex_(n);if(a){const l=a.minKey();return l&&l.name}else return this.children_.minKey()}getFirstChild(n){const a=this.getFirstChildName(n);return a?new me(a,this.children_.get(a)):null}getLastChildName(n){const a=this.resolveIndex_(n);if(a){const l=a.maxKey();return l&&l.name}else return this.children_.maxKey()}getLastChild(n){const a=this.getLastChildName(n);return a?new me(a,this.children_.get(a)):null}forEachChild(n,a){const l=this.resolveIndex_(n);return l?l.inorderTraversal(c=>a(c.name,c.node)):this.children_.inorderTraversal(a)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,a){const l=this.resolveIndex_(a);if(l)return l.getIteratorFrom(n,c=>c);{const c=this.children_.getIteratorFrom(n.name,me.Wrap);let d=c.peek();for(;d!=null&&a.compare(d,n)<0;)c.getNext(),d=c.peek();return c}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,a){const l=this.resolveIndex_(a);if(l)return l.getReverseIteratorFrom(n,c=>c);{const c=this.children_.getReverseIteratorFrom(n.name,me.Wrap);let d=c.peek();for(;d!=null&&a.compare(d,n)>0;)c.getNext(),d=c.peek();return c}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===$i?-1:0}withIndex(n){if(n===Na||this.indexMap_.hasIndex(n))return this;{const a=this.indexMap_.addIndex(n,this.children_);return new ye(this.children_,this.priorityNode_,a)}}isIndexed(n){return n===Na||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{const a=n;if(this.getPriority().equals(a.getPriority()))if(this.children_.count()===a.children_.count()){const l=this.getIterator(ut),c=a.getIterator(ut);let d=l.getNext(),h=c.getNext();for(;d&&h;){if(d.name!==h.name||!d.node.equals(h.node))return!1;d=l.getNext(),h=c.getNext()}return d===null&&h===null}else return!1;else return!1}}resolveIndex_(n){return n===Na?null:this.indexMap_.get(n.toString())}}ye.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Zx extends ye{constructor(){super(new vt(zu),ye.EMPTY_NODE,Sn.Default)}compareTo(n){return n===this?0:1}equals(n){return n===this}getPriority(){return this}getImmediateChild(n){return ye.EMPTY_NODE}isEmpty(){return!1}}const $i=new Zx;Object.defineProperties(me,{MIN:{value:new me(Ra,ye.EMPTY_NODE)},MAX:{value:new me(Ss,$i)}});j0.__EMPTY_NODE=ye.EMPTY_NODE;Pe.__childrenNodeConstructor=ye;Fx($i);Qx($i);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wx=!0;function ct(r,n=null){if(r===null)return ye.EMPTY_NODE;if(typeof r=="object"&&".priority"in r&&(n=r[".priority"]),X(n===null||typeof n=="string"||typeof n=="number"||typeof n=="object"&&".sv"in n,"Invalid priority type found: "+typeof n),typeof r=="object"&&".value"in r&&r[".value"]!==null&&(r=r[".value"]),typeof r!="object"||".sv"in r){const a=r;return new Pe(a,ct(n))}if(!(r instanceof Array)&&Wx){const a=[];let l=!1;if(jt(r,(h,g)=>{if(h.substring(0,1)!=="."){const p=ct(g);p.isEmpty()||(l=l||!p.getPriority().isEmpty(),a.push(new me(h,p)))}}),a.length===0)return ye.EMPTY_NODE;const d=Sr(a,Yx,h=>h.name,zu);if(l){const h=Sr(a,ut.getCompare());return new ye(d,ct(n),new Sn({".priority":h},{".priority":ut}))}else return new ye(d,ct(n),Sn.Default)}else{let a=ye.EMPTY_NODE;return jt(r,(l,c)=>{if(Cn(r,l)&&l.substring(0,1)!=="."){const d=ct(c);(d.isLeafNode()||!d.isEmpty())&&(a=a.updateImmediateChild(l,d))}}),a.updatePriority(ct(n))}}Vx(ct);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx extends kr{constructor(n){super(),this.indexPath_=n,X(!de(n)&&fe(n)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(n){return n.getChild(this.indexPath_)}isDefinedOn(n){return!n.getChild(this.indexPath_).isEmpty()}compare(n,a){const l=this.extractChild(n.node),c=this.extractChild(a.node),d=l.compareTo(c);return d===0?Da(n.name,a.name):d}makePost(n,a){const l=ct(n),c=ye.EMPTY_NODE.updateChild(this.indexPath_,l);return new me(a,c)}maxPost(){const n=ye.EMPTY_NODE.updateChild(this.indexPath_,$i);return new me(Ss,n)}toString(){return R0(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Px extends kr{compare(n,a){const l=n.node.compareTo(a.node);return l===0?Da(n.name,a.name):l}isDefinedOn(n){return!0}indexedValueChanged(n,a){return!n.equals(a)}minPost(){return me.MIN}maxPost(){return me.MAX}makePost(n,a){const l=ct(n);return new me(a,l)}toString(){return".value"}}const e_=new Px;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(r){return{type:"value",snapshotNode:r}}function n_(r,n){return{type:"child_added",snapshotNode:n,childName:r}}function s_(r,n){return{type:"child_removed",snapshotNode:n,childName:r}}function jg(r,n,a){return{type:"child_changed",snapshotNode:n,childName:r,oldSnap:a}}function a_(r,n){return{type:"child_moved",snapshotNode:n,childName:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bu{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ut}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return X(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return X(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ra}hasEnd(){return this.endSet_}getIndexEndValue(){return X(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return X(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ss}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return X(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ut}copy(){const n=new Bu;return n.limitSet_=this.limitSet_,n.limit_=this.limit_,n.startSet_=this.startSet_,n.startAfterSet_=this.startAfterSet_,n.indexStartValue_=this.indexStartValue_,n.startNameSet_=this.startNameSet_,n.indexStartName_=this.indexStartName_,n.endSet_=this.endSet_,n.endBeforeSet_=this.endBeforeSet_,n.indexEndValue_=this.indexEndValue_,n.endNameSet_=this.endNameSet_,n.indexEndName_=this.indexEndName_,n.index_=this.index_,n.viewFrom_=this.viewFrom_,n}}function Mg(r){const n={};if(r.isDefault())return n;let a;if(r.index_===ut?a="$priority":r.index_===e_?a="$value":r.index_===Na?a="$key":(X(r.index_ instanceof Jx,"Unrecognized index type!"),a=r.index_.toString()),n.orderBy=it(a),r.startSet_){const l=r.startAfterSet_?"startAfter":"startAt";n[l]=it(r.indexStartValue_),r.startNameSet_&&(n[l]+=","+it(r.indexStartName_))}if(r.endSet_){const l=r.endBeforeSet_?"endBefore":"endAt";n[l]=it(r.indexEndValue_),r.endNameSet_&&(n[l]+=","+it(r.indexEndName_))}return r.limitSet_&&(r.isViewFromLeft()?n.limitToFirst=r.limit_:n.limitToLast=r.limit_),n}function Og(r){const n={};if(r.startSet_&&(n.sp=r.indexStartValue_,r.startNameSet_&&(n.sn=r.indexStartName_),n.sin=!r.startAfterSet_),r.endSet_&&(n.ep=r.indexEndValue_,r.endNameSet_&&(n.en=r.indexEndName_),n.ein=!r.endBeforeSet_),r.limitSet_){n.l=r.limit_;let a=r.viewFrom_;a===""&&(r.isViewFromLeft()?a="l":a="r"),n.vf=a}return r.index_!==ut&&(n.i=r.index_.toString()),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er extends C0{reportStats(n){throw new Error("Method not implemented.")}static getListenId_(n,a){return a!==void 0?"tag$"+a:(X(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())}constructor(n,a,l,c){super(),this.repoInfo_=n,this.onDataUpdate_=a,this.authTokenProvider_=l,this.appCheckTokenProvider_=c,this.log_=Qi("p:rest:"),this.listens_={}}listen(n,a,l,c){const d=n._path.toString();this.log_("Listen called for "+d+" "+n._queryIdentifier);const h=Er.getListenId_(n,l),g={};this.listens_[h]=g;const p=Mg(n._queryParams);this.restRequest_(d+".json",p,(y,b)=>{let x=b;if(y===404&&(x=null,y=null),y===null&&this.onDataUpdate_(d,x,!1,l),Ta(this.listens_,h)===g){let _;y?y===401?_="permission_denied":_="rest_error:"+y:_="ok",c(_,null)}})}unlisten(n,a){const l=Er.getListenId_(n,a);delete this.listens_[l]}get(n){const a=Mg(n._queryParams),l=n._path.toString(),c=new Pg;return this.restRequest_(l+".json",a,(d,h)=>{let g=h;d===404&&(g=null,d=null),d===null?(this.onDataUpdate_(l,g,!1,null),c.resolve(g)):c.reject(new Error(g))}),c.promise}refreshAuthToken(n){}restRequest_(n,a={},l){return a.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([c,d])=>{c&&c.accessToken&&(a.auth=c.accessToken),d&&d.token&&(a.ac=d.token);const h=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+n+"?ns="+this.repoInfo_.namespace+nb(a);this.log_("Sending REST request for "+h);const g=new XMLHttpRequest;g.onreadystatechange=()=>{if(l&&g.readyState===4){this.log_("REST Response for "+h+" received. status:",g.status,"response:",g.responseText);let p=null;if(g.status>=200&&g.status<300){try{p=Ru(g.responseText)}catch{Dt("Failed to parse JSON response for "+h+": "+g.responseText)}l(null,p)}else g.status!==401&&g.status!==404&&Dt("Got unsuccessful REST response for "+h+" Status: "+g.status),l(g.status);l=null}},g.open("GET",h,!0),g.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(){this.rootNode_=ye.EMPTY_NODE}getNode(n){return this.rootNode_.getChild(n)}updateSnapshot(n,a){this.rootNode_=this.rootNode_.updateChild(n,a)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(){return{value:null,children:new Map}}function L0(r,n,a){if(de(n))r.value=a,r.children.clear();else if(r.value!==null)r.value=r.value.updateChild(n,a);else{const l=fe(n);r.children.has(l)||r.children.set(l,Cr());const c=r.children.get(l);n=Re(n),L0(c,n,a)}}function vu(r,n,a){r.value!==null?a(n,r.value):l_(r,(l,c)=>{const d=new je(n.toString()+"/"+l);vu(c,d,a)})}function l_(r,n){r.children.forEach((a,l)=>{n(l,a)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(n){this.collection_=n,this.last_=null}get(){const n=this.collection_.get(),a={...n};return this.last_&&jt(this.last_,(l,c)=>{a[l]=a[l]-c}),this.last_=n,a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg=10*1e3,o_=30*1e3,c_=300*1e3;class u_{constructor(n,a){this.server_=a,this.statsToReport_={},this.statsListener_=new r_(n);const l=kg+(o_-kg)*Math.random();Bi(this.reportStats_.bind(this),Math.floor(l))}reportStats_(){const n=this.statsListener_.get(),a={};let l=!1;jt(n,(c,d)=>{d>0&&Cn(this.statsToReport_,c)&&(a[c]=d,l=!0)}),l&&this.server_.reportStats(a),Bi(this.reportStats_.bind(this),Math.floor(Math.random()*2*c_))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t;(function(r){r[r.OVERWRITE=0]="OVERWRITE",r[r.MERGE=1]="MERGE",r[r.ACK_USER_WRITE=2]="ACK_USER_WRITE",r[r.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})($t||($t={}));function z0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function qu(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Hu(r){return{fromUser:!1,fromServer:!0,queryId:r,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(n,a,l){this.path=n,this.affectedTree=a,this.revert=l,this.type=$t.ACK_USER_WRITE,this.source=z0()}operationForChild(n){if(de(this.path)){if(this.affectedTree.value!=null)return X(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const a=this.affectedTree.subtree(new je(n));return new Nr(_e(),a,this.revert)}}else return X(fe(this.path)===n,"operationForChild called for unrelated child."),new Nr(Re(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(n,a){this.source=n,this.path=a,this.type=$t.LISTEN_COMPLETE}operationForChild(n){return de(this.path)?new Gi(this.source,_e()):new Gi(this.source,Re(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(n,a,l){this.source=n,this.path=a,this.snap=l,this.type=$t.OVERWRITE}operationForChild(n){return de(this.path)?new Es(this.source,_e(),this.snap.getImmediateChild(n)):new Es(this.source,Re(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(n,a,l){this.source=n,this.path=a,this.children=l,this.type=$t.MERGE}operationForChild(n){if(de(this.path)){const a=this.children.subtree(new je(n));return a.isEmpty()?null:a.value?new Es(this.source,_e(),a.value):new Yi(this.source,_e(),a)}else return X(fe(this.path)===n,"Can't get a merge for a child not on the path of the operation"),new Yi(this.source,Re(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(n,a,l){this.node_=n,this.fullyInitialized_=a,this.filtered_=l}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(n){if(de(n))return this.isFullyInitialized()&&!this.filtered_;const a=fe(n);return this.isCompleteForChild(a)}isCompleteForChild(n){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(n)}getNode(){return this.node_}}function d_(r,n,a,l){const c=[],d=[];return n.forEach(h=>{h.type==="child_changed"&&r.index_.indexedValueChanged(h.oldSnap,h.snapshotNode)&&d.push(a_(h.childName,h.snapshotNode))}),Ui(r,c,"child_removed",n,l,a),Ui(r,c,"child_added",n,l,a),Ui(r,c,"child_moved",d,l,a),Ui(r,c,"child_changed",n,l,a),Ui(r,c,"value",n,l,a),c}function Ui(r,n,a,l,c,d){const h=l.filter(g=>g.type===a);h.sort((g,p)=>h_(r,g,p)),h.forEach(g=>{const p=f_(r,g,d);c.forEach(y=>{y.respondsTo(g.type)&&n.push(y.createEvent(p,r.query_))})})}function f_(r,n,a){return n.type==="value"||n.type==="child_removed"||(n.prevName=a.getPredecessorChildName(n.childName,n.snapshotNode,r.index_)),n}function h_(r,n,a){if(n.childName==null||a.childName==null)throw Fi("Should only compare child_ events.");const l=new me(n.childName,n.snapshotNode),c=new me(a.childName,a.snapshotNode);return r.index_.compare(l,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(r,n){return{eventCache:r,serverCache:n}}function qi(r,n,a,l){return B0(new Iu(n,a,l),r.serverCache)}function q0(r,n,a,l){return B0(r.eventCache,new Iu(n,a,l))}function bu(r){return r.eventCache.isFullyInitialized()?r.eventCache.getNode():null}function Cs(r){return r.serverCache.isFullyInitialized()?r.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cu;const m_=()=>(cu||(cu=new vt(Jb)),cu);class De{static fromObject(n){let a=new De(null);return jt(n,(l,c)=>{a=a.set(new je(l),c)}),a}constructor(n,a=m_()){this.value=n,this.children=a}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(n,a){if(this.value!=null&&a(this.value))return{path:_e(),value:this.value};if(de(n))return null;{const l=fe(n),c=this.children.get(l);if(c!==null){const d=c.findRootMostMatchingPathAndValue(Re(n),a);return d!=null?{path:tt(new je(l),d.path),value:d.value}:null}else return null}}findRootMostValueAndPath(n){return this.findRootMostMatchingPathAndValue(n,()=>!0)}subtree(n){if(de(n))return this;{const a=fe(n),l=this.children.get(a);return l!==null?l.subtree(Re(n)):new De(null)}}set(n,a){if(de(n))return new De(a,this.children);{const l=fe(n),d=(this.children.get(l)||new De(null)).set(Re(n),a),h=this.children.insert(l,d);return new De(this.value,h)}}remove(n){if(de(n))return this.children.isEmpty()?new De(null):new De(null,this.children);{const a=fe(n),l=this.children.get(a);if(l){const c=l.remove(Re(n));let d;return c.isEmpty()?d=this.children.remove(a):d=this.children.insert(a,c),this.value===null&&d.isEmpty()?new De(null):new De(this.value,d)}else return this}}get(n){if(de(n))return this.value;{const a=fe(n),l=this.children.get(a);return l?l.get(Re(n)):null}}setTree(n,a){if(de(n))return a;{const l=fe(n),d=(this.children.get(l)||new De(null)).setTree(Re(n),a);let h;return d.isEmpty()?h=this.children.remove(l):h=this.children.insert(l,d),new De(this.value,h)}}fold(n){return this.fold_(_e(),n)}fold_(n,a){const l={};return this.children.inorderTraversal((c,d)=>{l[c]=d.fold_(tt(n,c),a)}),a(n,this.value,l)}findOnPath(n,a){return this.findOnPath_(n,_e(),a)}findOnPath_(n,a,l){const c=this.value?l(a,this.value):!1;if(c)return c;if(de(n))return null;{const d=fe(n),h=this.children.get(d);return h?h.findOnPath_(Re(n),tt(a,d),l):null}}foreachOnPath(n,a){return this.foreachOnPath_(n,_e(),a)}foreachOnPath_(n,a,l){if(de(n))return this;{this.value&&l(a,this.value);const c=fe(n),d=this.children.get(c);return d?d.foreachOnPath_(Re(n),tt(a,c),l):new De(null)}}foreach(n){this.foreach_(_e(),n)}foreach_(n,a){this.children.inorderTraversal((l,c)=>{c.foreach_(tt(n,l),a)}),this.value&&a(n,this.value)}foreachChild(n){this.children.inorderTraversal((a,l)=>{l.value&&n(a,l.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(n){this.writeTree_=n}static empty(){return new Kt(new De(null))}}function Hi(r,n,a){if(de(n))return new Kt(new De(a));{const l=r.writeTree_.findRootMostValueAndPath(n);if(l!=null){const c=l.path;let d=l.value;const h=At(c,n);return d=d.updateChild(h,a),new Kt(r.writeTree_.set(c,d))}else{const c=new De(a),d=r.writeTree_.setTree(n,c);return new Kt(d)}}}function Ug(r,n,a){let l=r;return jt(a,(c,d)=>{l=Hi(l,tt(n,c),d)}),l}function Lg(r,n){if(de(n))return Kt.empty();{const a=r.writeTree_.setTree(n,new De(null));return new Kt(a)}}function xu(r,n){return Ns(r,n)!=null}function Ns(r,n){const a=r.writeTree_.findRootMostValueAndPath(n);return a!=null?r.writeTree_.get(a.path).getChild(At(a.path,n)):null}function zg(r){const n=[],a=r.writeTree_.value;return a!=null?a.isLeafNode()||a.forEachChild(ut,(l,c)=>{n.push(new me(l,c))}):r.writeTree_.children.inorderTraversal((l,c)=>{c.value!=null&&n.push(new me(l,c.value))}),n}function Pn(r,n){if(de(n))return r;{const a=Ns(r,n);return a!=null?new Kt(new De(a)):new Kt(r.writeTree_.subtree(n))}}function _u(r){return r.writeTree_.isEmpty()}function Aa(r,n){return H0(_e(),r.writeTree_,n)}function H0(r,n,a){if(n.value!=null)return a.updateChild(r,n.value);{let l=null;return n.children.inorderTraversal((c,d)=>{c===".priority"?(X(d.value!==null,"Priority writes must always be leaf nodes"),l=d.value):a=H0(tt(r,c),d,a)}),!a.getChild(r).isEmpty()&&l!==null&&(a=a.updateChild(tt(r,".priority"),l)),a}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(r,n){return Q0(n,r)}function g_(r,n,a,l,c){X(l>r.lastWriteId,"Stacking an older write on top of newer ones"),c===void 0&&(c=!0),r.allWrites.push({path:n,snap:a,writeId:l,visible:c}),c&&(r.visibleWrites=Hi(r.visibleWrites,n,a)),r.lastWriteId=l}function p_(r,n){for(let a=0;a<r.allWrites.length;a++){const l=r.allWrites[a];if(l.writeId===n)return l}return null}function y_(r,n){const a=r.allWrites.findIndex(g=>g.writeId===n);X(a>=0,"removeWrite called with nonexistent writeId.");const l=r.allWrites[a];r.allWrites.splice(a,1);let c=l.visible,d=!1,h=r.allWrites.length-1;for(;c&&h>=0;){const g=r.allWrites[h];g.visible&&(h>=a&&v_(g,l.path)?c=!1:Xt(l.path,g.path)&&(d=!0)),h--}if(c){if(d)return b_(r),!0;if(l.snap)r.visibleWrites=Lg(r.visibleWrites,l.path);else{const g=l.children;jt(g,p=>{r.visibleWrites=Lg(r.visibleWrites,tt(l.path,p))})}return!0}else return!1}function v_(r,n){if(r.snap)return Xt(r.path,n);for(const a in r.children)if(r.children.hasOwnProperty(a)&&Xt(tt(r.path,a),n))return!0;return!1}function b_(r){r.visibleWrites=G0(r.allWrites,x_,_e()),r.allWrites.length>0?r.lastWriteId=r.allWrites[r.allWrites.length-1].writeId:r.lastWriteId=-1}function x_(r){return r.visible}function G0(r,n,a){let l=Kt.empty();for(let c=0;c<r.length;++c){const d=r[c];if(n(d)){const h=d.path;let g;if(d.snap)Xt(a,h)?(g=At(a,h),l=Hi(l,g,d.snap)):Xt(h,a)&&(g=At(h,a),l=Hi(l,_e(),d.snap.getChild(g)));else if(d.children){if(Xt(a,h))g=At(a,h),l=Ug(l,g,d.children);else if(Xt(h,a))if(g=At(h,a),de(g))l=Ug(l,_e(),d.children);else{const p=Ta(d.children,fe(g));if(p){const y=p.getChild(Re(g));l=Hi(l,_e(),y)}}}else throw Fi("WriteRecord should have .snap or .children")}}return l}function Y0(r,n,a,l,c){if(!l&&!c){const d=Ns(r.visibleWrites,n);if(d!=null)return d;{const h=Pn(r.visibleWrites,n);if(_u(h))return a;if(a==null&&!xu(h,_e()))return null;{const g=a||ye.EMPTY_NODE;return Aa(h,g)}}}else{const d=Pn(r.visibleWrites,n);if(!c&&_u(d))return a;if(!c&&a==null&&!xu(d,_e()))return null;{const h=function(y){return(y.visible||c)&&(!l||!~l.indexOf(y.writeId))&&(Xt(y.path,n)||Xt(n,y.path))},g=G0(r.allWrites,h,n),p=a||ye.EMPTY_NODE;return Aa(g,p)}}}function __(r,n,a){let l=ye.EMPTY_NODE;const c=Ns(r.visibleWrites,n);if(c)return c.isLeafNode()||c.forEachChild(ut,(d,h)=>{l=l.updateImmediateChild(d,h)}),l;if(a){const d=Pn(r.visibleWrites,n);return a.forEachChild(ut,(h,g)=>{const p=Aa(Pn(d,new je(h)),g);l=l.updateImmediateChild(h,p)}),zg(d).forEach(h=>{l=l.updateImmediateChild(h.name,h.node)}),l}else{const d=Pn(r.visibleWrites,n);return zg(d).forEach(h=>{l=l.updateImmediateChild(h.name,h.node)}),l}}function w_(r,n,a,l,c){X(l||c,"Either existingEventSnap or existingServerSnap must exist");const d=tt(n,a);if(xu(r.visibleWrites,d))return null;{const h=Pn(r.visibleWrites,d);return _u(h)?c.getChild(a):Aa(h,c.getChild(a))}}function S_(r,n,a,l){const c=tt(n,a),d=Ns(r.visibleWrites,c);if(d!=null)return d;if(l.isCompleteForChild(a)){const h=Pn(r.visibleWrites,c);return Aa(h,l.getNode().getImmediateChild(a))}else return null}function E_(r,n){return Ns(r.visibleWrites,n)}function C_(r,n,a,l,c,d,h){let g;const p=Pn(r.visibleWrites,n),y=Ns(p,_e());if(y!=null)g=y;else if(a!=null)g=Aa(p,a);else return[];if(g=g.withIndex(h),!g.isEmpty()&&!g.isLeafNode()){const b=[],x=h.getCompare(),_=d?g.getReverseIteratorFrom(l,h):g.getIteratorFrom(l,h);let C=_.getNext();for(;C&&b.length<c;)x(C,l)!==0&&b.push(C),C=_.getNext();return b}else return[]}function N_(){return{visibleWrites:Kt.empty(),allWrites:[],lastWriteId:-1}}function wu(r,n,a,l){return Y0(r.writeTree,r.treePath,n,a,l)}function F0(r,n){return __(r.writeTree,r.treePath,n)}function Bg(r,n,a,l){return w_(r.writeTree,r.treePath,n,a,l)}function Tr(r,n){return E_(r.writeTree,tt(r.treePath,n))}function T_(r,n,a,l,c,d){return C_(r.writeTree,r.treePath,n,a,l,c,d)}function Gu(r,n,a){return S_(r.writeTree,r.treePath,n,a)}function V0(r,n){return Q0(tt(r.treePath,n),r.writeTree)}function Q0(r,n){return{treePath:r,writeTree:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(){this.changeMap=new Map}trackChildChange(n){const a=n.type,l=n.childName;X(a==="child_added"||a==="child_changed"||a==="child_removed","Only child changes supported for tracking"),X(l!==".priority","Only non-priority child changes can be tracked.");const c=this.changeMap.get(l);if(c){const d=c.type;if(a==="child_added"&&d==="child_removed")this.changeMap.set(l,jg(l,n.snapshotNode,c.snapshotNode));else if(a==="child_removed"&&d==="child_added")this.changeMap.delete(l);else if(a==="child_removed"&&d==="child_changed")this.changeMap.set(l,s_(l,c.oldSnap));else if(a==="child_changed"&&d==="child_added")this.changeMap.set(l,n_(l,n.snapshotNode));else if(a==="child_changed"&&d==="child_changed")this.changeMap.set(l,jg(l,n.snapshotNode,c.oldSnap));else throw Fi("Illegal combination of changes: "+n+" occurred after "+c)}else this.changeMap.set(l,n)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{getCompleteChild(n){return null}getChildAfterChild(n,a,l){return null}}const X0=new A_;class Yu{constructor(n,a,l=null){this.writes_=n,this.viewCache_=a,this.optCompleteServerCache_=l}getCompleteChild(n){const a=this.viewCache_.eventCache;if(a.isCompleteForChild(n))return a.getNode().getImmediateChild(n);{const l=this.optCompleteServerCache_!=null?new Iu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Gu(this.writes_,n,l)}}getChildAfterChild(n,a,l){const c=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Cs(this.viewCache_),d=T_(this.writes_,c,a,1,l,n);return d.length===0?null:d[0]}}function D_(r,n){X(n.eventCache.getNode().isIndexed(r.filter.getIndex()),"Event snap not indexed"),X(n.serverCache.getNode().isIndexed(r.filter.getIndex()),"Server snap not indexed")}function j_(r,n,a,l,c){const d=new R_;let h,g;if(a.type===$t.OVERWRITE){const y=a;y.source.fromUser?h=Su(r,n,y.path,y.snap,l,c,d):(X(y.source.fromServer,"Unknown source."),g=y.source.tagged||n.serverCache.isFiltered()&&!de(y.path),h=Rr(r,n,y.path,y.snap,l,c,g,d))}else if(a.type===$t.MERGE){const y=a;y.source.fromUser?h=O_(r,n,y.path,y.children,l,c,d):(X(y.source.fromServer,"Unknown source."),g=y.source.tagged||n.serverCache.isFiltered(),h=Eu(r,n,y.path,y.children,l,c,g,d))}else if(a.type===$t.ACK_USER_WRITE){const y=a;y.revert?h=L_(r,n,y.path,l,c,d):h=k_(r,n,y.path,y.affectedTree,l,c,d)}else if(a.type===$t.LISTEN_COMPLETE)h=U_(r,n,a.path,l,d);else throw Fi("Unknown operation type: "+a.type);const p=d.getChanges();return M_(n,h,p),{viewCache:h,changes:p}}function M_(r,n,a){const l=n.eventCache;if(l.isFullyInitialized()){const c=l.getNode().isLeafNode()||l.getNode().isEmpty(),d=bu(r);(a.length>0||!r.eventCache.isFullyInitialized()||c&&!l.getNode().equals(d)||!l.getNode().getPriority().equals(d.getPriority()))&&a.push(t_(bu(n)))}}function $0(r,n,a,l,c,d){const h=n.eventCache;if(Tr(l,a)!=null)return n;{let g,p;if(de(a))if(X(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const y=Cs(n),b=y instanceof ye?y:ye.EMPTY_NODE,x=F0(l,b);g=r.filter.updateFullNode(n.eventCache.getNode(),x,d)}else{const y=wu(l,Cs(n));g=r.filter.updateFullNode(n.eventCache.getNode(),y,d)}else{const y=fe(a);if(y===".priority"){X(es(a)===1,"Can't have a priority with additional path components");const b=h.getNode();p=n.serverCache.getNode();const x=Bg(l,a,b,p);x!=null?g=r.filter.updatePriority(b,x):g=h.getNode()}else{const b=Re(a);let x;if(h.isCompleteForChild(y)){p=n.serverCache.getNode();const _=Bg(l,a,h.getNode(),p);_!=null?x=h.getNode().getImmediateChild(y).updateChild(b,_):x=h.getNode().getImmediateChild(y)}else x=Gu(l,y,n.serverCache);x!=null?g=r.filter.updateChild(h.getNode(),y,x,b,c,d):g=h.getNode()}}return qi(n,g,h.isFullyInitialized()||de(a),r.filter.filtersNodes())}}function Rr(r,n,a,l,c,d,h,g){const p=n.serverCache;let y;const b=h?r.filter:r.filter.getIndexedFilter();if(de(a))y=b.updateFullNode(p.getNode(),l,null);else if(b.filtersNodes()&&!p.isFiltered()){const C=p.getNode().updateChild(a,l);y=b.updateFullNode(p.getNode(),C,null)}else{const C=fe(a);if(!p.isCompleteForPath(a)&&es(a)>1)return n;const O=Re(a),V=p.getNode().getImmediateChild(C).updateChild(O,l);C===".priority"?y=b.updatePriority(p.getNode(),V):y=b.updateChild(p.getNode(),C,V,O,X0,null)}const x=q0(n,y,p.isFullyInitialized()||de(a),b.filtersNodes()),_=new Yu(c,x,d);return $0(r,x,a,c,_,g)}function Su(r,n,a,l,c,d,h){const g=n.eventCache;let p,y;const b=new Yu(c,n,d);if(de(a))y=r.filter.updateFullNode(n.eventCache.getNode(),l,h),p=qi(n,y,!0,r.filter.filtersNodes());else{const x=fe(a);if(x===".priority")y=r.filter.updatePriority(n.eventCache.getNode(),l),p=qi(n,y,g.isFullyInitialized(),g.isFiltered());else{const _=Re(a),C=g.getNode().getImmediateChild(x);let O;if(de(_))O=l;else{const L=b.getCompleteChild(x);L!=null?T0(_)===".priority"&&L.getChild(A0(_)).isEmpty()?O=L:O=L.updateChild(_,l):O=ye.EMPTY_NODE}if(C.equals(O))p=n;else{const L=r.filter.updateChild(g.getNode(),x,O,_,b,h);p=qi(n,L,g.isFullyInitialized(),r.filter.filtersNodes())}}}return p}function qg(r,n){return r.eventCache.isCompleteForChild(n)}function O_(r,n,a,l,c,d,h){let g=n;return l.foreach((p,y)=>{const b=tt(a,p);qg(n,fe(b))&&(g=Su(r,g,b,y,c,d,h))}),l.foreach((p,y)=>{const b=tt(a,p);qg(n,fe(b))||(g=Su(r,g,b,y,c,d,h))}),g}function Hg(r,n,a){return a.foreach((l,c)=>{n=n.updateChild(l,c)}),n}function Eu(r,n,a,l,c,d,h,g){if(n.serverCache.getNode().isEmpty()&&!n.serverCache.isFullyInitialized())return n;let p=n,y;de(a)?y=l:y=new De(null).setTree(a,l);const b=n.serverCache.getNode();return y.children.inorderTraversal((x,_)=>{if(b.hasChild(x)){const C=n.serverCache.getNode().getImmediateChild(x),O=Hg(r,C,_);p=Rr(r,p,new je(x),O,c,d,h,g)}}),y.children.inorderTraversal((x,_)=>{const C=!n.serverCache.isCompleteForChild(x)&&_.value===null;if(!b.hasChild(x)&&!C){const O=n.serverCache.getNode().getImmediateChild(x),L=Hg(r,O,_);p=Rr(r,p,new je(x),L,c,d,h,g)}}),p}function k_(r,n,a,l,c,d,h){if(Tr(c,a)!=null)return n;const g=n.serverCache.isFiltered(),p=n.serverCache;if(l.value!=null){if(de(a)&&p.isFullyInitialized()||p.isCompleteForPath(a))return Rr(r,n,a,p.getNode().getChild(a),c,d,g,h);if(de(a)){let y=new De(null);return p.getNode().forEachChild(Na,(b,x)=>{y=y.set(new je(b),x)}),Eu(r,n,a,y,c,d,g,h)}else return n}else{let y=new De(null);return l.foreach((b,x)=>{const _=tt(a,b);p.isCompleteForPath(_)&&(y=y.set(b,p.getNode().getChild(_)))}),Eu(r,n,a,y,c,d,g,h)}}function U_(r,n,a,l,c){const d=n.serverCache,h=q0(n,d.getNode(),d.isFullyInitialized()||de(a),d.isFiltered());return $0(r,h,a,l,X0,c)}function L_(r,n,a,l,c,d){let h;if(Tr(l,a)!=null)return n;{const g=new Yu(l,n,c),p=n.eventCache.getNode();let y;if(de(a)||fe(a)===".priority"){let b;if(n.serverCache.isFullyInitialized())b=wu(l,Cs(n));else{const x=n.serverCache.getNode();X(x instanceof ye,"serverChildren would be complete if leaf node"),b=F0(l,x)}b=b,y=r.filter.updateFullNode(p,b,d)}else{const b=fe(a);let x=Gu(l,b,n.serverCache);x==null&&n.serverCache.isCompleteForChild(b)&&(x=p.getImmediateChild(b)),x!=null?y=r.filter.updateChild(p,b,x,Re(a),g,d):n.eventCache.getNode().hasChild(b)?y=r.filter.updateChild(p,b,ye.EMPTY_NODE,Re(a),g,d):y=p,y.isEmpty()&&n.serverCache.isFullyInitialized()&&(h=wu(l,Cs(n)),h.isLeafNode()&&(y=r.filter.updateFullNode(y,h,d)))}return h=n.serverCache.isFullyInitialized()||Tr(l,_e())!=null,qi(n,y,h,r.filter.filtersNodes())}}function z_(r){return r.viewCache_.serverCache.getNode()}function B_(r,n){const a=Cs(r.viewCache_);return a&&(r.query._queryParams.loadsAllData()||!de(n)&&!a.getImmediateChild(fe(n)).isEmpty())?a.getChild(n):null}function Ig(r){return r.eventRegistrations_.length===0}function Gg(r,n,a){const l=[];if(a){X(n==null,"A cancel should cancel all event registrations.");const c=r.query._path;r.eventRegistrations_.forEach(d=>{const h=d.createCancelEvent(a,c);h&&l.push(h)})}return r.eventRegistrations_=[],l}function Yg(r,n,a,l){n.type===$t.MERGE&&n.source.queryId!==null&&(X(Cs(r.viewCache_),"We should always have a full cache before handling merges"),X(bu(r.viewCache_),"Missing event cache, even though we have a server cache"));const c=r.viewCache_,d=j_(r.processor_,c,n,a,l);return D_(r.processor_,d.viewCache),X(d.viewCache.serverCache.isFullyInitialized()||!c.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),r.viewCache_=d.viewCache,q_(r,d.changes,d.viewCache.eventCache.getNode())}function q_(r,n,a,l){const c=r.eventRegistrations_;return d_(r.eventGenerator_,n,a,c)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ar;function H_(r){X(!Ar,"__referenceConstructor has already been defined"),Ar=r}function I_(){return X(Ar,"Reference.ts has not been loaded"),Ar}function G_(r){return r.views.size===0}function Fu(r,n,a,l){const c=n.source.queryId;if(c!==null){const d=r.views.get(c);return X(d!=null,"SyncTree gave us an op for an invalid query."),Yg(d,n,a,l)}else{let d=[];for(const h of r.views.values())d=d.concat(Yg(h,n,a,l));return d}}function Y_(r,n,a,l){const c=n._queryIdentifier,d=[];let h=[];const g=Dr(r);if(c==="default")for(const[p,y]of r.views.entries())h=h.concat(Gg(y,a,l)),Ig(y)&&(r.views.delete(p),y.query._queryParams.loadsAllData()||d.push(y.query));else{const p=r.views.get(c);p&&(h=h.concat(Gg(p,a,l)),Ig(p)&&(r.views.delete(c),p.query._queryParams.loadsAllData()||d.push(p.query)))}return g&&!Dr(r)&&d.push(new(I_())(n._repo,n._path)),{removed:d,events:h}}function F_(r){const n=[];for(const a of r.views.values())a.query._queryParams.loadsAllData()||n.push(a);return n}function Vu(r,n){let a=null;for(const l of r.views.values())a=a||B_(l,n);return a}function V_(r,n){if(n._queryParams.loadsAllData())return Qu(r);{const l=n._queryIdentifier;return r.views.get(l)}}function Q_(r,n){return V_(r,n)!=null}function Dr(r){return Qu(r)!=null}function Qu(r){for(const n of r.views.values())if(n.query._queryParams.loadsAllData())return n;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jr;function X_(r){X(!jr,"__referenceConstructor has already been defined"),jr=r}function $_(){return X(jr,"Reference.ts has not been loaded"),jr}class Fg{constructor(n){this.listenProvider_=n,this.syncPointTree_=new De(null),this.pendingWriteTree_=N_(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function K_(r,n,a,l,c){return g_(r.pendingWriteTree_,n,a,l,c),c?Ki(r,new Es(z0(),n,a)):[]}function Sa(r,n,a=!1){const l=p_(r.pendingWriteTree_,n);if(y_(r.pendingWriteTree_,n)){let d=new De(null);return l.snap!=null?d=d.set(_e(),!0):jt(l.children,h=>{d=d.set(new je(h),!0)}),Ki(r,new Nr(l.path,d,a))}else return[]}function Ur(r,n,a){return Ki(r,new Es(qu(),n,a))}function Z_(r,n,a){const l=De.fromObject(a);return Ki(r,new Yi(qu(),n,l))}function W_(r,n){return Ki(r,new Gi(qu(),n))}function J_(r,n,a){const l=$u(r,a);if(l){const c=Ku(l),d=c.path,h=c.queryId,g=At(d,n),p=new Gi(Hu(h),g);return Zu(r,d,p)}else return[]}function Cu(r,n,a,l,c=!1){const d=n._path,h=r.syncPointTree_.get(d);let g=[];if(h&&(n._queryIdentifier==="default"||Q_(h,n))){const p=Y_(h,n,a,l);G_(h)&&(r.syncPointTree_=r.syncPointTree_.remove(d));const y=p.removed;if(g=p.events,!c){const b=y.findIndex(_=>_._queryParams.loadsAllData())!==-1,x=r.syncPointTree_.findOnPath(d,(_,C)=>Dr(C));if(b&&!x){const _=r.syncPointTree_.subtree(d);if(!_.isEmpty()){const C=n1(_);for(let O=0;O<C.length;++O){const L=C[O],V=L.query,K=t1(r,L);r.listenProvider_.startListening(uu(V),J0(r,V),K.hashFn,K.onComplete)}}}!x&&y.length>0&&!l&&(b?r.listenProvider_.stopListening(uu(n),null):y.forEach(_=>{const C=r.queryToTagMap.get(Xu(_));r.listenProvider_.stopListening(uu(_),C)}))}s1(r,y)}return g}function P_(r,n,a,l){const c=$u(r,l);if(c!=null){const d=Ku(c),h=d.path,g=d.queryId,p=At(h,n),y=new Es(Hu(g),p,a);return Zu(r,h,y)}else return[]}function e1(r,n,a,l){const c=$u(r,l);if(c){const d=Ku(c),h=d.path,g=d.queryId,p=At(h,n),y=De.fromObject(a),b=new Yi(Hu(g),p,y);return Zu(r,h,b)}else return[]}function K0(r,n,a){const c=r.pendingWriteTree_,d=r.syncPointTree_.findOnPath(n,(h,g)=>{const p=At(h,n),y=Vu(g,p);if(y)return y});return Y0(c,n,d,a,!0)}function Ki(r,n){return Z0(n,r.syncPointTree_,null,I0(r.pendingWriteTree_,_e()))}function Z0(r,n,a,l){if(de(r.path))return W0(r,n,a,l);{const c=n.get(_e());a==null&&c!=null&&(a=Vu(c,_e()));let d=[];const h=fe(r.path),g=r.operationForChild(h),p=n.children.get(h);if(p&&g){const y=a?a.getImmediateChild(h):null,b=V0(l,h);d=d.concat(Z0(g,p,y,b))}return c&&(d=d.concat(Fu(c,r,l,a))),d}}function W0(r,n,a,l){const c=n.get(_e());a==null&&c!=null&&(a=Vu(c,_e()));let d=[];return n.children.inorderTraversal((h,g)=>{const p=a?a.getImmediateChild(h):null,y=V0(l,h),b=r.operationForChild(h);b&&(d=d.concat(W0(b,g,p,y)))}),c&&(d=d.concat(Fu(c,r,l,a))),d}function t1(r,n){const a=n.query,l=J0(r,a);return{hashFn:()=>(z_(n)||ye.EMPTY_NODE).hash(),onComplete:c=>{if(c==="ok")return l?J_(r,a._path,l):W_(r,a._path);{const d=tx(c,a);return Cu(r,a,null,d)}}}}function J0(r,n){const a=Xu(n);return r.queryToTagMap.get(a)}function Xu(r){return r._path.toString()+"$"+r._queryIdentifier}function $u(r,n){return r.tagToQueryMap.get(n)}function Ku(r){const n=r.indexOf("$");return X(n!==-1&&n<r.length-1,"Bad queryKey."),{queryId:r.substr(n+1),path:new je(r.substr(0,n))}}function Zu(r,n,a){const l=r.syncPointTree_.get(n);X(l,"Missing sync point for query tag that we're tracking");const c=I0(r.pendingWriteTree_,n);return Fu(l,a,c,null)}function n1(r){return r.fold((n,a,l)=>{if(a&&Dr(a))return[Qu(a)];{let c=[];return a&&(c=F_(a)),jt(l,(d,h)=>{c=c.concat(h)}),c}})}function uu(r){return r._queryParams.loadsAllData()&&!r._queryParams.isDefault()?new($_())(r._repo,r._path):r}function s1(r,n){for(let a=0;a<n.length;++a){const l=n[a];if(!l._queryParams.loadsAllData()){const c=Xu(l),d=r.queryToTagMap.get(c);r.queryToTagMap.delete(c),r.tagToQueryMap.delete(d)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(n){this.node_=n}getImmediateChild(n){const a=this.node_.getImmediateChild(n);return new Wu(a)}node(){return this.node_}}class Ju{constructor(n,a){this.syncTree_=n,this.path_=a}getImmediateChild(n){const a=tt(this.path_,n);return new Ju(this.syncTree_,a)}node(){return K0(this.syncTree_,this.path_)}}const a1=function(r){return r=r||{},r.timestamp=r.timestamp||new Date().getTime(),r},Vg=function(r,n,a){if(!r||typeof r!="object")return r;if(X(".sv"in r,"Unexpected leaf node or priority contents"),typeof r[".sv"]=="string")return i1(r[".sv"],n,a);if(typeof r[".sv"]=="object")return l1(r[".sv"],n);X(!1,"Unexpected server value: "+JSON.stringify(r,null,2))},i1=function(r,n,a){switch(r){case"timestamp":return a.timestamp;default:X(!1,"Unexpected server value: "+r)}},l1=function(r,n,a){r.hasOwnProperty("increment")||X(!1,"Unexpected server value: "+JSON.stringify(r,null,2));const l=r.increment;typeof l!="number"&&X(!1,"Unexpected increment value: "+l);const c=n.node();if(X(c!==null&&typeof c<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!c.isLeafNode())return l;const h=c.getValue();return typeof h!="number"?l:h+l},r1=function(r,n,a,l){return Pu(n,new Ju(a,r),l)},o1=function(r,n,a){return Pu(r,new Wu(n),a)};function Pu(r,n,a){const l=r.getPriority().val(),c=Vg(l,n.getImmediateChild(".priority"),a);let d;if(r.isLeafNode()){const h=r,g=Vg(h.getValue(),n,a);return g!==h.getValue()||c!==h.getPriority().val()?new Pe(g,ct(c)):r}else{const h=r;return d=h,c!==h.getPriority().val()&&(d=d.updatePriority(new Pe(c))),h.forEachChild(ut,(g,p)=>{const y=Pu(p,n.getImmediateChild(g),a);y!==p&&(d=d.updateImmediateChild(g,y))}),d}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ed{constructor(n="",a=null,l={children:{},childCount:0}){this.name=n,this.parent=a,this.node=l}}function td(r,n){let a=n instanceof je?n:new je(n),l=r,c=fe(a);for(;c!==null;){const d=Ta(l.node.children,c)||{children:{},childCount:0};l=new ed(c,l,d),a=Re(a),c=fe(a)}return l}function ja(r){return r.node.value}function P0(r,n){r.node.value=n,Nu(r)}function ep(r){return r.node.childCount>0}function c1(r){return ja(r)===void 0&&!ep(r)}function Lr(r,n){jt(r.node.children,(a,l)=>{n(new ed(a,r,l))})}function tp(r,n,a,l){a&&n(r),Lr(r,c=>{tp(c,n,!0)})}function u1(r,n,a){let l=r.parent;for(;l!==null;){if(n(l))return!0;l=l.parent}return!1}function Zi(r){return new je(r.parent===null?r.name:Zi(r.parent)+"/"+r.name)}function Nu(r){r.parent!==null&&d1(r.parent,r.name,r)}function d1(r,n,a){const l=c1(a),c=Cn(r.node.children,n);l&&c?(delete r.node.children[n],r.node.childCount--,Nu(r)):!l&&!c&&(r.node.children[n]=a.node,r.node.childCount++,Nu(r))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f1=/[\[\].#$\/\u0000-\u001F\u007F]/,h1=/[\[\].#$\u0000-\u001F\u007F]/,du=10*1024*1024,np=function(r){return typeof r=="string"&&r.length!==0&&!f1.test(r)},m1=function(r){return typeof r=="string"&&r.length!==0&&!h1.test(r)},g1=function(r){return r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),m1(r)},sp=function(r,n,a){const l=a instanceof je?new Ux(a,r):a;if(n===void 0)throw new Error(r+"contains undefined "+bs(l));if(typeof n=="function")throw new Error(r+"contains a function "+bs(l)+" with contents = "+n.toString());if(r0(n))throw new Error(r+"contains "+n.toString()+" "+bs(l));if(typeof n=="string"&&n.length>du/3&&Or(n)>du)throw new Error(r+"contains a string greater than "+du+" utf8 bytes "+bs(l)+" ('"+n.substring(0,50)+"...')");if(n&&typeof n=="object"){let c=!1,d=!1;if(jt(n,(h,g)=>{if(h===".value")c=!0;else if(h!==".priority"&&h!==".sv"&&(d=!0,!np(h)))throw new Error(r+" contains an invalid key ("+h+") "+bs(l)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);Lx(l,h),sp(r,g,l),zx(l)}),c&&d)throw new Error(r+' contains ".value" child '+bs(l)+" in addition to actual children.")}},p1=function(r,n){const a=n.path.toString();if(typeof n.repoInfo.host!="string"||n.repoInfo.host.length===0||!np(n.repoInfo.namespace)&&n.repoInfo.host.split(":")[0]!=="localhost"||a.length!==0&&!g1(a))throw new Error(Pv(r,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function ap(r,n){let a=null;for(let l=0;l<n.length;l++){const c=n[l],d=c.getPath();a!==null&&!Uu(d,a.path)&&(r.eventLists_.push(a),a=null),a===null&&(a={events:[],path:d}),a.events.push(c)}a&&r.eventLists_.push(a)}function v1(r,n,a){ap(r,a),ip(r,l=>Uu(l,n))}function Ts(r,n,a){ap(r,a),ip(r,l=>Xt(l,n)||Xt(n,l))}function ip(r,n){r.recursionDepth_++;let a=!0;for(let l=0;l<r.eventLists_.length;l++){const c=r.eventLists_[l];if(c){const d=c.path;n(d)?(b1(r.eventLists_[l]),r.eventLists_[l]=null):a=!1}}a&&(r.eventLists_=[]),r.recursionDepth_--}function b1(r){for(let n=0;n<r.events.length;n++){const a=r.events[n];if(a!==null){r.events[n]=null;const l=a.getEventRunner();zi&&ot("event: "+a.toString()),Xi(l)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x1="repo_interrupt",_1=25;class w1{constructor(n,a,l,c){this.repoInfo_=n,this.forceRestClient_=a,this.authTokenProvider_=l,this.appCheckProvider_=c,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new y1,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Cr(),this.transactionQueueTree_=new ed,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function S1(r,n,a){if(r.stats_=Ou(r.repoInfo_),r.forceRestClient_||ix())r.server_=new Er(r.repoInfo_,(l,c,d,h)=>{Qg(r,l,c,d,h)},r.authTokenProvider_,r.appCheckProvider_),setTimeout(()=>Xg(r,!0),0);else{if(typeof a<"u"&&a!==null){if(typeof a!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{it(a)}catch(l){throw new Error("Invalid authOverride provided: "+l)}}r.persistentConnection_=new En(r.repoInfo_,n,(l,c,d,h)=>{Qg(r,l,c,d,h)},l=>{Xg(r,l)},l=>{C1(r,l)},r.authTokenProvider_,r.appCheckProvider_,a),r.server_=r.persistentConnection_}r.authTokenProvider_.addTokenChangeListener(l=>{r.server_.refreshAuthToken(l)}),r.appCheckProvider_.addTokenChangeListener(l=>{r.server_.refreshAppCheckToken(l.token)}),r.statsReporter_=dx(r.repoInfo_,()=>new u_(r.stats_,r.server_)),r.infoData_=new i_,r.infoSyncTree_=new Fg({startListening:(l,c,d,h)=>{let g=[];const p=r.infoData_.getNode(l._path);return p.isEmpty()||(g=Ur(r.infoSyncTree_,l._path,p),setTimeout(()=>{h("ok")},0)),g},stopListening:()=>{}}),nd(r,"connected",!1),r.serverSyncTree_=new Fg({startListening:(l,c,d,h)=>(r.server_.listen(l,d,c,(g,p)=>{const y=h(g,p);Ts(r.eventQueue_,l._path,y)}),[]),stopListening:(l,c)=>{r.server_.unlisten(l,c)}})}function E1(r){const a=r.infoData_.getNode(new je(".info/serverTimeOffset")).val()||0;return new Date().getTime()+a}function lp(r){return a1({timestamp:E1(r)})}function Qg(r,n,a,l,c){r.dataUpdateCount++;const d=new je(n);a=r.interceptServerDataCallback_?r.interceptServerDataCallback_(n,a):a;let h=[];if(c)if(l){const p=br(a,y=>ct(y));h=e1(r.serverSyncTree_,d,p,c)}else{const p=ct(a);h=P_(r.serverSyncTree_,d,p,c)}else if(l){const p=br(a,y=>ct(y));h=Z_(r.serverSyncTree_,d,p)}else{const p=ct(a);h=Ur(r.serverSyncTree_,d,p)}let g=d;h.length>0&&(g=ad(r,d)),Ts(r.eventQueue_,g,h)}function Xg(r,n){nd(r,"connected",n),n===!1&&T1(r)}function C1(r,n){jt(n,(a,l)=>{nd(r,a,l)})}function nd(r,n,a){const l=new je("/.info/"+n),c=ct(a);r.infoData_.updateSnapshot(l,c);const d=Ur(r.infoSyncTree_,l,c);Ts(r.eventQueue_,l,d)}function N1(r){return r.nextWriteId_++}function T1(r){rp(r,"onDisconnectEvents");const n=lp(r),a=Cr();vu(r.onDisconnect_,_e(),(c,d)=>{const h=r1(c,d,r.serverSyncTree_,n);L0(a,c,h)});let l=[];vu(a,_e(),(c,d)=>{l=l.concat(Ur(r.serverSyncTree_,c,d));const h=M1(r,c);ad(r,h)}),r.onDisconnect_=Cr(),Ts(r.eventQueue_,_e(),l)}function R1(r,n,a){let l;fe(n._path)===".info"?l=Cu(r.infoSyncTree_,n,a):l=Cu(r.serverSyncTree_,n,a),v1(r.eventQueue_,n._path,l)}function A1(r){r.persistentConnection_&&r.persistentConnection_.interrupt(x1)}function rp(r,...n){let a="";r.persistentConnection_&&(a=r.persistentConnection_.id+":"),ot(a,...n)}function op(r,n,a){return K0(r.serverSyncTree_,n,a)||ye.EMPTY_NODE}function sd(r,n=r.transactionQueueTree_){if(n||zr(r,n),ja(n)){const a=up(r,n);X(a.length>0,"Sending zero length transaction queue"),a.every(c=>c.status===0)&&D1(r,Zi(n),a)}else ep(n)&&Lr(n,a=>{sd(r,a)})}function D1(r,n,a){const l=a.map(y=>y.currentWriteId),c=op(r,n,l);let d=c;const h=c.hash();for(let y=0;y<a.length;y++){const b=a[y];X(b.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),b.status=1,b.retryCount++;const x=At(n,b.path);d=d.updateChild(x,b.currentOutputSnapshotRaw)}const g=d.val(!0),p=n;r.server_.put(p.toString(),g,y=>{rp(r,"transaction put response",{path:p.toString(),status:y});let b=[];if(y==="ok"){const x=[];for(let _=0;_<a.length;_++)a[_].status=2,b=b.concat(Sa(r.serverSyncTree_,a[_].currentWriteId)),a[_].onComplete&&x.push(()=>a[_].onComplete(null,!0,a[_].currentOutputSnapshotResolved)),a[_].unwatcher();zr(r,td(r.transactionQueueTree_,n)),sd(r,r.transactionQueueTree_),Ts(r.eventQueue_,n,b);for(let _=0;_<x.length;_++)Xi(x[_])}else{if(y==="datastale")for(let x=0;x<a.length;x++)a[x].status===3?a[x].status=4:a[x].status=0;else{Dt("transaction at "+p.toString()+" failed: "+y);for(let x=0;x<a.length;x++)a[x].status=4,a[x].abortReason=y}ad(r,n)}},h)}function ad(r,n){const a=cp(r,n),l=Zi(a),c=up(r,a);return j1(r,c,l),l}function j1(r,n,a){if(n.length===0)return;const l=[];let c=[];const h=n.filter(g=>g.status===0).map(g=>g.currentWriteId);for(let g=0;g<n.length;g++){const p=n[g],y=At(a,p.path);let b=!1,x;if(X(y!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),p.status===4)b=!0,x=p.abortReason,c=c.concat(Sa(r.serverSyncTree_,p.currentWriteId,!0));else if(p.status===0)if(p.retryCount>=_1)b=!0,x="maxretry",c=c.concat(Sa(r.serverSyncTree_,p.currentWriteId,!0));else{const _=op(r,p.path,h);p.currentInputSnapshot=_;const C=n[g].update(_.val());if(C!==void 0){sp("transaction failed: Data returned ",C,p.path);let O=ct(C);typeof C=="object"&&C!=null&&Cn(C,".priority")||(O=O.updatePriority(_.getPriority()));const V=p.currentWriteId,K=lp(r),P=o1(O,_,K);p.currentOutputSnapshotRaw=O,p.currentOutputSnapshotResolved=P,p.currentWriteId=N1(r),h.splice(h.indexOf(V),1),c=c.concat(K_(r.serverSyncTree_,p.path,P,p.currentWriteId,p.applyLocally)),c=c.concat(Sa(r.serverSyncTree_,V,!0))}else b=!0,x="nodata",c=c.concat(Sa(r.serverSyncTree_,p.currentWriteId,!0))}Ts(r.eventQueue_,a,c),c=[],b&&(n[g].status=2,(function(_){setTimeout(_,Math.floor(0))})(n[g].unwatcher),n[g].onComplete&&(x==="nodata"?l.push(()=>n[g].onComplete(null,!1,n[g].currentInputSnapshot)):l.push(()=>n[g].onComplete(new Error(x),!1,null))))}zr(r,r.transactionQueueTree_);for(let g=0;g<l.length;g++)Xi(l[g]);sd(r,r.transactionQueueTree_)}function cp(r,n){let a,l=r.transactionQueueTree_;for(a=fe(n);a!==null&&ja(l)===void 0;)l=td(l,a),n=Re(n),a=fe(n);return l}function up(r,n){const a=[];return dp(r,n,a),a.sort((l,c)=>l.order-c.order),a}function dp(r,n,a){const l=ja(n);if(l)for(let c=0;c<l.length;c++)a.push(l[c]);Lr(n,c=>{dp(r,c,a)})}function zr(r,n){const a=ja(n);if(a){let l=0;for(let c=0;c<a.length;c++)a[c].status!==2&&(a[l]=a[c],l++);a.length=l,P0(n,a.length>0?a:void 0)}Lr(n,l=>{zr(r,l)})}function M1(r,n){const a=Zi(cp(r,n)),l=td(r.transactionQueueTree_,n);return u1(l,c=>{fu(r,c)}),fu(r,l),tp(l,c=>{fu(r,c)}),a}function fu(r,n){const a=ja(n);if(a){const l=[];let c=[],d=-1;for(let h=0;h<a.length;h++)a[h].status===3||(a[h].status===1?(X(d===h-1,"All SENT items should be at beginning of queue."),d=h,a[h].status=3,a[h].abortReason="set"):(X(a[h].status===0,"Unexpected transaction status in abort"),a[h].unwatcher(),c=c.concat(Sa(r.serverSyncTree_,a[h].currentWriteId,!0)),a[h].onComplete&&l.push(a[h].onComplete.bind(null,new Error("set"),!1,null))));d===-1?P0(n,void 0):a.length=d+1,Ts(r.eventQueue_,Zi(n),c);for(let h=0;h<l.length;h++)Xi(l[h])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O1(r){let n="";const a=r.split("/");for(let l=0;l<a.length;l++)if(a[l].length>0){let c=a[l];try{c=decodeURIComponent(c.replace(/\+/g," "))}catch{}n+="/"+c}return n}function k1(r){const n={};r.charAt(0)==="?"&&(r=r.substring(1));for(const a of r.split("&")){if(a.length===0)continue;const l=a.split("=");l.length===2?n[decodeURIComponent(l[0])]=decodeURIComponent(l[1]):Dt(`Invalid query segment '${a}' in query '${r}'`)}return n}const $g=function(r,n){const a=U1(r),l=a.namespace;a.domain==="firebase.com"&&ws(a.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!l||l==="undefined")&&a.domain!=="localhost"&&ws("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),a.secure||Zb();const c=a.scheme==="ws"||a.scheme==="wss";return{repoInfo:new ox(a.host,a.secure,l,c,n,"",l!==a.subdomain),path:new je(a.pathString)}},U1=function(r){let n="",a="",l="",c="",d="",h=!0,g="https",p=443;if(typeof r=="string"){let y=r.indexOf("//");y>=0&&(g=r.substring(0,y-1),r=r.substring(y+2));let b=r.indexOf("/");b===-1&&(b=r.length);let x=r.indexOf("?");x===-1&&(x=r.length),n=r.substring(0,Math.min(b,x)),b<x&&(c=O1(r.substring(b,x)));const _=k1(r.substring(Math.min(r.length,x)));y=n.indexOf(":"),y>=0?(h=g==="https"||g==="wss",p=parseInt(n.substring(y+1),10)):y=n.length;const C=n.slice(0,y);if(C.toLowerCase()==="localhost")a="localhost";else if(C.split(".").length<=2)a=C;else{const O=n.indexOf(".");l=n.substring(0,O).toLowerCase(),a=n.substring(O+1),d=l}"ns"in _&&(d=_.ns)}return{host:n,port:p,domain:a,subdomain:l,secure:h,scheme:g,pathString:c,namespace:d}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(n,a,l,c){this._repo=n,this._path=a,this._queryParams=l,this._orderByCalled=c}get key(){return de(this._path)?null:T0(this._path)}get ref(){return new Ma(this._repo,this._path)}get _queryIdentifier(){const n=Og(this._queryParams),a=ju(n);return a==="{}"?"default":a}get _queryObject(){return Og(this._queryParams)}isEqual(n){if(n=lb(n),!(n instanceof id))return!1;const a=this._repo===n._repo,l=Uu(this._path,n._path),c=this._queryIdentifier===n._queryIdentifier;return a&&l&&c}toJSON(){return this.toString()}toString(){return this._repo.toString()+kx(this._path)}}class Ma extends id{constructor(n,a){super(n,a,new Bu,!1)}get parent(){const n=A0(this._path);return n===null?null:new Ma(this._repo,n)}get root(){let n=this;for(;n.parent!==null;)n=n.parent;return n}}function L1(r,n,a){R1(r._repo,r,null)}H_(Ma);X_(Ma);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1="FIREBASE_DATABASE_EMULATOR_HOST",Tu={};let B1=!1;function q1(r,n,a,l,c){let d=l||r.options.databaseURL;d===void 0&&(r.options.projectId||ws("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ot("Using default host for project ",r.options.projectId),d=`${r.options.projectId}-default-rtdb.firebaseio.com`);let h=$g(d,c),g=h.repoInfo,p;typeof process<"u"&&mg&&(p=mg[z1]),p?(d=`http://${p}?ns=${g.namespace}`,h=$g(d,c),g=h.repoInfo):h.repoInfo.secure;const y=new rx(r.name,r.options,n);p1("Invalid Firebase Database URL",h),de(h.path)||ws("Database URL must point to the root of a Firebase Database (not including a child path).");const b=I1(g,r,y,new lx(r,a));return new G1(b,r)}function H1(r,n){const a=Tu[n];(!a||a[r.key]!==r)&&ws(`Database ${n}(${r.repoInfo_}) has already been deleted.`),A1(r),delete a[r.key]}function I1(r,n,a,l){let c=Tu[n.name];c||(c={},Tu[n.name]=c);let d=c[r.toURLString()];return d&&ws("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),d=new w1(r,B1,a,l),c[r.toURLString()]=d,d}class G1{constructor(n,a){this._repoInternal=n,this.app=a,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(S1(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ma(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(H1(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(n){this._rootInternal===null&&ws("Cannot call "+n+" on a deleted database.")}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(r){Fb(ub),$v(new Kv("database",(n,{instanceIdentifier:a})=>{const l=n.getProvider("app").getImmediate(),c=n.getProvider("auth-internal"),d=n.getProvider("app-check-internal");return q1(l,c,d,a)},"PUBLIC").setMultipleInstances(!0)),ag(gg,pg,r),ag(gg,pg,"esm2020")}En.prototype.simpleListen=function(r,n){this.sendRequest("q",{p:r},n)};En.prototype.echo=function(r,n){this.sendRequest("echo",{d:r},n)};Y1();class Ea{static instance;status;listeners=new Set;heartbeatInterval;reconnectTimeout;presenceRef;connectedRef;heartbeatRef;userId;constructor(){this.status={isOnline:navigator.onLine,isFirebaseConnected:!1,lastHeartbeat:0,reconnectAttempts:0,latency:0},this.setupNetworkListeners()}static getInstance(){return Ea.instance||(Ea.instance=new Ea),Ea.instance}initialize(){this.setupFirebaseConnectionMonitoring(),this.startHeartbeat()}getStatus(){return{...this.status}}addEventListener(n){return this.listeners.add(n),()=>this.listeners.delete(n)}async checkConnection(){const n=Date.now();try{{const l=await fetch("https://www.google.com/favicon.ico",{method:"HEAD",cache:"no-cache",mode:"no-cors",signal:AbortSignal.timeout(5e3)})}return this.status.latency=Date.now()-n,this.status.isOnline=!0,this.status.isFirebaseConnected=!0,this.status.reconnectAttempts=0,this.updateSyncService(),this.emitEvent({type:"connected",timestamp:Date.now(),status:this.status}),!0}catch(a){return console.warn("Connection check failed:",a),this.status.isOnline=!1,this.status.isFirebaseConnected=!1,this.updateSyncService(),this.emitEvent({type:"disconnected",timestamp:Date.now(),status:this.status}),!1}}async reconnect(){if(this.status.reconnectAttempts>=10)return console.warn("Max reconnection attempts reached"),!1;this.status.reconnectAttempts++,this.emitEvent({type:"reconnecting",timestamp:Date.now(),status:this.status});const n=Math.min(1e3*Math.pow(2,this.status.reconnectAttempts-1),3e4);return new Promise(a=>{this.reconnectTimeout=setTimeout(async()=>{const l=await this.checkConnection();l||this.reconnect(),a(l)},n)})}setupNetworkListeners(){const n=()=>{this.status.isOnline=!0,this.checkConnection()},a=()=>{this.status.isOnline=!1,this.status.isFirebaseConnected=!1,this.updateSyncService(),this.emitEvent({type:"disconnected",timestamp:Date.now(),status:this.status}),this.reconnect()};window.addEventListener("online",n),window.addEventListener("offline",a),document.addEventListener("visibilitychange",()=>{!document.hidden&&this.status.isOnline&&this.checkConnection()})}setupFirebaseConnectionMonitoring(){if(this.userId)try{this.simulateFirebasePresence()}catch(n){console.warn("Firebase connection monitoring setup failed:",n),this.startPeriodicConnectionCheck()}}simulateFirebasePresence(){}startPeriodicConnectionCheck(){setInterval(()=>{this.status.isOnline&&this.checkConnection()},3e4)}startHeartbeat(){this.heartbeatInterval=setInterval(()=>{this.sendHeartbeat()},1e4)}async sendHeartbeat(){if(!this.status.isOnline)return;const n=Date.now();try{await fetch("https://www.google.com/favicon.ico",{method:"HEAD",cache:"no-cache",mode:"no-cors",signal:AbortSignal.timeout(3e3)}),this.status.lastHeartbeat=Date.now(),this.status.latency=Date.now()-n,this.emitEvent({type:"heartbeat",timestamp:Date.now(),status:this.status}),this.status.isFirebaseConnected||(this.status.isFirebaseConnected=!0,this.status.reconnectAttempts=0,this.updateSyncService(),this.emitEvent({type:"connected",timestamp:Date.now(),status:this.status}))}catch{this.status.isFirebaseConnected&&(this.status.isFirebaseConnected=!1,this.updateSyncService(),this.emitEvent({type:"disconnected",timestamp:Date.now(),status:this.status}),this.reconnect())}}updateSyncService(){this.emitEvent({type:this.status.isOnline&&this.status.isFirebaseConnected?"connected":"disconnected",timestamp:Date.now(),status:this.status})}emitEvent(n){this.listeners.forEach(a=>{try{a(n)}catch(l){console.error("Error in connection event listener:",l)}})}destroy(){if(this.heartbeatInterval&&clearInterval(this.heartbeatInterval),this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.connectedRef&&this.userId)try{L1(this.connectedRef)}catch(n){console.warn("Error cleaning up Firebase listeners:",n)}this.listeners.clear()}}const Li=Ea.getInstance();function fp(){const[r,n]=w.useState(Rt.getState()),[a,l]=w.useState(Li.getStatus()),[c,d]=w.useState(!1),h=w.useRef(!1);w.useEffect(()=>{h.current||(h.current=!0,Li.initialize(),sn.initialize().catch(L=>{console.warn("Failed to initialize offline storage:",L)}))},[]),w.useEffect(()=>Rt.addEventListener(V=>{n(Rt.getState()),(V.type==="operation-queued"||V.type==="operation-synced")&&d(V.type==="operation-queued")}),[]);const g=w.useCallback(async()=>{if(!(!r.isOnline||!r.isConnected)){d(!0);try{console.log("Force sync triggered"),await new Promise(L=>setTimeout(L,1e3))}catch(L){console.error("Force sync failed:",L)}finally{d(!1)}}},[r.isOnline,r.isConnected]);w.useEffect(()=>Li.addEventListener(V=>{l(Li.getStatus()),Rt.setConnectionStatus(V.status.isOnline&&V.status.isFirebaseConnected),V.type==="connected"&&g()}),[g]);const p=w.useCallback(async()=>await Li.checkConnection(),[]),y=w.useCallback(()=>{Rt.clearPendingOperations()},[]),b=w.useCallback(L=>Rt.resolveConflict(L),[]),x=w.useCallback(L=>{Rt.setConflictResolutionStrategy(L)},[]),_=w.useCallback(async()=>await sn.exportData(),[]),C=w.useCallback(async L=>{await sn.importData(L)},[]),O=w.useCallback(async()=>{await sn.clearUserData()},[]);return{syncState:r,connectionStatus:a,isOnline:r.isOnline,isConnected:r.isConnected,isSyncing:c,hasConflicts:r.conflictResolution.conflicts.length>0,pendingOperationsCount:r.pendingOperations.length,forceSync:g,checkConnection:p,clearPendingOperations:y,resolveConflict:b,setConflictResolutionStrategy:x,exportOfflineData:_,importOfflineData:C,clearOfflineData:O}}function hp(){const[r,n]=w.useState(1),[a,l]=w.useState(!0),c=w.useRef(null),d=w.useRef(`tab-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),h=w.useRef(null),g=w.useRef(null),p=w.useRef(new Set),y=w.useRef(new Set),b=w.useRef(new Set),x=w.useRef(new Set),_=w.useRef(new Set([d.current])),C=w.useRef({});w.useEffect(()=>(c.current=new BroadcastChannel("lora-dataset-cross-tab"),c.current.addEventListener("message",O),K(),P(),()=>{c.current&&c.current.close(),h.current&&clearInterval(h.current),g.current&&clearTimeout(g.current)}),[]);const O=w.useCallback(q=>{const G=q.data;if(G.tabId!==d.current)switch(G.type){case"image-updated":p.current.forEach(se=>{try{se(G.data)}catch(Z){console.error("Error in image update handler:",Z)}});break;case"image-deleted":y.current.forEach(se=>{try{se(G.data)}catch(Z){console.error("Error in image delete handler:",Z)}});break;case"image-created":b.current.forEach(se=>{try{se(G.data)}catch(Z){console.error("Error in image create handler:",Z)}});break;case"sync-request":x.current.forEach(se=>{try{se()}catch(Z){console.error("Error in sync request handler:",Z)}});break;case"heartbeat":L(G.tabId,G.timestamp);break;case"leader-election":V(G.tabId,G.timestamp);break}},[]),L=w.useCallback((q,G)=>{_.current.add(q),C.current[q]=G,n(_.current.size);const se=Date.now(),Z=3e4;for(const[J,T]of Object.entries(C.current))se-T>Z&&(_.current.delete(J),delete C.current[J]);n(_.current.size)},[]),V=w.useCallback((q,G)=>{const se=parseInt(d.current.split("-")[1]);G<se&&l(!1)},[]),K=w.useCallback(()=>{const q=()=>{if(c.current){const G={type:"heartbeat",data:null,timestamp:Date.now(),tabId:d.current};c.current.postMessage(G)}};q(),h.current=setInterval(q,1e4)},[]),P=w.useCallback(()=>{if(c.current){const q={type:"leader-election",data:null,timestamp:parseInt(d.current.split("-")[1]),tabId:d.current};c.current.postMessage(q)}g.current=setTimeout(()=>{l(!0)},1e3)},[]),U=w.useCallback(q=>{if(c.current){const G={type:"image-updated",data:q,timestamp:Date.now(),tabId:d.current};c.current.postMessage(G)}},[]),I=w.useCallback(q=>{if(c.current){const G={type:"image-deleted",data:q,timestamp:Date.now(),tabId:d.current};c.current.postMessage(G)}},[]),Q=w.useCallback(q=>{if(c.current){const G={type:"image-created",data:q,timestamp:Date.now(),tabId:d.current};c.current.postMessage(G)}},[]),ee=w.useCallback(()=>{if(c.current){const q={type:"sync-request",data:null,timestamp:Date.now(),tabId:d.current};c.current.postMessage(q)}},[]),$=w.useCallback(q=>(p.current.add(q),()=>p.current.delete(q)),[]),M=w.useCallback(q=>(y.current.add(q),()=>y.current.delete(q)),[]),F=w.useCallback(q=>(b.current.add(q),()=>b.current.delete(q)),[]),H=w.useCallback(q=>(x.current.add(q),()=>x.current.delete(q)),[]);return{connectedTabs:r,isLeaderTab:a,broadcastImageUpdate:U,broadcastImageDelete:I,broadcastImageCreate:Q,requestSync:ee,onImageUpdate:$,onImageDelete:M,onImageCreate:F,onSyncRequest:H}}const ya=db();class va{static async signUp(n,a){try{const c=(await fb(ya,n,a)).user;return{uid:c.uid,email:c.email,displayName:c.displayName}}catch(l){throw console.error("Sign up error:",l),new Error(l.message||"Failed to sign up")}}static async signIn(n,a){try{const c=(await hb(ya,n,a)).user;return{uid:c.uid,email:c.email,displayName:c.displayName}}catch(l){throw console.error("Sign in error:",l),new Error(l.message||"Failed to sign in")}}static async signOut(){try{await mb(ya)}catch(n){throw console.error("Sign out error:",n),new Error(n.message||"Failed to sign out")}}static getCurrentUser(){return ya.currentUser}static onAuthStateChanged(n){return gb(ya,n)}static async migrateExistingImages(){const n=ya.currentUser;if(!n)throw new Error("No authenticated user");try{console.log("🔄 Starting image migration for user:",n.uid);const a=_n(Vt(Oe,"images")),l=await ba(a);if(l.empty)return console.log("No images found in old collection to migrate"),0;console.log(`📊 Found ${l.size} images in old collection to migrate`);const c=pb(Oe);let d=0;for(const h of l.docs){const g=h.data(),p=Ft(Vt(Oe,"users",n.uid,"images"),h.id);c.set(p,{...g,userId:n.uid,migratedAt:Date.now()}),c.delete(h.ref),d++}return await c.commit(),console.log(`✅ Successfully migrated ${d} images to user ${n.uid}`),d}catch(a){throw console.error("❌ Migration error:",a),new Error(a.message||"Failed to migrate images")}}static async hasOrphanedImages(){try{const n=_n(Vt(Oe,"images"));return!(await ba(n)).empty}catch(n){return console.error("Check orphaned images error:",n),!1}}}const mp=w.createContext(void 0),Rs=()=>{const r=w.useContext(mp);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},F1=({children:r})=>{const[n,a]=w.useState(null),[l,c]=w.useState(null),[d,h]=w.useState(!0),[g,p]=w.useState(!1);w.useEffect(()=>va.onAuthStateChanged(V=>{a(V),c(V?{uid:V.uid,email:V.email,displayName:V.displayName}:null),h(!1)}),[]);const y=async(L,V)=>{try{await va.signIn(L,V)}catch(K){throw K}},b=async(L,V)=>{try{await va.signUp(L,V)}catch(K){throw K}},x=async()=>{try{await va.signOut()}catch(L){throw L}},_=async()=>{try{const L=await va.migrateExistingImages();return p(!1),L}catch(L){throw L}},C=async()=>{try{const L=await va.hasOrphanedImages();p(L)}catch(L){console.error("Failed to check orphaned images:",L)}};w.useEffect(()=>{n?C():p(!1)},[n]);const O={user:n,authUser:l,loading:d,signIn:y,signUp:b,signOut:x,migrateImages:_,hasOrphanedImages:g,checkOrphanedImages:C};return f.jsx(mp.Provider,{value:O,children:r})};function gp(){const{user:r}=Rs(),[n,a]=w.useState([]),[l,c]=w.useState(!0),[d,h]=w.useState(null),[g,p]=w.useState(!1),{isOnline:y,isConnected:b,hasConflicts:x}=fp(),{broadcastImageUpdate:_,broadcastImageDelete:C,broadcastImageCreate:O,onImageUpdate:L,onImageDelete:V,onImageCreate:K}=hp(),{startMeasurement:P,endMeasurement:U}=Du({enabled:!0,sampleRate:.2,onMetrics:F=>{F.renderTime>50&&console.log(`Images hook performance: ${F.renderTime.toFixed(2)}ms for ${F.imageCount} images`)}});w.useEffect(()=>{console.log("🔍 useImages: Setting up for simple collection"),console.log("🔍 useImages: Connection status - isOnline:",y,"isConnected:",b),c(!0),h(null);let F,H=0;const q=y&&b;console.log("🔍 useImages setup - isOnline:",y,"isConnected:",b,"shouldSubscribe:",q),console.log("🔍 useImages: Using user-specific collection path for user:",r?.uid),q&&r?.uid?(console.log("📡 Setting up Firestore subscription for user:",r.uid),console.log("📡 Connection status:",{isOnline:y,isConnected:b,shouldSubscribe:q}),console.log("🔄 setupSubscription called, retry count:",H),console.log("🔄 Calling ImageService.subscribeToImages for user:",r.uid),F=Be.subscribeToImages(r.uid,T=>{P(),console.log("📊 Firestore subscription received",T.length,"images from user collection"),console.log("📊 Image details:",T.map(Y=>({id:Y.id,filename:Y.id,status:Y.status}))),console.log("📊 Full updatedImages array:",T),T.length>0&&(p(!0),H=0),console.log("✅ Setting images to:",T.length,"images"),a(T),c(!1),U(T.length)},T=>{console.error("❌ Firestore subscription error:",T),console.error("❌ Subscription error details:",{error:T.message,retryCount:H}),h(T.message),c(!1)})):(console.log("📱 App appears offline, loading from local storage"),Be.getImagesSimple().then(J=>{P(),console.log("📦 Loaded",J.length,"images from offline storage"),(n.length===0||J.length>n.length)&&a(J),c(!1),U(J.length||n.length)}).catch(J=>{console.error("❌ Offline storage error:",J),h(J.message),c(!1)}));const G=L(J=>{console.log("🔄 Cross-tab image update received:",J.id),a(T=>{const Y=T.findIndex(ne=>ne.id===J.id);if(Y!==-1){const ne=[...T];return ne[Y]=J,ne}else return[J,...T]})}),se=V(J=>{console.log("🗑️ Cross-tab image delete received:",J),a(T=>T.filter(Y=>Y.id!==J))}),Z=K(J=>{console.log("➕ Cross-tab image create received:",J.id),a(T=>T.some(Y=>Y.id===J.id)?T:[J,...T])});return()=>{console.log("🧹 useImages cleanup - unsubscribing from all listeners"),F&&F(),G(),se(),Z()}},[y,b]);const I=w.useCallback(async F=>{if(console.log("🔍 uploadImage called with file:",F.name,"size:",F.size),console.log("🔍 Current user state:",r),!r?.uid){const H="You must be signed in to upload images";return console.error("❌ Upload blocked:",H),h(H),null}try{console.log("🚀 Starting authenticated upload for user:",r.uid),console.log("🚀 File details:",{name:F.name,size:F.size,type:F.type});const H=await Be.withRetry(()=>Be.uploadImage(F,r.uid));return console.log("✅ Upload completed, imageDoc:",H),H?(console.log("📡 Broadcasting image creation to other tabs"),O(H)):console.warn("⚠️ No imageDoc returned from upload"),H}catch(H){return console.error("❌ Failed to upload image:",H),console.error("❌ Error details:",{name:H.name,message:H.message,stack:H.stack}),h(H instanceof Error?H.message:"Upload failed"),null}},[r?.uid,O]),Q=w.useCallback(async(F,H)=>{if(!r?.uid)return h("You must be signed in to update images"),!1;try{await Be.updateImageSimple(F,H,r.uid);const q=n.find(G=>G.id===F);return q&&_({...q,...H}),!0}catch(q){return console.error("❌ Failed to update image:",q),h(q instanceof Error?q.message:"Update failed"),!1}},[r?.uid,n,_]),ee=w.useCallback(async F=>{if(!r?.uid)return h("You must be signed in to delete images"),!1;try{return await Be.deleteImageSimple(F,r.uid),C(F),!0}catch(H){return console.error("❌ Failed to delete image:",H),h(H instanceof Error?H.message:"Delete failed"),!1}},[r?.uid,C]),$=w.useCallback(async F=>{const H={successful:[],failed:[]};for(const q of F)try{await ee(q),H.successful.push(q)}catch(G){H.failed.push({imageId:q,error:G instanceof Error?G.message:"Unknown error"})}return H},[ee]),M=w.useCallback(()=>{h(null)},[]);return{images:n,loading:l,error:d,hasConflicts:x,uploadImage:I,updateImage:Q,deleteImage:ee,batchDeleteImages:$,clearError:M}}let V1=0;function Qe(r="id"){return`${r}-${++V1}`}function Ie(r,n="polite"){const a=document.createElement("div");a.setAttribute("aria-live",n),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=r,document.body.appendChild(a),setTimeout(()=>{document.body.removeChild(a)},1e3)}class Mr{static focusStack=[];static pushFocus(n){const a=document.activeElement;a&&this.focusStack.push(a),n.focus()}static popFocus(){const n=this.focusStack.pop();n&&n.focus()}static trapFocus(n){const a=n.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),l=a[0],c=a[a.length-1],d=h=>{h.key==="Tab"&&(h.shiftKey?document.activeElement===l&&(c.focus(),h.preventDefault()):document.activeElement===c&&(l.focus(),h.preventDefault()))};return n.addEventListener("keydown",d),l&&l.focus(),()=>{n.removeEventListener("keydown",d)}}}const wn={ENTER:"Enter",SPACE:" ",ARROW_UP:"ArrowUp",ARROW_DOWN:"ArrowDown",ARROW_LEFT:"ArrowLeft",ARROW_RIGHT:"ArrowRight",HOME:"Home",END:"End"};function Q1(r,n,a=[wn.ENTER,wn.SPACE]){a.includes(r.key)&&(r.preventDefault(),n())}function X1({candidates:r,selectedIndex:n,onSelectionChange:a,selectedTextOverride:l,onTextChange:c,onRegenerateProvider:d,onRegenerateAll:h,allowManualEntry:g=!0}){const[p,y]=w.useState(!1),[b,x]=w.useState(new Set),[_,C]=w.useState(!1),[O,L]=w.useState(""),V=w.useRef(Qe("caption-selector"));w.useRef(Qe("caption-group"));const K=w.useRef(Qe("selected-caption")),P=w.useRef(Qe("manual-entry")),U=w.useCallback(()=>l!==void 0?l:n!==null&&r[n]?r[n].caption:"",[l,n,r]);w.useCallback(M=>{a(M),y(!1),C(!1);const F=$(r[M]?.modelId||"");Ie(`Selected caption from ${F}`)},[a,r]);const I=w.useCallback(()=>{O.trim()&&(c(O.trim()),a(-1),C(!1),Ie("Manual caption selected"))},[O,c,a]),Q=w.useCallback(M=>{c(M.target.value)},[c]),ee=w.useCallback(M=>{x(F=>{const H=new Set(F);return H.has(M)?H.delete(M):H.add(M),H})},[]),$=M=>{const F=M.split(":");return F.length>1?F[0].charAt(0).toUpperCase()+F[0].slice(1):M};return r.length>0&&r.every(M=>M.error),r.some(M=>!M.error),r.length===0&&!g?null:f.jsxs("div",{className:"space-y-3",role:"region","aria-labelledby":`${V.current}-title`,children:[f.jsx("h4",{id:`${V.current}-title`,className:"sr-only",children:"Caption Selection"}),f.jsxs("fieldset",{className:"space-y-2",children:[f.jsx("legend",{className:"sr-only",children:"Choose a caption from the available options"}),r.map((M,F)=>f.jsxs("div",{className:"border border-gray-600 rounded-lg p-3",children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx("label",{htmlFor:`caption-${F}`,className:"text-sm font-medium text-gray-300 cursor-pointer",children:$(M.modelId)})}),f.jsxs("div",{id:`caption-meta-${F}`,className:"flex items-center gap-2 text-xs text-gray-500",children:[M.latencyMs&&f.jsxs("span",{"aria-label":`Response time: ${M.latencyMs} milliseconds`,children:[M.latencyMs,"ms"]}),M.tokensUsed&&f.jsxs("span",{"aria-label":`Tokens used: ${M.tokensUsed}`,children:[M.tokensUsed," tokens"]})]})]}),M.error?f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"text-red-400 text-sm bg-red-900/20 p-2 rounded flex-1",role:"alert","aria-live":"polite",children:["Error: ",M.error]}),d&&f.jsx("button",{onClick:()=>d(M.modelId),className:"ml-2 px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":`Retry caption generation for ${$(M.modelId)}`,children:"Retry"})]}):f.jsxs("div",{className:"text-sm text-gray-200",children:[f.jsx("p",{id:`caption-text-${F}`,className:b.has(F)?"":"line-clamp-3",children:M.caption}),M.caption.length>100&&f.jsx("button",{onClick:()=>ee(F),className:"mt-1 text-blue-400 hover:text-blue-300 text-xs underline focus:outline-none focus:ring-2 focus:ring-blue-500 rounded","aria-expanded":b.has(F),"aria-controls":`caption-text-${F}`,children:b.has(F)?"Show less":"Show more"})]})]},F))]}),(h||g)&&f.jsxs("div",{className:"flex gap-2 pt-2 border-t border-gray-600",children:[h&&f.jsx("button",{onClick:h,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Regenerate captions from all providers",children:"Regenerate All"}),g&&f.jsx("button",{onClick:()=>C(!_),className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500","aria-expanded":_,"aria-controls":P.current,children:_?"Cancel Manual Entry":"Add Manual Caption"})]}),_&&g&&f.jsxs("div",{id:P.current,className:"border border-yellow-600 rounded-lg p-3 bg-yellow-900/10",role:"region","aria-labelledby":`${P.current}-title`,children:[f.jsx("h4",{id:`${P.current}-title`,className:"text-sm font-medium text-yellow-300 mb-2",children:"Manual Caption Entry"}),f.jsx("label",{htmlFor:`${P.current}-textarea`,className:"sr-only",children:"Enter your custom caption text"}),f.jsx("textarea",{id:`${P.current}-textarea`,value:O,onChange:M=>L(M.target.value),className:"w-full p-2 bg-gray-800 border border-gray-600 rounded text-sm text-gray-200 resize-none focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:3,placeholder:"Enter your custom caption...","aria-describedby":`${P.current}-help`}),f.jsx("div",{id:`${P.current}-help`,className:"sr-only",children:"Enter a custom caption for this image. This will override any AI-generated captions."}),f.jsxs("div",{className:"flex gap-2 mt-2",children:[f.jsx("button",{onClick:I,disabled:!O.trim(),className:"px-3 py-1 bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-yellow-500",children:"Use This Caption"}),f.jsx("button",{onClick:()=>{C(!1),L("")},className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Cancel"})]})]}),(n!==null&&n>=0&&!r[n]?.error||n===-1&&l)&&f.jsxs("div",{id:K.current,className:"border border-blue-600 rounded-lg p-3 bg-blue-900/10",role:"region","aria-labelledby":`${K.current}-title`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-2",children:[f.jsx("h4",{id:`${K.current}-title`,className:"text-sm font-medium text-blue-300",children:n===-1?"Manual Caption":"Selected Caption"}),f.jsx("button",{onClick:()=>y(!p),className:"text-xs text-blue-400 hover:text-blue-300 underline focus:outline-none focus:ring-2 focus:ring-blue-500 rounded","aria-expanded":p,"aria-controls":`${K.current}-editor`,children:p?"Save":"Edit"})]}),p?f.jsxs("div",{children:[f.jsx("label",{htmlFor:`${K.current}-editor`,className:"sr-only",children:"Edit the selected caption text"}),f.jsx("textarea",{id:`${K.current}-editor`,value:U(),onChange:Q,className:"w-full p-2 bg-gray-800 border border-gray-600 rounded text-sm text-gray-200 resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Enter your caption...","aria-describedby":`${K.current}-help`}),f.jsx("div",{id:`${K.current}-help`,className:"sr-only",children:"Edit the caption text. Changes will be saved automatically."})]}):f.jsx("p",{className:"text-sm text-gray-200 whitespace-pre-wrap","aria-live":"polite",children:U()||"No caption selected"}),l!==void 0&&f.jsxs("div",{className:"mt-2 text-xs text-yellow-400 flex items-center gap-1",role:"status",children:[f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),f.jsx("span",{"aria-label":n===-1?"This is a manually entered caption":"This caption has been customized",children:n===-1?"Manual caption":"Custom caption"})]})]})]})}function $1({threshold:r=.1,rootMargin:n="50px",triggerOnce:a=!0}={}){const[l,c]=w.useState(!1),[d,h]=w.useState(!1),g=w.useRef(null);return w.useEffect(()=>{const p=g.current;if(!p||a&&d)return;if(typeof IntersectionObserver>"u"){c(!0),a&&h(!0);return}const y=new IntersectionObserver(([b])=>{const x=b.isIntersecting;c(x),x&&a&&h(!0)},{threshold:r,rootMargin:n});return y.observe(p),()=>{y.unobserve(p)}},[r,n,a,d]),{targetRef:g,isIntersecting:a&&d||l}}function K1({src:r,alt:n,className:a="",onError:l,placeholder:c,blurDataURL:d}){const[h,g]=w.useState(!1),[p,y]=w.useState(!1),{targetRef:b,isIntersecting:x}=$1({threshold:.1,rootMargin:"50px",triggerOnce:!0}),_=w.useCallback(()=>{g(!0)},[]),C=w.useCallback(()=>{y(!0),l?.()},[l]);return f.jsxs("div",{ref:b,className:`relative overflow-hidden ${a}`,children:[d&&!h&&!p&&f.jsx("img",{src:d,alt:"",className:"absolute inset-0 w-full h-full object-cover filter blur-sm scale-110 transition-opacity duration-300","aria-hidden":"true"}),c&&!h&&!p&&!d&&f.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:c}),!c&&!d&&!h&&!p&&f.jsx("div",{className:"absolute inset-0 bg-gray-800 animate-pulse flex items-center justify-center",children:f.jsx("div",{className:"text-gray-600",children:f.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),x&&!p&&f.jsx("img",{src:r,alt:n,className:`w-full h-full object-cover transition-opacity duration-300 ${h?"opacity-100":"opacity-0"}`,onLoad:_,onError:C,loading:"lazy"}),p&&f.jsx("div",{className:"absolute inset-0 bg-gray-800 flex items-center justify-center",children:f.jsxs("div",{className:"text-center text-gray-500",children:[f.jsx("svg",{className:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),f.jsx("p",{className:"text-xs",children:"Failed to load"})]})})]})}const Z1=function({image:n,onUpdate:a,onDelete:l,onRegenerate:c,onRegenerateProvider:d,selected:h=!1,onSelectionChange:g,selectionMode:p=!1}){const[y,b]=w.useState(!1),[x,_]=w.useState(!1),[C,O]=w.useState(!1),[L,V]=w.useState(null),K=w.useRef(Qe("image-card")),P=w.useRef(null),U=w.useRef(Qe("image-checkbox")),I=w.useRef(Qe("image-status")),Q=w.useRef(Qe("image-caption")),ee=w.useCallback(()=>{_(!0)},[]),$=w.useCallback(async()=>{if(!C){O(!0),V(null);return}b(!0),V(null);try{await l(),Ie(`Image ${n.filename} deleted successfully`)}catch(T){console.error("Delete failed:",T);const Y=T instanceof Error?T.message:"Failed to delete image";V(Y),b(!1),Ie(`Failed to delete image: ${Y}`,"assertive")}},[C,l,n.filename]),M=w.useCallback(()=>{O(!1),V(null)},[]),F=w.useCallback(T=>{a({selectedIndex:T}),Ie(`Caption ${T+1} selected for ${n.filename}`)},[a,n.filename]),H=w.useCallback(T=>{a({selectedTextOverride:T})},[a]),q=w.useCallback(T=>{d&&d(T)},[d]),G=w.useCallback(()=>{c&&c()},[c]),se=w.useCallback(T=>{g&&(g(T.target.checked),Ie(`Image ${n.filename} ${T.target.checked?"selected":"deselected"}`))},[g,n.filename]);w.useEffect(()=>{if(C&&P.current)return Mr.trapFocus(P.current)},[C]);const Z=w.useMemo(()=>{switch(n.status){case"pending":return{color:"text-yellow-400",bgColor:"bg-yellow-400/10",icon:"⏳",text:"Pending"};case"processing":return{color:"text-blue-400",bgColor:"bg-blue-400/10",icon:"🔄",text:"Processing"};case"complete":return{color:"text-green-400",bgColor:"bg-green-400/10",icon:"✅",text:"Complete"};case"error":return{color:"text-red-400",bgColor:"bg-red-400/10",icon:"❌",text:"Error"};default:return{color:"text-gray-400",bgColor:"bg-gray-400/10",icon:"❓",text:"Unknown"}}},[n.status]),J=w.useMemo(()=>new Date(n.createdAt).toLocaleDateString(),[n.createdAt]);return f.jsxs("article",{id:K.current,className:`bg-gray-800/60 backdrop-blur-sm rounded-2xl border overflow-hidden shadow-xl hover:shadow-2xl transition-all duration-300 group ${h?"border-blue-500 ring-4 ring-blue-500/30 scale-105":"border-gray-700/50 hover:border-gray-600/50 hover:scale-[1.02]"}`,"aria-labelledby":`${K.current}-title`,"aria-describedby":`${I.current} ${Q.current}`,children:[f.jsxs("div",{className:"relative aspect-square bg-gradient-to-br from-gray-900 to-gray-800",children:[x?f.jsx("div",{className:"w-full h-full flex items-center justify-center",children:f.jsxs("div",{className:"text-center text-gray-500",children:[f.jsx("svg",{className:"w-16 h-16 mx-auto mb-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),f.jsx("p",{className:"text-sm font-medium",children:"Failed to load"})]})}):f.jsx(K1,{src:n.downloadURL,alt:n.filename,className:"w-full h-full object-cover",onError:ee}),p&&g&&f.jsxs("div",{className:"absolute top-3 left-3 z-10",children:[f.jsxs("label",{htmlFor:U.current,className:"sr-only",children:[h?"Deselect":"Select"," image ",n.filename]}),f.jsx("input",{id:U.current,type:"checkbox",checked:h,onChange:se,className:"w-6 h-6 text-blue-600 bg-gray-800/80 border-gray-600 rounded-lg focus:ring-4 focus:ring-blue-500/50 focus:ring-offset-2 focus:ring-offset-gray-800 shadow-lg","aria-describedby":`${K.current}-title`})]}),f.jsxs("div",{id:I.current,className:`absolute ${p?"top-3 left-12":"top-3 left-3"} px-3 py-1.5 rounded-full text-xs font-semibold ${Z.color} ${Z.bgColor} backdrop-blur-sm border border-current/20 shadow-lg`,role:"status","aria-label":`Image status: ${Z.text}`,children:[f.jsx("span",{className:"mr-1.5","aria-hidden":"true",children:Z.icon}),Z.text]}),n.status==="processing"&&f.jsx("div",{className:"absolute inset-0 bg-black/30 flex items-center justify-center backdrop-blur-sm",children:f.jsxs("div",{className:"bg-gray-800/80 rounded-2xl p-4 border border-gray-600/50",children:[f.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-3 border-blue-500 border-t-transparent"}),f.jsx("p",{className:"text-white text-sm mt-2 font-medium",children:"Processing..."})]})}),f.jsxs("div",{className:"absolute top-3 right-3 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[c&&f.jsx("button",{onClick:()=>c(),className:"p-2 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white rounded-xl transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-500/50 focus:ring-offset-2 focus:ring-offset-gray-800 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed","aria-label":`Regenerate captions for ${n.filename}`,disabled:n.status==="processing",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),f.jsx("button",{onClick:$,disabled:y,className:`p-2 rounded-xl transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-red-500/50 focus:ring-offset-2 focus:ring-offset-gray-800 shadow-lg hover:shadow-xl ${C?"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800":"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-red-600 hover:to-red-700"} text-white`,"aria-label":C?`Confirm delete ${n.filename}`:`Delete ${n.filename}`,children:y?f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent","aria-hidden":"true"}):f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),C&&f.jsx("div",{className:"absolute inset-0 bg-black/90 flex items-center justify-center backdrop-blur-sm",role:"dialog","aria-modal":"true","aria-labelledby":`${K.current}-delete-title`,"aria-describedby":`${K.current}-delete-desc`,children:f.jsxs("div",{ref:P,className:"text-center text-white p-6 max-w-sm bg-gray-800/90 rounded-2xl border border-gray-700/50 shadow-2xl",children:[f.jsx("h3",{id:`${K.current}-delete-title`,className:"text-lg font-semibold mb-4",children:"Delete this image?"}),L&&f.jsx("div",{id:`${K.current}-delete-desc`,className:"mb-4 p-3 bg-red-900/50 border border-red-700/50 rounded-xl text-red-300 text-sm",role:"alert",children:L}),f.jsxs("div",{className:"flex gap-3 justify-center",children:[f.jsx("button",{onClick:M,disabled:y,className:"px-4 py-2 bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-gray-500/50 focus:ring-offset-2 focus:ring-offset-gray-800 shadow-lg",children:"Cancel"}),f.jsx("button",{onClick:$,disabled:y,className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 focus:outline-none focus:ring-4 focus:ring-red-500/50 focus:ring-offset-2 focus:ring-offset-gray-800 shadow-lg",children:y?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border border-white border-t-transparent"}),"Deleting..."]}):L?"Retry":"Delete"})]})]})})]}),f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{id:`${K.current}-title`,className:"text-base font-semibold text-white mb-3 truncate",title:n.filename,children:n.filename}),n.status==="error"&&n.error&&f.jsx("div",{className:"mb-4 p-3 bg-red-900/30 border border-red-800/50 rounded-xl text-red-300 text-sm",children:n.error}),n.candidates.length>0&&f.jsx("div",{id:Q.current,children:f.jsx(X1,{candidates:n.candidates,selectedIndex:n.selectedIndex,onSelectionChange:F,selectedTextOverride:n.selectedTextOverride,onTextChange:H,onRegenerateProvider:d?q:void 0,onRegenerateAll:c?G:void 0,allowManualEntry:!0})}),n.candidates.length===0&&n.status!=="processing"&&n.status!=="pending"&&f.jsxs("div",{className:"text-center py-6",children:[f.jsx("p",{className:"text-gray-400 text-sm font-medium",children:"No captions available"}),c&&f.jsx("button",{onClick:()=>c(),className:"mt-3 text-blue-400 hover:text-blue-300 text-sm font-medium underline hover:no-underline transition-all duration-200",children:"Generate captions"})]}),f.jsx("div",{className:"mt-4 pt-4 border-t border-gray-700/50 text-xs text-gray-400",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),J]}),f.jsxs("span",{className:"flex items-center gap-1",children:[f.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"})}),n.candidates.length," caption",n.candidates.length!==1?"s":""]})]})})]})]})},pp=w.memo(Z1,(r,n)=>r.image.id===n.image.id&&r.image.status===n.image.status&&r.image.selectedIndex===n.image.selectedIndex&&r.image.selectedTextOverride===n.image.selectedTextOverride&&r.image.candidates.length===n.image.candidates.length&&r.selected===n.selected&&r.selectionMode===n.selectionMode),W1=function({images:n,onImageUpdate:a,onImageDelete:l,onImageRegenerate:c,onRegenerateProvider:d,loading:h=!1,error:g=null,selectedImageIds:p=[],onImageSelectionChange:y,selectionMode:b=!1}){const{startMeasurement:x,endMeasurement:_}=Du({enabled:!0,sampleRate:.3,onMetrics:U=>{U.renderTime>100&&console.warn(`Slow gallery render: ${U.renderTime.toFixed(2)}ms for ${U.imageCount} images`)}}),C=w.useRef(null),[O,L]=t0.useState(-1),V=w.useMemo(()=>{x();const U=[...n].sort((I,Q)=>Q.createdAt-I.createdAt);return _(U.length),U},[n,x,_]),K=w.useCallback(U=>{if(n.length===0)return;const I=O;let Q=I;const ee=P();switch(U.key){case wn.ARROW_RIGHT:U.preventDefault(),Q=Math.min(I+1,n.length-1);break;case wn.ARROW_LEFT:U.preventDefault(),Q=Math.max(I-1,0);break;case wn.ARROW_DOWN:U.preventDefault(),Q=Math.min(I+ee,n.length-1);break;case wn.ARROW_UP:U.preventDefault(),Q=Math.max(I-ee,0);break;case wn.HOME:U.preventDefault(),Q=0;break;case wn.END:U.preventDefault(),Q=n.length-1;break;case wn.SPACE:if(b&&y&&I>=0){U.preventDefault();const $=V[I]?.id;if($){const M=p.includes($);y($,!M),Ie(`Image ${I+1} ${M?"deselected":"selected"}`)}}break;default:return}if(Q!==I&&Q>=0&&Q<n.length){L(Q);const $=C.current?.children[Q];$&&($.focus(),Ie(`Image ${Q+1} of ${n.length}: ${V[Q]?.filename}`))}},[O,n.length,b,y,p,V]),P=w.useCallback(()=>{if(!C.current)return 4;const U=C.current.offsetWidth;return U<640?1:U<1024?2:U<1280?3:U<1536?4:5},[]);return w.useEffect(()=>{n.length===0?L(-1):O>=n.length&&L(n.length-1)},[n.length,O]),w.useEffect(()=>(x(),()=>{_(n.length)}),[n.length,x,_]),h&&n.length===0?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-400",children:"Loading images..."})]})}):g?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-red-500 mb-4",children:f.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("p",{className:"text-red-400 font-medium mb-2",children:"Error loading images"}),f.jsx("p",{className:"text-gray-400 text-sm",children:g})]})}):n.length===0?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-gray-500 mb-4",children:f.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsx("p",{className:"text-gray-400 font-medium mb-2",children:"No images uploaded yet"}),f.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Upload some images to get started"}),f.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors",children:"🔄 Refresh Page"})]})}):f.jsxs("div",{className:"w-full",children:[n.length>0&&f.jsx("div",{className:"sr-only","aria-live":"polite",children:"Use arrow keys to navigate between images. Press Space to select/deselect in selection mode. Press Home/End to jump to first/last image."}),f.jsx("div",{ref:C,className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5",role:"grid","aria-label":`Image gallery with ${n.length} images`,onKeyDown:K,tabIndex:n.length>0?0:-1,children:V.map((U,I)=>f.jsx("div",{role:"gridcell","aria-rowindex":Math.floor(I/P())+1,"aria-colindex":I%P()+1,tabIndex:I===O?0:-1,onFocus:()=>L(I),children:f.jsx(pp,{image:U,onUpdate:Q=>a(U.id,Q),onDelete:()=>l(U.id),onRegenerate:c?Q=>c(U.id,Q):void 0,onRegenerateProvider:d?Q=>d(U.id,Q):void 0,selected:p.includes(U.id),onSelectionChange:y?Q=>y(U.id,Q):void 0,selectionMode:b})},U.id))}),h&&n.length>0&&f.jsxs("div",{className:"flex items-center justify-center py-8",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mr-3"}),f.jsx("span",{className:"text-gray-400",children:"Loading more images..."})]})]})},J1=w.memo(W1,(r,n)=>r.images.length===n.images.length&&r.loading===n.loading&&r.error===n.error&&r.selectionMode===n.selectionMode&&r.selectedImageIds?.length===n.selectedImageIds?.length&&r.images.every((a,l)=>{const c=n.images[l];return c&&a.id===c.id&&a.status===c.status}));function P1({images:r,onImageUpdate:n,onImageDelete:a,onImageRegenerate:l,onRegenerateProvider:c,loading:d=!1,error:h=null,selectedImageIds:g=[],onImageSelectionChange:p,selectionMode:y=!1,itemHeight:b=400,containerHeight:x=600,overscan:_=5}){const[C,O]=w.useState(0),[L,V]=w.useState(null),K=w.useRef(null),{startMeasurement:P,endMeasurement:U}=Du({enabled:!0,sampleRate:.2,onMetrics:G=>{G.renderTime>50}}),[I,Q]=w.useState(4);w.useEffect(()=>{if(!L)return;const G=()=>{const Z=L.offsetWidth,J=280,T=16,Y=Math.max(1,Math.floor((Z+T)/(J+T)));Q(Y)};G();const se=new ResizeObserver(G);return se.observe(L),()=>{se.disconnect()}},[L]);const ee=w.useMemo(()=>[...r].sort((G,se)=>se.createdAt-G.createdAt),[r]),{totalRows:$,visibleRange:M,totalHeight:F}=w.useMemo(()=>{P();const G=Math.ceil(ee.length/I),se=Math.max(0,Math.floor(C/b)-_),Z=Math.min(G-1,Math.ceil((C+x)/b)+_),J={totalRows:G,visibleRange:{start:se,end:Z},totalHeight:G*b};return U(Math.max(0,Z-se+1)*I),J},[ee.length,I,C,b,x,_,P,U]),H=w.useMemo(()=>{const G=[];for(let se=M.start;se<=M.end;se++)for(let Z=0;Z<I;Z++){const J=se*I+Z;J<ee.length&&G.push({image:ee[J],rowIndex:se,colIndex:Z})}return G},[ee,M,I]),q=w.useCallback(G=>{O(G.currentTarget.scrollTop)},[]);return d&&r.length===0?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-400",children:"Loading images..."})]})}):h?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-red-500 mb-4",children:f.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("p",{className:"text-red-400 font-medium mb-2",children:"Error loading images"}),f.jsx("p",{className:"text-gray-400 text-sm",children:h})]})}):r.length===0?f.jsx("div",{className:"flex items-center justify-center py-12",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"text-gray-500 mb-4",children:f.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsx("p",{className:"text-gray-400 font-medium mb-2",children:"No images uploaded yet"}),f.jsx("p",{className:"text-gray-500 text-sm",children:"Upload some images to get started"})]})}):f.jsxs("div",{className:"w-full",children:[!1,f.jsx("div",{ref:G=>{V(G),K.current=G},className:"overflow-auto",style:{height:x},onScroll:q,children:f.jsx("div",{style:{height:F,position:"relative"},children:f.jsx("div",{style:{position:"absolute",top:M.start*b,left:0,right:0},children:f.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${I}, 1fr)`},children:H.map(({image:G,rowIndex:se,colIndex:Z})=>f.jsx("div",{style:{gridRow:se-M.start+1,gridColumn:Z+1},children:f.jsx(pp,{image:G,onUpdate:J=>n(G.id,J),onDelete:()=>a(G.id),onRegenerate:l?J=>l(G.id,J):void 0,onRegenerateProvider:c?J=>c(G.id,J):void 0,selected:g.includes(G.id),onSelectionChange:p?J=>p(G.id,J):void 0,selectionMode:y})},G.id))})})})}),d&&r.length>0&&f.jsxs("div",{className:"flex items-center justify-center py-8",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mr-3"}),f.jsx("span",{className:"text-gray-400",children:"Loading more images..."})]})]})}class ew extends w.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,a){console.error("Image rendering error:",n,a)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:f.jsxs("div",{className:"bg-gray-800 rounded-lg border border-red-600 p-6 text-center",children:[f.jsx("div",{className:"text-red-500 mb-4",children:f.jsx("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("h3",{className:"text-red-400 font-medium mb-2",children:"Image Display Error"}),f.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Something went wrong while displaying the images."}),f.jsx("button",{onClick:()=>this.setState({hasError:!1,error:void 0}),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:"Try Again"})]}):this.props.children}}function tw({images:r,selectedImageIds:n,onSelectionChange:a,onBatchDelete:l,disabled:c=!1}){const[d,h]=w.useState(!1),[g,p]=w.useState(!1),[y,b]=w.useState({completed:0,total:0,current:""}),[x,_]=w.useState(null),C=w.useRef(null),O=w.useRef(Qe("select-all")),L=w.useRef(Qe("batch-delete-modal")),V=w.useCallback(()=>{n.length===r.length?(a([]),Ie("All images deselected")):(a(r.map($=>$.id)),Ie(`All ${r.length} images selected`))},[r,n,a]),K=w.useCallback(()=>{a([]),Ie("Selection cleared")},[a]),P=w.useCallback(async()=>{if(!g){p(!0),_(null);return}h(!0),b({completed:0,total:n.length,current:""});try{const $=await l(n);if(_($),$.successful.length>0){const M=n.filter(F=>!$.successful.includes(F));a(M),Ie(`Successfully deleted ${$.successful.length} image${$.successful.length!==1?"s":""}`)}$.failed.length>0&&Ie(`Failed to delete ${$.failed.length} image${$.failed.length!==1?"s":""}`,"assertive"),$.failed.length===0&&p(!1)}catch($){console.error("Batch delete failed:",$),_({successful:[],failed:n.map(M=>({imageId:M,error:$ instanceof Error?$.message:"Unknown error"}))})}finally{h(!1)}},[g,n,l,a]),U=w.useCallback(()=>{p(!1),_(null)},[]),I=w.useCallback(async()=>{if(!x||x.failed.length===0)return;const $=x.failed.map(M=>M.imageId);h(!0),b({completed:0,total:$.length,current:""});try{const M=await l($),F={successful:[...x.successful,...M.successful],failed:M.failed};if(_(F),M.successful.length>0){const H=n.filter(q=>!M.successful.includes(q));a(H)}F.failed.length===0&&p(!1)}catch(M){console.error("Retry failed:",M)}finally{h(!1)}},[x,l,n,a]),Q=n.length>0,ee=n.length===r.length&&r.length>0;return w.useEffect(()=>{if(g&&C.current)return Mr.trapFocus(C.current)},[g]),f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-800 border border-gray-700 rounded-lg mb-4",children:[f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsxs("label",{htmlFor:O.current,className:"flex items-center gap-2 cursor-pointer",children:[f.jsx("input",{id:O.current,type:"checkbox",checked:ee,onChange:V,disabled:c||r.length===0,className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 focus:ring-2","aria-describedby":`${O.current}-description`}),f.jsx("span",{className:"text-sm text-gray-300",children:ee?"Deselect All":"Select All"})]}),f.jsx("div",{id:`${O.current}-description`,className:"sr-only",children:ee?"Deselect all images in the gallery":"Select all images in the gallery for batch operations"}),Q&&f.jsxs("span",{className:"text-sm text-gray-400",role:"status","aria-live":"polite",children:[n.length," of ",r.length," selected"]})]}),f.jsx("div",{className:"flex items-center gap-2",children:Q&&f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:K,disabled:c,className:"px-3 py-1 text-sm text-gray-400 hover:text-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 rounded",children:"Clear Selection"}),f.jsxs("button",{onClick:P,disabled:c||d,className:"px-3 py-1 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm rounded transition-colors focus:outline-none focus:ring-2 focus:ring-red-500","aria-describedby":"batch-delete-description",children:["Delete Selected (",n.length,")"]}),f.jsxs("div",{id:"batch-delete-description",className:"sr-only",children:["Delete all ",n.length," selected images permanently"]})]})})]}),g&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"dialog","aria-modal":"true",children:f.jsxs("div",{ref:C,className:"bg-gray-800 border border-gray-700 rounded-lg p-6 max-w-md w-full mx-4",role:"document","aria-labelledby":`${L.current}-title`,"aria-describedby":`${L.current}-description`,children:[f.jsxs("h3",{id:`${L.current}-title`,className:"text-lg font-medium text-white mb-4",children:["Delete ",n.length," Image",n.length!==1?"s":"","?"]}),f.jsx("div",{id:`${L.current}-description`,className:"sr-only",children:"This action will permanently delete the selected images and cannot be undone."}),d&&f.jsxs("div",{className:"mb-4",role:"status","aria-live":"polite",children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[f.jsx("span",{children:"Deleting images..."}),f.jsxs("span",{children:[y.completed," / ",y.total]})]}),f.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:f.jsx("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:`${y.completed/y.total*100}%`},role:"progressbar","aria-valuenow":y.completed,"aria-valuemin":0,"aria-valuemax":y.total,"aria-label":`Deleting progress: ${y.completed} of ${y.total} images deleted`})}),y.current&&f.jsxs("p",{className:"text-xs text-gray-500 mt-1","aria-live":"polite",children:["Current: ",y.current]})]}),x&&f.jsxs("div",{className:"mb-4 space-y-2",role:"status","aria-live":"polite",children:[x.successful.length>0&&f.jsxs("div",{className:"p-2 bg-green-900/20 border border-green-800 rounded text-green-400 text-sm",role:"alert",children:[f.jsx("span",{"aria-hidden":"true",children:"✅"})," Successfully deleted ",x.successful.length," image",x.successful.length!==1?"s":""]}),x.failed.length>0&&f.jsxs("div",{className:"p-2 bg-red-900/20 border border-red-800 rounded text-red-400 text-sm",role:"alert",children:[f.jsx("span",{"aria-hidden":"true",children:"❌"})," Failed to delete ",x.failed.length," image",x.failed.length!==1?"s":"",f.jsxs("details",{className:"mt-1",children:[f.jsx("summary",{className:"cursor-pointer text-xs focus:outline-none focus:ring-2 focus:ring-red-500 rounded",children:"Show errors"}),f.jsx("div",{className:"mt-1 space-y-1 text-xs",children:x.failed.map(({imageId:$,error:M})=>f.jsxs("div",{className:"truncate",children:[$,": ",M]},$))})]})]})]}),f.jsxs("div",{className:"flex gap-3 justify-end",children:[f.jsx("button",{onClick:U,disabled:d,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:x&&x.failed.length===0?"Close":"Cancel"}),x&&x.failed.length>0&&f.jsxs("button",{onClick:I,disabled:d,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors focus:outline-none focus:ring-2 focus:ring-red-500","aria-label":`Retry deleting ${x.failed.length} failed images`,children:["Retry Failed (",x.failed.length,")"]}),!x&&f.jsx("button",{onClick:P,disabled:d,className:"px-4 py-2 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-red-500",children:d?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent","aria-hidden":"true"}),f.jsx("span",{children:"Deleting..."})]}):"Confirm Delete"})]})]})})]})}function nw({onImageRegenerate:r,onRegenerateProvider:n,virtualizationThreshold:a=50,enableVirtualization:l=!0,enableBatchOperations:c=!0,selectedImageIds:d=[],onBatchSelectionChange:h,onBatchDelete:g,selectionMode:p=!1,onToggleSelectionMode:y}){const{images:b,loading:x,error:_,updateImage:C,deleteImage:O,batchDeleteImages:L,clearError:V}=gp(),K=w.useCallback(async()=>{console.log("🔄 Manual refresh triggered"),window.location.reload()},[]),[P,U]=w.useState([]),[I,Q]=w.useState(!1),ee=d||P,$=p!==void 0?p:I,M=h||U,F=y||(()=>{Q(T=>!T),I&&U([])}),H=w.useCallback(async(T,Y)=>{await C(T,Y)||console.error("Failed to update image:",T)},[C]),q=w.useCallback(async T=>{await O(T)||console.error("Failed to delete image:",T),M(ee.filter(ve=>ve!==T))},[O]),G=w.useCallback((T,Y)=>{const ne=ee;M(Y?[...ne,T]:ne.filter(ve=>ve!==T))},[M,ee]),se=w.useCallback(T=>{M(T)},[M]),Z=w.useCallback(async T=>g?await g(T):await L(T),[g,L]),J=l&&b.length>=a;return f.jsx(ew,{children:f.jsxs("div",{className:"w-full",children:[_&&f.jsx("div",{className:"mb-8 p-6 bg-gradient-to-r from-red-900/30 to-red-800/30 border border-red-700/50 rounded-2xl shadow-xl backdrop-blur-sm",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-8 h-8 bg-red-600/50 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-5 h-5 text-red-200",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-red-200 font-semibold text-lg mb-1",children:"Error Loading Images"}),f.jsx("p",{className:"text-red-300 text-sm",children:_})]})]}),f.jsx("button",{onClick:V,className:"px-4 py-2 bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800 text-white rounded-lg text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl",children:"Dismiss"})]})}),c&&b.length>0&&f.jsxs("div",{className:"mb-8 p-6 bg-gray-800/40 backdrop-blur-sm border border-gray-700/50 rounded-2xl shadow-xl",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4 mb-6",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-600/20 rounded-xl flex items-center justify-center border border-blue-500/30",children:f.jsx("svg",{className:"w-6 h-6 text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),f.jsxs("h2",{className:"text-xl font-semibold text-white",children:["Image Gallery (",b.length,")"]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[f.jsxs("button",{onClick:K,className:"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl flex items-center gap-2",title:"Refresh page to reload images",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]}),f.jsxs("button",{onClick:F,className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 shadow-lg hover:shadow-xl flex items-center gap-2 ${$?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white":"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-gray-200"}`,children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),$?"Exit Selection":"Select Images"]})]})]}),$&&f.jsx(tw,{images:b,selectedImageIds:ee,onSelectionChange:se,onBatchDelete:Z,disabled:x})]}),J?f.jsxs("div",{className:"h-[700px] bg-gray-800/20 rounded-2xl border border-gray-700/50 p-4",children:[" ",f.jsx(P1,{images:b,onImageUpdate:H,onImageDelete:q,onImageRegenerate:r,onRegenerateProvider:n,threshold:a})]}):f.jsx("div",{className:"bg-gray-800/20 rounded-2xl border border-gray-700/50 p-6",children:f.jsx(J1,{images:b,onImageUpdate:H,onImageDelete:q,onImageRegenerate:r,onRegenerateProvider:n,loading:x,error:_,selectedImageIds:ee,onImageSelectionChange:G,selectionMode:$})}),b.length>0&&f.jsx("div",{className:"mt-8 text-center",children:f.jsxs("div",{className:"inline-flex items-center gap-3 px-4 py-2 bg-gray-800/40 rounded-full border border-gray-700/50",children:[f.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),f.jsxs("p",{className:"text-sm text-gray-300 font-medium",children:["Displaying ",b.length," image",b.length!==1?"s":"",J&&" (virtualized for performance)"]})]})})]})})}class Jn{static generateDataset(n,a){const l=[];let c=0;const d=n.length;for(const h of n){a&&a({processed:c,total:d,currentImage:h.filename});const g=this.getAllCaptions(h);for(const p of g){const y={url:h.downloadURL,filename:h.filename,caption:p};l.push(y)}c++}return a&&a({processed:d,total:d,currentImage:void 0}),l}static getAllCaptions(n){const a=[];if(n.selectedTextOverride?.trim()&&a.push(n.selectedTextOverride.trim()),n.candidates&&n.candidates.length>0)for(const l of n.candidates)l.caption&&l.caption.trim()&&a.push(l.caption.trim());return a}static downloadDataset(n,a){const l=`lora-dataset-${new Date().toISOString().split("T")[0]}-${Date.now()}.json`,c=a||l,d=JSON.stringify(n,null,2),h=new Blob([d],{type:"application/json"}),g=URL.createObjectURL(h),p=document.createElement("a");p.href=g,p.download=c,document.body.appendChild(p),p.click(),document.body.removeChild(p),URL.revokeObjectURL(g)}static shouldShowDownloadButton(){try{return localStorage.getItem("show_dl_button")==="true"}catch(n){return console.warn("Failed to access localStorage:",n),!1}}static setDownloadButtonVisibility(n){try{localStorage.setItem("show_dl_button",n.toString())}catch(a){console.warn("Failed to set localStorage:",a)}}static getDatasetStats(n){let a=0,l=0,c=0;for(const d of n){const h=d.candidates&&d.candidates.length>0||!!d.selectedTextOverride?.trim(),g=!!d.selectedTextOverride?.trim();h&&(a++,c++),g&&l++}return{totalImages:n.length,imagesWithCaptions:a,imagesWithOverrides:l,readyForExport:c}}}function sw({images:r,className:n="",disabled:a=!1,showDownloadButton:l}){const[c,d]=w.useState(!1),[h,g]=w.useState(!1),[p,y]=w.useState(null);if(!l)return null;const b=r&&Array.isArray(r)?Jn.getDatasetStats(r):{totalImages:0,imagesWithOverrides:0,readyForExport:0},x=b.readyForExport>0,_=h?`Exporting... (${p?.processed||0}/${p?.total||0})`:`Export Dataset (${b.readyForExport})`,C=async()=>{if(!(h||!r||!Array.isArray(r))){g(!0),y({processed:0,total:r.length});try{const Q=Jn.generateDataset(r,ee=>{y(ee)});await new Promise(ee=>setTimeout(ee,100)),Jn.downloadDataset(Q),setTimeout(()=>{y(null)},1e3)}catch(Q){console.error("Export failed:",Q),Ie("Dataset export failed","assertive")}finally{g(!1)}}},O=()=>{d(!0)},V=c?!r||!Array.isArray(r)?[]:Jn.generateDataset(r):[],K=w.useRef(null),P=w.useRef(null),U=w.useRef(Qe("export-progress")),I=w.useRef(Qe("export-preview"));return w.useEffect(()=>{if(h&&K.current)return Mr.trapFocus(K.current)},[h]),w.useEffect(()=>{if(c&&P.current)return Mr.trapFocus(P.current)},[c]),f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("button",{onClick:C,disabled:a||h||!x,className:`
            px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed 
            text-white rounded transition-colors flex items-center gap-2 text-sm font-medium
            focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-900
            ${n}
          `,"aria-label":x?"Export dataset as JSON file":"Export disabled: No images with captions available","aria-describedby":"export-button-description",children:h?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent","aria-hidden":"true"}),f.jsx("span",{children:_})]}):f.jsxs(f.Fragment,{children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),f.jsx("span",{children:_})]})}),f.jsx("div",{id:"export-button-description",className:"sr-only",children:x?`Export ${b.readyForExport} images with captions as a JSON dataset file`:"No images with captions are available for export"}),x&&f.jsx("button",{onClick:O,disabled:a||h,className:"px-3 py-2 bg-gray-600 hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors text-sm focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900","aria-label":"Preview dataset contents before export",children:"Preview"})]}),h&&p&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"dialog","aria-modal":"true",children:f.jsxs("div",{ref:K,className:"bg-gray-800 border border-gray-700 rounded-lg p-6 max-w-md w-full mx-4",role:"document","aria-labelledby":`${U.current}-title`,"aria-describedby":`${U.current}-description`,children:[f.jsx("h3",{id:`${U.current}-title`,className:"text-lg font-medium text-white mb-4",children:"Exporting Dataset"}),f.jsx("div",{id:`${U.current}-description`,className:"sr-only",children:"Dataset export is in progress. Please wait while your images are processed."}),f.jsxs("div",{className:"space-y-4",role:"status","aria-live":"polite",children:[f.jsxs("div",{children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[f.jsx("span",{children:"Processing images..."}),f.jsxs("span",{children:[p.processed," / ",p.total]})]}),f.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p.processed/p.total*100}%`},role:"progressbar","aria-valuenow":p.processed,"aria-valuemin":0,"aria-valuemax":p.total,"aria-label":`Export progress: ${p.processed} of ${p.total} images processed`})})]}),p.currentImage&&f.jsxs("div",{className:"text-sm text-gray-400","aria-live":"polite",children:[f.jsx("span",{className:"text-gray-500",children:"Processing:"})," ",p.currentImage]}),f.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[f.jsxs("div",{children:["Total images: ",b.totalImages]}),f.jsxs("div",{children:["Ready for export: ",b.readyForExport]}),f.jsxs("div",{children:["With custom captions: ",b.imagesWithOverrides]})]})]})]})}),c&&f.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",role:"dialog","aria-modal":"true",children:f.jsxs("div",{ref:P,className:"bg-gray-800 border border-gray-700 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] flex flex-col",role:"document","aria-labelledby":`${I.current}-title`,"aria-describedby":`${I.current}-description`,children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("h3",{id:`${I.current}-title`,className:"text-lg font-medium text-white",children:["Dataset Preview (",V.length," entries)"]}),f.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-white transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 rounded p-1","aria-label":"Close preview",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),f.jsxs("div",{id:`${I.current}-description`,className:"sr-only",children:["Preview of the dataset JSON structure showing ",V.length," entries with image URLs, filenames, and captions."]}),f.jsx("div",{className:"flex-1 overflow-auto",children:f.jsx("pre",{className:"text-xs text-gray-300 bg-gray-900 p-4 rounded border border-gray-600 overflow-auto",role:"textbox","aria-readonly":"true","aria-label":"Dataset JSON preview",tabIndex:0,children:JSON.stringify(V,null,2)})}),f.jsxs("div",{className:"flex justify-end gap-3 mt-4 pt-4 border-t border-gray-700",children:[f.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500",children:"Close"}),f.jsx("button",{onClick:()=>{d(!1),C()},disabled:!x,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Export this dataset as JSON file",children:"Export This Dataset"})]})]})})]})}function aw(r){const[n,a]=w.useState(!1),[l,c]=w.useState(null),[d,h]=w.useState(!1),g=w.useMemo(()=>!r||!Array.isArray(r)?{totalImages:0,imagesWithCaptions:0,imagesWithOverrides:0,readyForExport:0}:Jn.getDatasetStats(r),[r]),p=w.useCallback(async C=>{if(!(n||!r||!Array.isArray(r))){a(!0),c({processed:0,total:r.length});try{const O=Jn.generateDataset(r,L=>{c(L)});await new Promise(L=>setTimeout(L,100)),Jn.downloadDataset(O,C),setTimeout(()=>{c(null)},1e3)}catch(O){throw console.error("Export failed:",O),O}finally{a(!1)}}},[r,n]),y=w.useCallback(C=>{h(C!==void 0?C:!d)},[d]),b=w.useCallback(()=>!r||!Array.isArray(r)?[]:Jn.generateDataset(r),[r]),x=w.useMemo(()=>g.readyForExport>0,[g.readyForExport]),_=w.useMemo(()=>n?`Exporting... (${l?.processed||0}/${l?.total||0})`:`Export Dataset (${g.readyForExport})`,[n,l?.processed,l?.total,g.readyForExport]);return{isExporting:n,exportProgress:l,showDownloadButton:d,stats:g,exportDataset:p,toggleDownloadButton:y,generateDatasetPreview:b,canExport:x,exportButtonText:_}}function iw({images:r,className:n="",onBatchSelectionChange:a,onBatchDelete:l,selectedImageIds:c=[],selectionMode:d=!1,onToggleSelectionMode:h}){const{stats:g}=aw(r),p=w.useRef(Qe("toolbar")),y=w.useRef(Qe("stats")),b=w.useRef(Qe("select-all")),x=w.useCallback(()=>{a&&(c.length===r.length?(a([]),Ie("All images deselected")):(a(r.map(L=>L.id)),Ie(`All ${r.length} images selected`)))},[r,c,a]),_=w.useCallback(()=>{a&&(a([]),Ie("Selection cleared"))},[a]),C=c.length>0,O=c.length===r.length&&r.length>0;return f.jsxs("div",{className:`flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6 p-6 bg-gray-800/60 backdrop-blur-sm border border-gray-700/50 rounded-2xl shadow-xl ${n}`,role:"toolbar","aria-labelledby":`${p.current}-title`,"aria-describedby":y.current,children:[f.jsx("div",{className:"sr-only",id:`${p.current}-title`,children:"Dataset Statistics and Export Tools"}),f.jsxs("div",{id:y.current,className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-8 text-sm",role:"status","aria-live":"polite","aria-label":"Dataset statistics",children:[f.jsxs("div",{className:"flex flex-col items-center lg:items-start p-3 bg-gray-700/30 rounded-lg border border-gray-600/30",children:[f.jsx("span",{className:"text-gray-400 text-xs font-medium uppercase tracking-wide",children:"Total Images"}),f.jsx("span",{className:"text-2xl font-bold text-white","aria-label":`${g.totalImages} total images`,children:g.totalImages})]}),f.jsxs("div",{className:"flex flex-col items-center lg:items-start p-3 bg-green-600/20 rounded-lg border border-green-500/30",children:[f.jsx("span",{className:"text-green-300 text-xs font-medium uppercase tracking-wide",children:"With Captions"}),f.jsx("span",{className:"text-2xl font-bold text-green-100","aria-label":`${g.imagesWithCaptions} images with captions`,children:g.imagesWithCaptions})]}),f.jsxs("div",{className:"flex flex-col items-center lg:items-start p-3 bg-blue-600/20 rounded-lg border border-blue-500/30",children:[f.jsx("span",{className:"text-blue-300 text-xs font-medium uppercase tracking-wide",children:"Custom Captions"}),f.jsx("span",{className:"text-2xl font-bold text-blue-100","aria-label":`${g.imagesWithOverrides} images with custom captions`,children:g.imagesWithOverrides})]}),f.jsxs("div",{className:"flex flex-col items-center lg:items-start p-3 bg-yellow-600/20 rounded-lg border border-yellow-500/30",children:[f.jsx("span",{className:"text-yellow-300 text-xs font-medium uppercase tracking-wide",children:"Ready for Export"}),f.jsx("span",{className:"text-2xl font-bold text-yellow-100","aria-label":`${g.readyForExport} images ready for export`,children:g.readyForExport})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 lg:gap-4",children:[r.length>0&&f.jsxs(f.Fragment,{children:[h&&f.jsx("button",{onClick:h,className:`px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-offset-2 focus:ring-offset-gray-800 ${d?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white focus:ring-blue-500/50 shadow-lg":"bg-gradient-to-r from-gray-600 to-gray-700 hover:from-gray-700 hover:to-gray-800 text-gray-200 focus:ring-gray-500/50 shadow-lg"}`,"aria-label":d?"Exit selection mode":"Enter selection mode for batch operations",children:d?"Exit Selection":"Select Images"}),d&&a&&f.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 p-3 bg-gray-700/30 rounded-lg border border-gray-600/30",children:[f.jsxs("label",{htmlFor:b.current,className:"flex items-center gap-3 cursor-pointer",children:[f.jsx("input",{id:b.current,type:"checkbox",checked:O,onChange:x,className:"w-5 h-5 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800","aria-describedby":`${b.current}-description`}),f.jsx("span",{className:"text-sm font-medium text-gray-200",children:O?"Deselect All":"Select All"})]}),f.jsx("div",{id:`${b.current}-description`,className:"sr-only",children:O?"Deselect all images in the gallery":"Select all images in the gallery for batch operations"}),C&&f.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-600/20 rounded-full border border-blue-500/30",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),f.jsxs("span",{className:"text-sm font-medium text-blue-200",role:"status","aria-live":"polite",children:[c.length," selected"]})]}),C&&f.jsx("button",{onClick:_,className:"px-3 py-1 text-sm text-gray-400 hover:text-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-800 rounded-md hover:bg-gray-600/50","aria-label":"Clear current selection",children:"Clear"})]})]}),f.jsx(sw,{images:r,showDownloadButton:!0})]})]})}function lw(r){return["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(r.type)&&r.size<=10485760&&r.size>0}function hu(r){if(r===0)return"0 Bytes";const n=1024,a=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(r)/Math.log(n));return parseFloat((r/Math.pow(n,l)).toFixed(2))+" "+a[l]}function rw({onFilesSelected:r,isUploading:n,progress:a,disabled:l=!1,maxFiles:c=100,maxFileSize:d=10*1024*1024,className:h=""}){const[g,p]=w.useState(!1),[y,b]=w.useState([]),x=w.useRef(null),_=w.useRef(Qe("upload-zone")),C=w.useRef(Qe("upload-progress")),O=w.useRef(Qe("upload-errors")),L=w.useCallback(M=>{M.preventDefault(),M.stopPropagation(),!l&&!n&&p(!0)},[l,n]),V=w.useCallback(M=>{M.preventDefault(),M.stopPropagation(),M.currentTarget.contains(M.relatedTarget)||p(!1)},[]),K=w.useCallback(M=>{M.preventDefault(),M.stopPropagation()},[]),P=w.useCallback(M=>{const F=[],H=[];return M.length>c?(H.push(`Too many files selected. Maximum ${c} files allowed.`),{valid:[],errors:H}):(Array.from(M).forEach((q,G)=>{lw(q)?F.push(q):q.size>d?H.push(`${q.name}: File size ${hu(q.size)} exceeds maximum ${hu(d)}`):["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(q.type)?H.push(`${q.name}: Invalid image file`):H.push(`${q.name}: Unsupported file type. Please use JPEG, PNG, WebP, or GIF.`)}),{valid:F,errors:H})},[c,d]),U=w.useCallback(M=>{if(M.preventDefault(),M.stopPropagation(),p(!1),l||n)return;const F=M.dataTransfer.files;if(F.length===0)return;const{valid:H,errors:q}=P(F);if(b(q),H.length>0){if(typeof DataTransfer<"u"){const G=new DataTransfer;H.forEach(se=>G.items.add(se)),r(G.files)}else r(H);Ie(`${H.length} image${H.length!==1?"s":""} selected for upload`)}q.length>0&&Ie(`${q.length} file${q.length!==1?"s":""} could not be uploaded due to validation errors`,"assertive")},[l,n,P,r]),I=w.useCallback(()=>{l||n||x.current?.click()},[l,n]),Q=w.useCallback(M=>{Q1(M,I)},[I]),ee=w.useCallback(M=>{const F=M.target.files;if(!F||F.length===0)return;const{valid:H,errors:q}=P(F);if(b(q),H.length>0){if(typeof DataTransfer<"u"){const G=new DataTransfer;H.forEach(se=>G.items.add(se)),r(G.files)}else r(H);Ie(`${H.length} image${H.length!==1?"s":""} selected for upload`)}q.length>0&&Ie(`${q.length} file${q.length!==1?"s":""} could not be uploaded due to validation errors`,"assertive"),M.target.value=""},[P,r]),$=a&&a.total>0?Math.round(a.completed/a.total*100):0;return t0.useEffect(()=>{if(!g&&y.length>0){const M=setTimeout(()=>b([]),3e3);return()=>clearTimeout(M)}},[g,y.length]),f.jsxs("div",{className:`upload-zone ${h} flex justify-center`,children:[f.jsx("input",{ref:x,type:"file",multiple:!0,accept:"image/*",onChange:ee,className:"sr-only",disabled:l||n,"aria-describedby":`${_.current}-description`}),f.jsxs("div",{id:_.current,role:"button",tabIndex:l||n?-1:0,onDragEnter:L,onDragLeave:V,onDragOver:K,onDrop:U,onClick:I,onKeyDown:Q,"aria-label":n?"Upload in progress":"Upload images by clicking or dragging files here","aria-describedby":`${_.current}-description ${y.length>0?O.current:""} ${a?C.current:""}`,"aria-disabled":l||n,className:`
          relative border-2 border-dashed rounded-xl p-6 text-center cursor-pointer w-full max-w-lg
          transition-all duration-300 ease-out focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:ring-offset-2 focus:ring-offset-gray-900
          backdrop-blur-sm shadow-lg hover:shadow-xl
          ${g?"border-blue-400 bg-gradient-to-br from-blue-500/10 to-blue-600/20 shadow-blue-500/25":"border-gray-400/50 hover:border-blue-400/70 bg-gradient-to-br from-gray-800/50 to-gray-700/50 hover:from-gray-700/50 hover:to-gray-600/50"}
          ${l||n?"opacity-50 cursor-not-allowed":"hover:scale-[1.01] hover:shadow-xl"}
          ${y.length>0?"border-red-400 bg-gradient-to-br from-red-500/10 to-red-600/20 shadow-red-500/25":""}
        `,children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"mx-auto w-12 h-12 text-gray-300",children:n?f.jsxs("svg",{className:"animate-spin w-full h-full",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):f.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 48 48",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02"})})}),f.jsx("div",{children:n?f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-lg font-semibold text-gray-100",children:"Uploading images..."}),a&&f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-center space-x-4 text-sm text-gray-300",children:[f.jsxs("span",{className:"font-medium",children:[a.completed," completed"]}),f.jsxs("span",{className:"font-medium",children:[a.inProgress," in progress"]}),a.failed>0&&f.jsxs("span",{className:"text-red-400 font-semibold",children:[a.failed," failed"]})]}),f.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-3 backdrop-blur-sm",children:f.jsx("div",{id:C.current,className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-500 ease-out shadow-lg",style:{width:`${$}%`},role:"progressbar","aria-valuenow":$,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`Upload progress: ${$}%`,"aria-describedby":`${_.current}-progress-text`})}),f.jsxs("p",{id:`${_.current}-progress-text`,className:"text-sm text-gray-300 font-medium",children:[$,"% complete"]})]})]}):f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-lg font-semibold text-gray-100",children:g?"Drop images here":"Upload images"}),f.jsx("p",{id:`${_.current}-description`,className:"text-sm text-gray-300",children:"Drag and drop images here, or click to select files"}),f.jsxs("p",{className:"text-xs text-gray-400",children:["Supports JPEG, PNG, WebP, GIF • Max ",hu(d)," per file • Up to ",c," files"]})]})})]}),y.length>0&&f.jsx("div",{id:O.current,role:"alert","aria-live":"assertive",className:"mt-6 p-4 bg-gradient-to-r from-red-500/10 to-red-600/20 border border-red-400/50 rounded-xl backdrop-blur-sm shadow-lg",children:f.jsxs("div",{className:"text-sm text-red-200",children:[f.jsx("p",{className:"font-semibold mb-2 text-red-100",children:"Some files could not be uploaded:"}),f.jsx("ul",{className:"list-disc list-inside space-y-1.5 text-red-300",children:y.map((M,F)=>f.jsx("li",{children:M},F))})]})})]})]})}class ow extends w.Component{retryCount=0;maxRetries=3;constructor(n){super(n),this.state={hasError:!1,errorId:""}}static getDerivedStateFromError(n){const a=`error-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;return{hasError:!0,error:n,errorId:a}}componentDidCatch(n,a){console.error("Global Error Boundary caught an error:",n,a),this.setState({errorInfo:a}),this.props.onError&&this.props.onError(n,a),this.reportError(n,a)}reportError=(n,a)=>{const l={message:n.message,stack:n.stack,componentStack:a.componentStack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,errorId:this.state.errorId};console.error("Error Report:",l)};handleRetry=()=>{this.retryCount<this.maxRetries?(this.retryCount++,this.setState({hasError:!1,error:void 0,errorInfo:void 0,errorId:""})):this.handleReload()};handleReload=()=>{window.location.reload()};handleReportBug=()=>{const n=encodeURIComponent(`Bug Report: ${this.state.error?.message||"Application Error"}`),a=encodeURIComponent(`
Error ID: ${this.state.errorId}
Error Message: ${this.state.error?.message||"Unknown error"}
Stack Trace: ${this.state.error?.stack||"Not available"}
Component Stack: ${this.state.errorInfo?.componentStack||"Not available"}
Timestamp: ${new Date().toISOString()}
User Agent: ${navigator.userAgent}
URL: ${window.location.href}

Please describe what you were doing when this error occurred:
[Your description here]
    `);window.open(`mailto:support@example.com?subject=${n}&body=${a}`)};getErrorType=n=>n.name==="ChunkLoadError"||n.message.includes("ChunkLoadError")?"chunk-load":n.message.includes("Network")||n.message.includes("network")?"network":n.message.includes("Firebase")||n.message.includes("firebase")?"firebase":n.message.includes("Auth")||n.message.includes("auth")?"auth":"unknown";getErrorMessage=n=>{switch(this.getErrorType(n)){case"chunk-load":return{title:"Application Update Required",description:"A new version of the application is available. Please refresh the page to continue."};case"network":return{title:"Network Connection Error",description:"Unable to connect to our servers. Please check your internet connection and try again."};case"firebase":return{title:"Service Unavailable",description:"Our backend services are temporarily unavailable. Please try again in a few moments."};case"auth":return{title:"Authentication Error",description:"There was a problem with authentication. Please refresh the page to sign in again."};default:return{title:"Unexpected Error",description:"Something went wrong. Our team has been notified and is working on a fix."}}};render(){if(this.state.hasError&&this.state.error){if(this.props.fallback)return this.props.fallback;const{title:n,description:a}=this.getErrorMessage(this.state.error),l=this.retryCount<this.maxRetries,c=this.getErrorType(this.state.error);return f.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-gray-800 rounded-lg border border-red-600 p-8 max-w-lg w-full text-center",children:[f.jsx("div",{className:"text-red-500 mb-6",children:f.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),f.jsx("h1",{className:"text-2xl font-bold text-white mb-4",children:n}),f.jsx("p",{className:"text-gray-300 mb-6",children:a}),f.jsxs("div",{className:"bg-gray-700 rounded p-3 mb-6 text-sm",children:[f.jsx("div",{className:"text-gray-400 mb-1",children:"Error ID:"}),f.jsx("div",{className:"text-gray-200 font-mono",children:this.state.errorId})]}),f.jsxs("div",{className:"space-y-3",children:[l?f.jsxs("button",{onClick:this.handleRetry,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:["Try Again (",this.maxRetries-this.retryCount," attempts left)"]}):f.jsx("button",{onClick:this.handleReload,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:c==="chunk-load"?"Refresh Page":"Reload Application"}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:this.handleReportBug,className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Report Bug"}),f.jsx("button",{onClick:()=>window.location.href="/",className:"flex-1 bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors",children:"Go Home"})]})]}),f.jsxs("details",{className:"mt-6 text-left",children:[f.jsx("summary",{className:"cursor-pointer text-gray-400 hover:text-gray-300 text-sm",children:"Technical Details"}),f.jsxs("div",{className:"mt-3 p-3 bg-gray-700 rounded text-xs font-mono text-gray-300 overflow-auto max-h-32",children:[f.jsxs("div",{className:"mb-2",children:[f.jsx("strong",{children:"Error:"})," ",this.state.error.message]}),this.state.error.stack&&f.jsxs("div",{children:[f.jsx("strong",{children:"Stack:"}),f.jsx("pre",{className:"whitespace-pre-wrap mt-1",children:this.state.error.stack})]})]})]})]})})}return this.props.children}}var cw=Jg();function uw({toast:r,onDismiss:n}){const[a,l]=w.useState(!1),[c,d]=w.useState(!1),h=w.useRef(null),g=w.useRef(Qe("toast"));w.useEffect(()=>{const x=setTimeout(()=>l(!0),10);return()=>clearTimeout(x)},[]),w.useEffect(()=>{if(!r.persistent&&r.duration!==0){const x=r.duration||5e3,_=setTimeout(()=>{p()},x);return()=>clearTimeout(_)}},[r.duration,r.persistent]);const p=()=>{d(!0),setTimeout(()=>{n(r.id)},300)},y=()=>{const x="flex items-start gap-3 p-4 rounded-lg shadow-lg border transition-all duration-300 transform",_=a&&!c?"translate-x-0 opacity-100":"translate-x-full opacity-0";switch(r.type){case"success":return`${x} ${_} bg-green-900/90 border-green-600 text-green-100`;case"error":return`${x} ${_} bg-red-900/90 border-red-600 text-red-100`;case"warning":return`${x} ${_} bg-yellow-900/90 border-yellow-600 text-yellow-100`;case"info":return`${x} ${_} bg-blue-900/90 border-blue-600 text-blue-100`;default:return`${x} ${_} bg-gray-800/90 border-gray-600 text-gray-100`}},b=()=>{switch(r.type){case"success":return f.jsx("svg",{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return f.jsx("svg",{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"warning":return f.jsx("svg",{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})});case"info":return f.jsx("svg",{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});default:return null}};return f.jsxs("div",{ref:h,className:y(),role:"alert","aria-live":r.type==="error"?"assertive":"polite","aria-atomic":"true","aria-labelledby":`${g.current}-title`,"aria-describedby":r.message?`${g.current}-message`:void 0,children:[f.jsx("div",{"aria-hidden":"true",children:b()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{id:`${g.current}-title`,className:"font-medium",children:r.title}),r.message&&f.jsx("div",{id:`${g.current}-message`,className:"text-sm opacity-90 mt-1",children:r.message}),r.action&&f.jsx("button",{onClick:r.action.onClick,className:"mt-2 text-sm underline hover:no-underline focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-transparent focus:ring-current rounded","aria-describedby":`${g.current}-title`,children:r.action.label})]}),f.jsx("button",{onClick:p,className:"text-current opacity-70 hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-transparent focus:ring-current rounded p-1","aria-label":`Dismiss ${r.title} notification`,children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}function dw({toasts:r,onDismiss:n}){return r.length===0?null:cw.createPortal(f.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-sm w-full",role:"region","aria-label":"Notifications","aria-live":"polite",children:r.map(a=>f.jsx(uw,{toast:a,onDismiss:n},a.id))}),document.body)}function fw({className:r="",showDetails:n=!1}){const{isOnline:a,isConnected:l,isSyncing:c,hasConflicts:d,pendingOperationsCount:h,forceSync:g,checkConnection:p}=fp();hp();const y=()=>a?l?c?"text-blue-500":d?"text-orange-500":"text-green-500":"text-yellow-500":"text-red-500",b=()=>a?l?c?"Syncing...":d?"Conflicts detected":"Connected":"Connecting...":"Offline",x=()=>a?l?c?f.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):d?f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}):f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):f.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}):f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636L5.636 18.364M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2z"})}),_=async()=>{try{await p()}catch(K){console.error("Failed to check connection:",K)}},C=async()=>{try{await g()}catch(K){console.error("Failed to force sync:",K)}};return f.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border bg-gray-800/50 border-gray-700 ${r}`,children:[f.jsx("div",{className:`flex-shrink-0 ${y()}`,children:x()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("div",{className:"text-sm font-medium text-white",children:b()}),!1]}),f.jsxs("div",{className:"flex items-center gap-2",children:[!l&&f.jsx("button",{onClick:_,className:"px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",title:"Retry connection",children:"Retry"}),l&&h>0&&f.jsx("button",{onClick:C,className:"px-2 py-1 text-xs bg-green-600 hover:bg-green-700 text-white rounded transition-colors",title:"Force sync",children:"Sync"})]})]})}const hw=({onSwitchToSignup:r})=>{const[n,a]=w.useState(""),[l,c]=w.useState(""),[d,h]=w.useState(!1),[g,p]=w.useState(""),{signIn:y}=Rs(),b=async x=>{x.preventDefault(),h(!0),p("");try{await y(n,l)}catch(_){p(_.message||"Failed to sign in")}finally{h(!1)}};return f.jsx("div",{className:"w-full max-w-md mx-auto",children:f.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 shadow-2xl border border-white/20",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),f.jsx("p",{className:"text-gray-300",children:"Sign in to your LoRa Dataset Builder account"})]}),f.jsxs("form",{onSubmit:b,className:"space-y-6",children:[g&&f.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4",children:f.jsx("p",{className:"text-red-300 text-sm",children:g})}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:n,onChange:x=>a(x.target.value),required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter your email"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),f.jsx("input",{id:"password",type:"password",value:l,onChange:x=>c(x.target.value),required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter your password"})]}),f.jsx("button",{type:"submit",disabled:d,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:d?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing In..."]}):"Sign In"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-400",children:["Don't have an account?"," ",f.jsx("button",{onClick:r,className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Sign up here"})]})})]})})},mw=({onSwitchToLogin:r})=>{const[n,a]=w.useState(""),[l,c]=w.useState(""),[d,h]=w.useState(""),[g,p]=w.useState(!1),[y,b]=w.useState(""),[x,_]=w.useState(!0),[C,O]=w.useState(!1),{signUp:L,migrateImages:V,hasOrphanedImages:K}=Rs(),P=async U=>{if(U.preventDefault(),p(!0),b(""),l!==d){b("Passwords do not match"),p(!1);return}if(l.length<6){b("Password must be at least 6 characters long"),p(!1);return}try{if(await L(n,l),x&&K)try{const I=await V();O(!0),console.log(`Successfully migrated ${I} images to your account`)}catch(I){console.error("Migration failed:",I)}}catch(I){b(I.message||"Failed to sign up")}finally{p(!1)}};return f.jsx("div",{className:"w-full max-w-md mx-auto",children:f.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl p-8 shadow-2xl border border-white/20",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Create Account"}),f.jsx("p",{className:"text-gray-300",children:"Join LoRa Dataset Builder and start building your datasets"})]}),f.jsxs("form",{onSubmit:P,className:"space-y-6",children:[y&&f.jsx("div",{className:"bg-red-500/20 border border-red-500/50 rounded-lg p-4",children:f.jsx("p",{className:"text-red-300 text-sm",children:y})}),C&&f.jsx("div",{className:"bg-green-500/20 border border-green-500/50 rounded-lg p-4",children:f.jsx("p",{className:"text-green-300 text-sm",children:"✅ Successfully migrated your existing images to your new account!"})}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),f.jsx("input",{id:"email",type:"email",value:n,onChange:U=>a(U.target.value),required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter your email"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),f.jsx("input",{id:"password",type:"password",value:l,onChange:U=>c(U.target.value),required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Create a password (min 6 characters)"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm Password"}),f.jsx("input",{id:"confirmPassword",type:"password",value:d,onChange:U=>h(U.target.value),required:!0,className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Confirm your password"})]}),K&&f.jsx("div",{className:"bg-blue-500/20 border border-blue-500/50 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx("input",{type:"checkbox",id:"migrateImages",checked:x,onChange:U=>_(U.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"migrateImages",className:"text-sm font-medium text-blue-300",children:"Migrate existing images to my account"}),f.jsx("p",{className:"text-xs text-blue-200 mt-1",children:"We found existing images in the system. Would you like to claim them as yours?"})]})]})}),f.jsx("button",{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:g?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating Account..."]}):"Create Account"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-400",children:["Already have an account?"," ",f.jsx("button",{onClick:r,className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Sign in here"})]})})]})})},gw=({children:r})=>{const{user:n,loading:a}=Rs(),[l,c]=w.useState(!0);return a?f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-gray-900 to-slate-900 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-300",children:"Loading..."})]})}):n?f.jsx(f.Fragment,{children:r}):f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-gray-900 to-slate-900 flex items-center justify-center p-4",children:f.jsx("div",{className:"w-full max-w-md",children:l?f.jsx(hw,{onSwitchToSignup:()=>c(!1)}):f.jsx(mw,{onSwitchToLogin:()=>c(!0)})})})},pw=()=>{const[r,n]=w.useState(!1),[a,l]=w.useState(!1),{authUser:c,signOut:d,migrateImages:h,hasOrphanedImages:g}=Rs(),p=async()=>{try{await d(),n(!1)}catch(b){console.error("Sign out error:",b)}},y=async()=>{if(!g){alert("No orphaned images found to migrate!");return}l(!0);try{const b=await h();alert(`Successfully migrated ${b} images to your account!`),n(!1)}catch(b){alert(`Migration failed: ${b.message}`)}finally{l(!1)}};return c?f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 bg-white/10 backdrop-blur-lg rounded-lg px-4 py-2 text-white hover:bg-white/20 transition-all duration-200 border border-white/20",children:[f.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-sm font-semibold",children:c.email?.charAt(0).toUpperCase()||"U"}),f.jsx("span",{className:"hidden sm:block text-sm font-medium",children:c.email}),f.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>n(!1)}),f.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white/10 backdrop-blur-lg rounded-lg shadow-2xl border border-white/20 z-20",children:f.jsxs("div",{className:"py-2",children:[f.jsxs("div",{className:"px-4 py-2 text-sm text-gray-300 border-b border-white/10",children:[f.jsx("p",{className:"font-medium",children:c.email}),f.jsx("p",{className:"text-xs text-gray-400",children:"Signed in"})]}),g&&f.jsxs("button",{onClick:y,disabled:a,className:"w-full text-left px-4 py-2 text-sm text-blue-300 hover:bg-blue-500/20 transition-colors duration-200 flex items-center space-x-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})}),f.jsx("span",{children:a?"Migrating...":"Migrate Images"})]}),f.jsxs("button",{onClick:p,className:"w-full text-left px-4 py-2 text-sm text-red-300 hover:bg-red-500/20 transition-colors duration-200 flex items-center space-x-2",children:[f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),f.jsx("span",{children:"Sign Out"})]})]})})]})]}):null},yw=w.createContext(void 0);function vw({children:r}){const[n,a]=w.useState([]),l=w.useCallback(x=>{const _=`toast-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,C={...x,id:_};return a(O=>[...O,C]),_},[]),c=w.useCallback(x=>{a(_=>_.filter(C=>C.id!==x))},[]),d=w.useCallback(()=>{a([])},[]),h=w.useCallback((x,_,C)=>l({type:"success",title:x,message:_,...C}),[l]),g=w.useCallback((x,_,C)=>l({type:"error",title:x,message:_,duration:0,persistent:!0,...C}),[l]),p=w.useCallback((x,_,C)=>l({type:"warning",title:x,message:_,...C}),[l]),y=w.useCallback((x,_,C)=>l({type:"info",title:x,message:_,...C}),[l]),b={showToast:l,dismissToast:c,clearAllToasts:d,showSuccess:h,showError:g,showWarning:p,showInfo:y};return f.jsxs(yw.Provider,{value:b,children:[r,f.jsx(dw,{toasts:n,onDismiss:c})]})}class bw{static uploadFile(n,a,l){return new Promise((c,d)=>{const h=xs(Wn,a),g=yb(h,n);g.on("state_changed",p=>{const y=p.bytesTransferred/p.totalBytes*100;l&&l({bytesTransferred:p.bytesTransferred,totalBytes:p.totalBytes,progress:y,state:p.state})},p=>{console.error("Upload error:",p),d(new Error(`Upload failed: ${p.message}`))},async()=>{try{const p=await vr(g.snapshot.ref);c({downloadURL:p,fullPath:g.snapshot.ref.fullPath,name:g.snapshot.ref.name,size:g.snapshot.totalBytes})}catch(p){d(new Error(`Failed to get download URL: ${p instanceof Error?p.message:"Unknown error"}`))}})})}static async uploadFiles(n,a,l,c,d){const h=[],g=n.map(async(b,x)=>{try{const _=a(b,x),C=await this.uploadFile(b,_,O=>l?.(x,O));return h[x]=C,c?.(x,C),C}catch(_){const C=_ instanceof Error?_:new Error("Upload failed");throw d?.(x,C),C}}),y=(await Promise.allSettled(g)).map((b,x)=>({result:b,index:x})).filter(({result:b})=>b.status==="rejected");if(y.length>0){const b=`${y.length} of ${n.length} uploads failed`;throw new Error(b)}return h}static async deleteFile(n){try{const a=xs(Wn,n);await mu(a)}catch(a){throw console.error("Delete error:",a),new Error(`Failed to delete file: ${a instanceof Error?a.message:"Unknown error"}`)}}static async getDownloadURL(n){try{const a=xs(Wn,n);return await vr(a)}catch(a){throw console.error("Get URL error:",a),new Error(`Failed to get download URL: ${a instanceof Error?a.message:"Unknown error"}`)}}static validateFile(n,a={}){return new Promise((l,c)=>{const{maxSize:d=10*1024*1024,minSize:h=1024,allowedTypes:g=["image/jpeg","image/png","image/webp","image/gif"],allowedExtensions:p=["jpg","jpeg","png","webp","gif"],checkImageIntegrity:y=!0}=a;if(!n||n.size===0){c(new Error("File is empty or invalid"));return}if(n.size<h){c(new Error(`File size ${(n.size/1024).toFixed(2)}KB is below minimum ${(h/1024).toFixed(2)}KB`));return}if(n.size>d){c(new Error(`File size ${(n.size/1024/1024).toFixed(2)}MB exceeds maximum ${(d/1024/1024).toFixed(2)}MB`));return}if(!g.includes(n.type)){c(new Error(`File type ${n.type} not allowed. Allowed types: ${g.join(", ")}`));return}const b=n.name.split(".").pop()?.toLowerCase();if(!b||!p.includes(b)){c(new Error(`File extension .${b} not allowed. Allowed extensions: ${p.join(", ")}`));return}const _={"image/jpeg":["jpg","jpeg"],"image/png":["png"],"image/webp":["webp"],"image/gif":["gif"]}[n.type];if(_&&!_.includes(b)){c(new Error(`File extension .${b} does not match MIME type ${n.type}`));return}if(y||a.maxDimensions||a.minDimensions){const C=new Image,O=setTimeout(()=>{URL.revokeObjectURL(C.src),c(new Error("Image validation timeout - file may be corrupted"))},1e4);C.onload=()=>{clearTimeout(O);try{if(a.maxDimensions&&(C.width>a.maxDimensions.width||C.height>a.maxDimensions.height)){c(new Error(`Image dimensions ${C.width}x${C.height} exceed maximum ${a.maxDimensions.width}x${a.maxDimensions.height}`));return}if(a.minDimensions&&(C.width<a.minDimensions.width||C.height<a.minDimensions.height)){c(new Error(`Image dimensions ${C.width}x${C.height} below minimum ${a.minDimensions.width}x${a.minDimensions.height}`));return}if(C.width<=0||C.height<=0){c(new Error("Invalid image dimensions"));return}const L=50*1024*1024;if(C.width*C.height>L){c(new Error(`Image has too many pixels (${C.width}x${C.height}). Maximum ${L} pixels allowed.`));return}l(!0)}finally{URL.revokeObjectURL(C.src)}},C.onerror=()=>{clearTimeout(O),URL.revokeObjectURL(C.src),c(new Error("Invalid or corrupted image file"))},C.src=URL.createObjectURL(n)}else l(!0)})}static async validateFiles(n,a={},l){const c=[],d=[];for(let h=0;h<n.length;h++){const g=n[h];l?.(h,n.length,g.name);try{await this.validateFile(g,a),c.push(g)}catch(p){d.push({file:g,error:p instanceof Error?p.message:"Validation failed"})}}return l?.(n.length,n.length,""),{valid:c,invalid:d}}}function xw(r,n={}){return new Promise((a,l)=>{const{maxWidth:c=2048,maxHeight:d=2048,quality:h=.85,format:g="jpeg",maintainAspectRatio:p=!0}=n,y=new Image;y.onload=()=>{try{const{width:b,height:x}=Sw(y.width,y.height,c,d,p),_=document.createElement("canvas"),C=_.getContext("2d");if(!C){l(new Error("Could not get canvas context"));return}_.width=b,_.height=x,C.drawImage(y,0,0,b,x),_.toBlob(O=>{if(!O){l(new Error("Failed to process image"));return}const L=new File([O],Ew(r.name,g),{type:`image/${g}`});a({file:L,originalSize:r.size,processedSize:L.size,compressionRatio:r.size/L.size,dimensions:{width:b,height:x}})},`image/${g}`,g==="jpeg"?h:void 0),URL.revokeObjectURL(y.src)}catch(b){l(b)}},y.onerror=()=>{l(new Error("Failed to load image"))},y.src=URL.createObjectURL(r)})}async function _w(r,n={},a){const l=[];for(let c=0;c<r.length;c++){const d=r[c];try{if(a?.(c,r.length,d.name),ww(d,n)){const h=await xw(d,n);l.push(h)}else{const h=await Kg(d);l.push({file:d,originalSize:d.size,processedSize:d.size,compressionRatio:1,dimensions:h})}}catch(h){console.warn(`Failed to process image ${d.name}:`,h);try{const g=await Kg(d);l.push({file:d,originalSize:d.size,processedSize:d.size,compressionRatio:1,dimensions:g})}catch{console.error(`Skipping invalid image file: ${d.name}`)}}}return a?.(r.length,r.length,""),l}function ww(r,n){const{maxWidth:a=2048,maxHeight:l=2048}=n;return r.size>5*1024*1024?!0:r.size>1024*1024||n.format!==void 0}function Kg(r){return new Promise((n,a)=>{const l=new Image;l.onload=()=>{n({width:l.width,height:l.height}),URL.revokeObjectURL(l.src)},l.onerror=()=>{a(new Error("Failed to load image for dimension check"))},l.src=URL.createObjectURL(r)})}function Sw(r,n,a,l,c){if(!c)return{width:Math.min(r,a),height:Math.min(n,l)};if(r<=a&&n<=l)return{width:r,height:n};const d=a/r,h=l/n,g=Math.min(d,h);return{width:Math.round(r*g),height:Math.round(n*g)}}function Ew(r,n){return`${r.replace(/\.[^/.]+$/,"")}_processed.${n}`}class Cw{baseUrl;constructor(){const n="https://captionproxy-yd6gyqwqoq-uc.a.run.app";this.baseUrl=n}async getAvailableProviders(){try{const a=await(await fetch(`${this.baseUrl}/api/caption/providers`)).json();if(!a.success)throw new Error(a.message||"Failed to get providers");return a.providers?.map(l=>l.id)||["openai","gemini"]}catch(n){return console.error("Failed to get available providers:",n),["openai","gemini"]}}async generateCaption(n,a){try{const l=await fetch(`${this.baseUrl}/api/caption/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),c=await l.json();if(!l.ok||!c.success)throw new Error(c.message||`HTTP ${l.status}`);if(!c.result)throw new Error("No result returned from proxy");return c.result}catch(l){throw console.error(`Failed to generate caption with ${n}:`,l),l}}async generateCaptionsFromMultipleProviders(n,a){try{const l=new URL(`${this.baseUrl}/api/caption/batch`);a&&a.length>0&&l.searchParams.set("providers",a.join(","));const c=await fetch(l.toString(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),d=await c.json();if(!c.ok||!d.success)throw new Error(d.message||`HTTP ${c.status}`);return d.results||[]}catch(l){throw console.error("Failed to generate captions from multiple providers:",l),l}}resultsToCandidate(n){return n.map(a=>({modelId:a.modelId,caption:a.caption,createdAt:Date.now(),latencyMs:a.latency,tokensUsed:a.tokensUsed,error:a.error||void 0}))}}const Zg=new Cw;function yp(){const[r,n]=w.useState(!1),[a,l]=w.useState({current:0,total:0}),{startCaptionGeneration:c,endCaptionGeneration:d}=Gb(),h=w.useCallback(async(p,y={})=>{const b=Date.now();n(!0),l({current:1,total:1,currentImageId:p});try{c(p);const{getAuth:x}=await yr(async()=>{const{getAuth:U}=await import("./firebase-vVUnojRl.js").then(I=>I.a4);return{getAuth:U}},[]),C=x().currentUser;if(!C?.uid)throw new Error("User not authenticated");const O=await Be.getImageById(p,C.uid);if(!O)throw new Error("Image not found");const L={imageUrl:O.downloadURL,options:{maxTokens:1500,temperature:.7,systemPrompt:"Describe this image in detail for training a LoRa model. Focus on the main subject, style, composition, and visual elements."}};let V,K,P;try{V=await Zg.generateCaptionsFromMultipleProviders(L,y.providers),K=V.map(U=>({provider:U.modelId,caption:U.caption,error:U.error})),P=Zg.resultsToCandidate(V)}catch(U){console.warn("Caption proxy service unavailable, using mock captions:",U);const I=[{modelId:"gpt-4-vision",caption:"A detailed image showing various visual elements and composition. This appears to be a high-quality photograph with good lighting and clear subject matter.",latency:1500,tokensUsed:25,error:null},{modelId:"gemini-pro-vision",caption:"An interesting visual composition featuring distinct elements and artistic qualities. The image demonstrates good technical quality and visual appeal.",latency:1200,tokensUsed:22,error:null}];K=I.map(Q=>({provider:Q.modelId,caption:Q.caption,error:Q.error})),P=I.map(Q=>({modelId:Q.modelId,caption:Q.caption,createdAt:Date.now(),latencyMs:Q.latency,tokensUsed:Q.tokensUsed,error:Q.error}))}return await Be.updateImageCandidates(p,P,C.uid),d(p,!0),{success:!0,captions:K,totalTime:Date.now()-b}}catch(x){return d(p,!1),console.error("Caption generation failed:",x),{success:!1,captions:[],totalTime:Date.now()-b}}finally{n(!1),l({current:0,total:0})}},[c,d]),g=w.useCallback(async(p,y={})=>{if(p.length===0)return[];n(!0),l({current:0,total:p.length});const b=[];try{for(let x=0;x<p.length;x++){const _=p[x];l({current:x+1,total:p.length,currentImageId:_});const C=await h(_,y);b.push(C),x<p.length-1&&await new Promise(O=>setTimeout(O,100))}}finally{n(!1),l({current:0,total:0})}return b},[h]);return{generateCaption:h,generateCaptionsForBatch:g,isGenerating:r,generationProgress:a}}function Nw(r={}){const{user:n}=Rs(),[a,l]=w.useState(new Map),[c,d]=w.useState(!1),{startUpload:h,endUpload:g}=Yb(),{generateCaption:p}=yp(),{enableImageProcessing:y=!0,imageProcessingOptions:b={maxWidth:2048,maxHeight:2048,quality:.85,format:"jpeg"},concurrencyLimit:x=3,validateFiles:_=!0,validationOptions:C={}}=r,O=w.useCallback(()=>{const U=Array.from(a.values()),I=U.length,Q=U.filter(M=>M.status==="complete").length,ee=U.filter(M=>M.status==="error").length,$=U.filter(M=>M.status==="validating"||M.status==="processing"||M.status==="uploading").length;return{total:I,completed:Q,failed:ee,inProgress:$}},[a]),L=w.useCallback(async U=>{const I=Array.from(U),Q=[];d(!0);const ee=new Map;I.forEach(($,M)=>{const F=`${$.name}_${M}_${Date.now()}`;ee.set(F,{file:$,originalFile:$,status:"pending",progress:0})}),l(ee);try{if(_)for(const[M,F]of ee.entries())try{l(H=>new Map(H.set(M,{...F,status:"validating"}))),await bw.validateFile(F.file,C)}catch(H){ee.set(M,{...F,status:"error",error:H instanceof Error?H.message:"Validation failed"}),l(q=>new Map(q))}if(y){const M=Array.from(ee.entries()).filter(([,F])=>F.status!=="error");if(M.length>0){const F=M.map(([,H])=>H.file);try{(await _w(F,b,(q,G,se)=>{const Z=M.find(([,J])=>J.file.name===se);if(Z){const[J,T]=Z;l(Y=>new Map(Y.set(J,{...T,status:"processing",progress:Math.round(q/G*50)})))}})).forEach((q,G)=>{const[se,Z]=M[G];ee.set(se,{...Z,file:q.file,processingResult:q,status:"pending"})}),l(new Map(ee))}catch(H){console.warn("Image processing failed, using original files:",H)}}}const $=Array.from(ee.entries()).filter(([,M])=>M.status==="pending");for(let M=0;M<$.length;M+=x){const F=$.slice(M,M+x);await Promise.allSettled(F.map(async([H,q])=>{try{l(Z=>new Map(Z.set(H,{...q,status:"uploading"})));const G=`${q.file.name}_${Date.now()}`;h(G,q.file.size);const se=await Be.uploadImage(q.file,n.uid);console.log("🎯 Starting automatic caption generation for:",se.id);try{p(se.id).then(Z=>{Z.success?console.log("✅ Caption generation completed for:",se.id):console.warn("⚠️ Caption generation failed for:",se.id)}).catch(Z=>{console.error("❌ Caption generation error for:",se.id,Z)})}catch(Z){console.error("❌ Failed to start caption generation:",Z)}console.log("🔍 Upload complete, forcing manual fetch to verify...");try{const Z=await Be.getImagesSimple();console.log("📊 Manual fetch found",Z.length,"images after upload"),Z.length>0&&(console.log("✅ Upload verified, images exist in Firestore"),setTimeout(()=>{const J=document.querySelector('[data-testid="gallery"]')||document.querySelector(".gallery")||document.body;J&&J.textContent?.includes("No images uploaded yet")&&(console.log("🔄 UI still shows empty, forcing page refresh..."),window.location.reload())},2e3))}catch(Z){console.error("❌ Manual fetch failed:",Z)}l(Z=>new Map(Z.set(H,{...Z.get(H),progress:90}))),l(Z=>new Map(Z.set(H,{...Z.get(H),status:"complete",progress:100,result:se}))),Q.push(se),g(G,!0)}catch(G){const se=G instanceof Error?G.message:"Upload failed";l(J=>new Map(J.set(H,{...J.get(H),status:"error",error:se})));const Z=`${q.file.name}_${Date.now()}`;g(Z,!1)}}))}return Q}finally{d(!1)}},[y,b,x,_,C]),V=w.useCallback(async()=>{const U=Array.from(a.entries()).filter(([,Q])=>Q.status==="error");if(U.length===0)return;const I=U.map(([,Q])=>Q.file);await L(I)},[a,L]),K=w.useCallback(()=>{l(new Map)},[]),P=w.useCallback(U=>{l(I=>{const Q=new Map(I);return Q.delete(U),Q})},[]);return{uploadStates:Array.from(a.entries()),isUploading:c,overallProgress:O(),uploadFiles:L,retryFailedUploads:V,clearUploadHistory:K,removeUpload:P}}function Tw(r){return!r||!Array.isArray(r)?{total:0,withCaptions:0,needsRetry:0}:{total:r.length,withCaptions:r.filter(n=>n.candidates&&n.candidates.length>0).length,needsRetry:r.filter(n=>n.status==="error").length}}function Rw(){const{user:r}=Rs(),{images:n,batchDeleteImages:a}=gp(),{uploadFiles:l,isUploading:c,overallProgress:d}=Nw(),{generateCaption:h,isGenerating:g}=yp();if(!r)return null;const[p,y]=w.useState([]),[b,x]=w.useState(!1),_=Tw(n),C=async U=>{try{await l(U)}catch(I){console.error("Upload failed:",I)}},O=async(U,I)=>{console.log("Regenerating captions for image:",U,"with providers:",I);try{await h(U,{providers:I})}catch(Q){console.error("Failed to regenerate captions:",Q)}},L=async(U,I)=>{console.log("Regenerating caption for image:",U,"with model:",I);try{await h(U,{providers:[I]})}catch(Q){console.error("Failed to regenerate provider caption:",Q)}},V=U=>{y(U)},K=async U=>{try{const I=await a(U);return console.log("Batch delete result:",I),y([]),x(!1),I}catch(I){return console.error("Batch delete failed:",I),{successful:[],failed:[{imageId:"",error:"Batch delete failed"}]}}},P=()=>{x(!b),b&&y([])};return f.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-gray-900 to-slate-900 text-white",children:[f.jsx("a",{href:"#main-content",className:"skip-link",children:"Skip to main content"}),f.jsx("header",{className:"bg-slate-800/90 backdrop-blur-md border-b border-slate-700/50 shadow-2xl sticky top-0 z-50",role:"banner",children:f.jsx("div",{className:"max-w-7xl mx-auto px-6 py-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("div",{className:"flex items-center space-x-6",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:f.jsx("span",{className:"text-white font-bold text-lg",children:"🎨"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl md:text-3xl font-bold bg-gradient-to-r from-blue-400 via-purple-400 to-pink-400 bg-clip-text text-transparent",children:"LoRa Dataset Builder"}),f.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"AI-Powered Image Management"})]})]})}),f.jsx(pw,{}),f.jsx("button",{onClick:async()=>{try{const{collection:U,getDocs:I}=await yr(async()=>{const{collection:H,getDocs:q}=await import("./firebase-vVUnojRl.js").then(G=>G.a3);return{collection:H,getDocs:q}},[]),{db:Q}=await yr(async()=>{const{db:H}=await Promise.resolve().then(()=>Ab);return{db:H}},void 0),{getAuth:ee}=await yr(async()=>{const{getAuth:H}=await import("./firebase-vVUnojRl.js").then(q=>q.a4);return{getAuth:H}},[]),M=ee().currentUser,F=await I(U(Q,"images"));if(console.log("📊 Old images collection has",F.docs.length,"documents"),M?.uid){const H=await I(U(Q,"users",M.uid,"images"));console.log("👤 User collection has",H.docs.length,"documents"),alert(`Found ${F.docs.length} images in old collection and ${H.docs.length} in your user collection. Use the "Migrate Images" button to claim the old ones!`)}else alert(`Found ${F.docs.length} images in the old collection. Sign in first, then use the "Migrate Images" button to claim them!`)}catch(U){console.error("❌ Failed to read collections:",U),alert(`Error: ${U instanceof Error?U.message:"Unknown error"}`)}},className:"px-4 py-2 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white rounded-lg text-sm font-medium shadow-lg transition-all duration-200 hover:shadow-xl",children:"Check Collections"}),f.jsx(fw,{className:"flex-shrink-0"})]})})}),f.jsxs("main",{id:"main-content",className:"flex-1 max-w-7xl mx-auto px-6 py-6 space-y-6",children:[_.total>0&&f.jsxs("section",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 animate-fade-in",children:[f.jsxs("div",{className:"group bg-gradient-to-br from-blue-500/10 to-blue-600/20 border border-blue-500/20 rounded-2xl p-6 backdrop-blur-sm hover:from-blue-500/20 hover:to-blue-600/30 hover:border-blue-400/30 transition-all duration-300 hover:scale-105 hover:shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-blue-300 text-sm font-semibold uppercase tracking-wide",children:"Total Images"}),f.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center",children:f.jsx("span",{className:"text-blue-400 text-lg",children:"📊"})})]}),f.jsx("div",{className:"text-4xl font-bold text-blue-100 mb-1",children:_.total}),f.jsx("div",{className:"text-blue-300/70 text-xs",children:"Images uploaded"})]}),f.jsxs("div",{className:"group bg-gradient-to-br from-emerald-500/10 to-emerald-600/20 border border-emerald-500/20 rounded-2xl p-6 backdrop-blur-sm hover:from-emerald-500/20 hover:to-emerald-600/30 hover:border-emerald-400/30 transition-all duration-300 hover:scale-105 hover:shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-emerald-300 text-sm font-semibold uppercase tracking-wide",children:"With Captions"}),f.jsx("div",{className:"w-8 h-8 bg-emerald-500/20 rounded-lg flex items-center justify-center",children:f.jsx("span",{className:"text-emerald-400 text-lg",children:"✅"})})]}),f.jsx("div",{className:"text-4xl font-bold text-emerald-100 mb-1",children:_.withCaptions}),f.jsx("div",{className:"text-emerald-300/70 text-xs",children:"Ready for training"})]}),f.jsxs("div",{className:"group bg-gradient-to-br from-amber-500/10 to-amber-600/20 border border-amber-500/20 rounded-2xl p-6 backdrop-blur-sm hover:from-amber-500/20 hover:to-amber-600/30 hover:border-amber-400/30 transition-all duration-300 hover:scale-105 hover:shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-amber-300 text-sm font-semibold uppercase tracking-wide",children:"Processing"}),f.jsx("div",{className:"w-8 h-8 bg-amber-500/20 rounded-lg flex items-center justify-center",children:f.jsx("span",{className:"text-amber-400 text-lg",children:"⏳"})})]}),f.jsx("div",{className:"text-4xl font-bold text-amber-100 mb-1",children:_.total-_.withCaptions}),f.jsx("div",{className:"text-amber-300/70 text-xs",children:"Awaiting captions"})]}),f.jsxs("div",{className:"group bg-gradient-to-br from-red-500/10 to-red-600/20 border border-red-500/20 rounded-2xl p-6 backdrop-blur-sm hover:from-red-500/20 hover:to-red-600/30 hover:border-red-400/30 transition-all duration-300 hover:scale-105 hover:shadow-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("div",{className:"text-red-300 text-sm font-semibold uppercase tracking-wide",children:"Need Retry"}),f.jsx("div",{className:"w-8 h-8 bg-red-500/20 rounded-lg flex items-center justify-center",children:f.jsx("span",{className:"text-red-400 text-lg",children:"⚠️"})})]}),f.jsx("div",{className:"text-4xl font-bold text-red-100 mb-1",children:_.needsRetry}),f.jsx("div",{className:"text-red-300/70 text-xs",children:"Require attention"})]})]}),f.jsxs("section",{id:"toolbar-section",className:"bg-gray-800/60 backdrop-blur-sm rounded-xl border border-gray-700/50 p-4 shadow-lg","aria-labelledby":"toolbar-section-title",children:[f.jsx("h2",{id:"toolbar-section-title",className:"sr-only",children:"Toolbar"}),f.jsx(iw,{images:n||[],selectedImageIds:p,onBatchSelectionChange:V,onBatchDelete:K,selectionMode:b,onToggleSelectionMode:P})]}),f.jsxs("section",{id:"upload-section",className:"bg-slate-800/60 backdrop-blur-md rounded-2xl border border-slate-700/50 p-8 shadow-2xl hover:shadow-3xl transition-all duration-300 animate-fade-in","aria-labelledby":"upload-section-title",children:[f.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[f.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-xl flex items-center justify-center shadow-lg",children:f.jsx("span",{className:"text-white text-xl",children:"📤"})}),f.jsxs("div",{children:[f.jsx("h2",{id:"upload-section-title",className:"text-2xl md:text-3xl font-bold text-white",children:"Upload Images"}),f.jsx("p",{className:"text-slate-400 text-sm",children:"Drag and drop or click to select images for your dataset"})]})]}),f.jsx(rw,{onFilesSelected:C,isUploading:c,progress:d})]}),g&&f.jsx("section",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-blue-500/30 rounded-2xl p-6 shadow-xl backdrop-blur-sm",role:"status","aria-live":"polite","aria-label":"Caption generation status",children:f.jsxs("div",{className:"flex items-center gap-4 text-blue-300",children:[f.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-3 border-blue-400 border-t-transparent","aria-hidden":"true"}),f.jsx("span",{className:"text-lg font-medium",children:"Generating captions..."})]})}),!1,f.jsxs("section",{id:"gallery-section","aria-labelledby":"gallery-section-title",className:"space-y-8 animate-fade-in",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center shadow-lg",children:f.jsx("span",{className:"text-white text-xl",children:"🖼️"})}),f.jsxs("div",{children:[f.jsx("h2",{id:"gallery-section-title",className:"text-2xl md:text-3xl font-bold text-white",children:"Your Images"}),f.jsx("p",{className:"text-slate-400 text-sm",children:"Manage and organize your dataset images"})]})]}),_.total>0&&f.jsxs("div",{className:"flex items-center space-x-6 text-sm",role:"status","aria-live":"polite",children:[f.jsxs("div",{className:"flex items-center space-x-2 bg-emerald-500/10 px-3 py-2 rounded-lg border border-emerald-500/20",children:[f.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),f.jsxs("span",{className:"text-emerald-300 font-medium",children:[_.withCaptions,"/",_.total," captioned"]})]}),_.needsRetry>0&&f.jsxs("div",{className:"flex items-center space-x-2 bg-amber-500/10 px-3 py-2 rounded-lg border border-amber-500/20",children:[f.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full animate-pulse"}),f.jsxs("span",{className:"text-amber-300 font-medium",children:[_.needsRetry," need retry"]})]})]})]}),f.jsx("div",{className:"bg-slate-800/40 backdrop-blur-md rounded-2xl border border-slate-700/50 p-6 shadow-2xl",children:f.jsx(nw,{onImageRegenerate:O,onRegenerateProvider:L,selectedImageIds:p,onBatchSelectionChange:V,onBatchDelete:K,selectionMode:b,onToggleSelectionMode:P})})]})]}),f.jsx("footer",{className:"bg-slate-800/90 backdrop-blur-md border-t border-slate-700/50 mt-16",role:"contentinfo",children:f.jsx("div",{className:"max-w-7xl mx-auto px-6 py-8",children:f.jsxs("div",{className:"text-center",children:[f.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-4",children:[f.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:f.jsx("span",{className:"text-white font-bold text-sm",children:"🎨"})}),f.jsx("span",{className:"text-slate-300 font-semibold",children:"LoRa Dataset Builder"})]}),f.jsx("p",{className:"text-slate-400 text-sm mb-2",children:"Professional image management and AI-powered caption generation for machine learning datasets by Marty Hines"}),f.jsx("div",{className:"flex items-center justify-center space-x-4 text-xs text-slate-500"})]})})})]})}function Aw(){return f.jsx(ow,{children:f.jsx(F1,{children:f.jsx(vw,{children:f.jsx(gw,{children:f.jsx(Rw,{})})})})})}Eb.createRoot(document.getElementById("root")).render(f.jsx(w.StrictMode,{children:f.jsx(Aw,{})}));
